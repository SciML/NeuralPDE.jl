<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -3.8031382040769772
 -3.7142097287097378
 -3.5937254725582735
 -4.052894415087395
 -3.8450299426243273
 -3.9532707395729627
 -3.9034522940153122
 -3.6825627874867077
 -4.133945716493873
 -4.012915825878238
  ⋮
 -3.880233568022876
 -3.8524436810279625
 -3.8480922707564935
 -3.6923987878251716
 -4.204843815500682
 -3.9685744273361436
 -3.8549575525385533
 -3.928831912102212
 -3.7787366878204156</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="1eccf204.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[0.54932436499868, -0.7484831416674294, 0.5473011068268526, 0.052565581612843276, 0.3808618983592644, 0.20739196867746668, -0.3008471427473296, 0.3866247703083007, 0.6903185015836936, 0.2504441871096714  …  -0.6212290289321667, 0.023572269797461562, -0.43509560340794406, -0.13668526973338677, -0.6472504496280642, -0.6178430424729356, 0.4313115484670721, -0.30099814516206497, -0.041393986431583984, 0.500656673057106], [0.54932436499868, -0.7484831416674294, 0.5473011068268526, 0.052565581612843276, 0.3808618983592644, 0.20739196867746668, -0.3008471427473296, 0.3866247703083007, 0.6903185015836936, 0.2504441871096714  …  -0.6212290289321667, 0.023572269797461562, -0.43509560340794406, -0.13668526973338677, -0.6472504496280642, -0.6178430424729356, 0.4313115484670721, -0.30099814516206497, -0.041393986431583984, 0.500656673057106], [0.54932436499868, -0.7484831416674294, 0.5473011068268526, 0.052565581612843276, 0.3808618983592644, 0.20739196867746668, -0.3008471427473296, 0.3866247703083007, 0.6903185015836936, 0.2504441871096714  …  -0.6212290289321667, 0.023572269797461562, -0.43509560340794406, -0.13668526973338677, -0.6472504496280642, -0.6178430424729356, 0.4313115484670721, -0.30099814516206497, -0.041393986431583984, 0.500656673057106], [0.548593120618745, -0.7484044056920381, 0.547189497973714, 0.05783848280034713, 0.3798630404484819, 0.20651882739693445, -0.3016787234046055, 0.3847734804977059, 0.6903990835254726, 0.24976582844544143  …  -0.6219684613930082, 0.02193870852002925, -0.4354434446757524, -0.13863737090653527, -0.6444536610060243, -0.6190739226104616, 0.4281572144685526, -0.3009424083570067, -0.04982929194632394, 0.50100096148189], [0.5485727610783447, -0.7493698486857181, 0.5472019614137225, 0.06520007679815924, 0.3793124522482078, 0.20587063029043426, -0.30445135341413193, 0.3831212310405963, 0.6901928162126413, 0.2491082966126048  …  -0.6229672346089251, 0.016623113561551956, -0.43630514119960295, -0.1409431706985808, -0.6402641674788904, -0.6210876755732994, 0.4239750213553958, -0.30304085593698343, -0.06532584235279507, 0.501094926916566], [0.5496407377170807, -0.750825550032352, 0.5458494341659317, 0.0728909117588647, 0.37570720329197593, 0.20206928080076772, -0.30974430817585175, 0.37816945980584193, 0.6905309754426092, 0.2457884103222143  …  -0.6276118916890692, 0.007500442710274011, -0.43848765482472735, -0.1507090870073401, -0.6302310981143762, -0.6276737240221707, 0.41521049212287053, -0.308613343233808, -0.10127753480272401, 0.5033074415616623], [0.5483398075014457, -0.7520423701750494, 0.5449960003099149, 0.07094197972406763, 0.37294114999240446, 0.19858935057418428, -0.31555859959228116, 0.37545611546783525, 0.6917209072460908, 0.24423518364357913  …  -0.6316890497581208, 0.0019224539600466387, -0.4390462261152582, -0.15800845614906964, -0.6236145054993737, -0.634298751358992, 0.4117512519013112, -0.31509586660793604, -0.12557708657061914, 0.5035812777015509], [0.5483398075014457, -0.7520423701750494, 0.5449960003099149, 0.07094197972406763, 0.37294114999240446, 0.19858935057418428, -0.31555859959228116, 0.37545611546783525, 0.6917209072460908, 0.24423518364357913  …  -0.6316890497581208, 0.0019224539600466387, -0.4390462261152582, -0.15800845614906964, -0.6236145054993737, -0.634298751358992, 0.4117512519013112, -0.31509586660793604, -0.12557708657061914, 0.5035812777015509], [0.5482276382793235, -0.7518827823919045, 0.5450037777448377, 0.07057042754152452, 0.372666950917497, 0.1984900358263683, -0.3159609419357603, 0.3752527888325379, 0.6917006316879366, 0.24408027947769856  …  -0.6320896655226577, 0.0014076839914058943, -0.43898720482290776, -0.15848057970229343, -0.6227515401005537, -0.6347797153138521, 0.41170816576648667, -0.3158854700511775, -0.12733595044428955, 0.5034686450228498], [0.5485733180900706, -0.7523546122314798, 0.5448949213727191, 0.06900349596151797, 0.3724720339797447, 0.19804560191534487, -0.3161591491800798, 0.3743936773538789, 0.6910853522899537, 0.24362388486960135  …  -0.6332025570195755, -0.00024892864022238014, -0.4391766515331269, -0.1609363535819133, -0.6205786825656489, -0.6367340681485628, 0.4116332554130366, -0.31828008059603274, -0.13342374933145462, 0.5039496483587768]  …  [1.1822627487923716, -1.0471132404268986, 0.40208222936439864, 0.24998537969994034, 0.7739281201708538, 0.9798901066813765, -0.4802036843475394, 0.7876527978845722, 0.1774436854080266, 0.3499553991259067  …  -2.27183654914657, -1.0008882527729708, -1.0724011829768891, -1.9997963975172448, 0.08170060379632371, -2.7746642737540936, 1.599622676082655, -2.06207259270606, -0.5429172715184692, 0.4622167639869266], [1.1821912123646308, -1.0476612323410395, 0.4021259354981238, 0.24988628363701496, 0.7742162433985023, 0.9804648774452905, -0.4795132154333956, 0.7873529229938842, 0.1768585285535397, 0.3501038094828012  …  -2.2717835194103873, -1.0016851365730066, -1.072354502186318, -1.9997491544734725, 0.08262446319981805, -2.7749553226041774, 1.6004874635797015, -2.0634290589329862, -0.5413583715895566, 0.4623872818358239], [1.181422414437254, -1.055478016718763, 0.4001873870404285, 0.2505432321436258, 0.7717795452716799, 0.981035855201093, -0.47922794255162804, 0.7865694875695509, 0.17190019734545495, 0.35715848531312877  …  -2.279420313358486, -1.0076561054324198, -1.076665128218852, -2.007074500226225, 0.0887461476911881, -2.7834053557184113, 1.6091181547938649, -2.0699599056809124, -0.5328427941409091, 0.4608096270563254], [1.1820959221116136, -1.057736396559167, 0.4008031881373887, 0.25076305908373786, 0.771845508461903, 0.9822202793421775, -0.4789540913780488, 0.7873467666589616, 0.1707843640504606, 0.3609819447158416  …  -2.2821468113518906, -1.0110029428617338, -1.0778555020624219, -2.009896000135905, 0.09093885560792886, -2.78724518327905, 1.6125215057825644, -2.0727627595868356, -0.5295302220507336, 0.4600047504113039], [1.1820959221116136, -1.057736396559167, 0.4008031881373887, 0.25076305908373786, 0.771845508461903, 0.9822202793421775, -0.4789540913780488, 0.7873467666589616, 0.1707843640504606, 0.3609819447158416  …  -2.2821468113518906, -1.0110029428617338, -1.0778555020624219, -2.009896000135905, 0.09093885560792886, -2.78724518327905, 1.6125215057825644, -2.0727627595868356, -0.5295302220507336, 0.4600047504113039], [1.181942445745776, -1.0579675828298134, 0.4008159617936763, 0.2510069665865836, 0.7707819806717426, 0.9823579075061558, -0.47848116110616157, 0.7875457167625918, 0.17085454661599475, 0.3615136843372589  …  -2.2827286755931575, -1.0115732876713817, -1.0784012825393758, -2.01068033962219, 0.09150375392287119, -2.7888384936200374, 1.6134931917161428, -2.0733209235295726, -0.5290085432299917, 0.45946345059684096], [1.1819353932137013, -1.0588425839463371, 0.4002919613234989, 0.2510030880880069, 0.7701704456993308, 0.982609825928183, -0.4792119720566982, 0.7874295191839149, 0.17035797753834792, 0.36105734607881923  …  -2.284207849599114, -1.0129115571221432, -1.0789905710004308, -2.011786004822309, 0.0925780087690316, -2.790093989555481, 1.613530788520777, -2.0741802658537782, -0.5283793649310362, 0.459190882995496], [1.1819353932137013, -1.0588425839463371, 0.4002919613234989, 0.2510030880880069, 0.7701704456993308, 0.982609825928183, -0.4792119720566982, 0.7874295191839149, 0.17035797753834792, 0.36105734607881923  …  -2.284207849599114, -1.0129115571221432, -1.0789905710004308, -2.011786004822309, 0.0925780087690316, -2.790093989555481, 1.613530788520777, -2.0741802658537782, -0.5283793649310362, 0.459190882995496], [1.1819353932137013, -1.0588425839463371, 0.4002919613234989, 0.2510030880880069, 0.7701704456993308, 0.982609825928183, -0.4792119720566982, 0.7874295191839149, 0.17035797753834792, 0.36105734607881923  …  -2.284207849599114, -1.0129115571221432, -1.0789905710004308, -2.011786004822309, 0.0925780087690316, -2.790093989555481, 1.613530788520777, -2.0741802658537782, -0.5283793649310362, 0.459190882995496], [1.1819353932137013, -1.0588425839463371, 0.4002919613234989, 0.2510030880880069, 0.7701704456993308, 0.982609825928183, -0.4792119720566982, 0.7874295191839149, 0.17035797753834792, 0.36105734607881923  …  -2.284207849599114, -1.0129115571221432, -1.0789905710004308, -2.011786004822309, 0.0925780087690316, -2.790093989555481, 1.613530788520777, -2.0741802658537782, -0.5283793649310362, 0.459190882995496]], NamedTuple[(n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.7290871010000738e6, hamiltonian_energy = 1.77137671317245e6, hamiltonian_energy_error = -10336.6098642149, max_hamiltonian_energy_error = -10336.6098642149, tree_depth = 2, numerical_error = false, step_size = 0.00078125, nom_step_size = 0.00078125, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.7290871010000738e6, hamiltonian_energy = 1.7291403163625274e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 5.536578032313707e15, tree_depth = 0, numerical_error = true, step_size = 0.011238679762325607, nom_step_size = 0.011238679762325607, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.7290871010000738e6, hamiltonian_energy = 1.7291422301991389e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 27727.37467053905, tree_depth = 0, numerical_error = true, step_size = 0.0018993494877672993, nom_step_size = 0.0018993494877672993, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.7229135240272433e6, hamiltonian_energy = 1.7291075986768065e6, hamiltonian_energy_error = -37.66195288626477, max_hamiltonian_energy_error = -37.66195288626477, tree_depth = 2, numerical_error = false, step_size = 0.00018733703557689892, nom_step_size = 0.00018733703557689892, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.712759023462594e6, hamiltonian_energy = 1.7228906241661445e6, hamiltonian_energy_error = -86.69947317009792, max_hamiltonian_energy_error = -86.69947317009792, tree_depth = 2, numerical_error = false, step_size = 0.00025338469449058976, nom_step_size = 0.00025338469449058976, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.6915882495498802e6, hamiltonian_energy = 1.712578954504797e6, hamiltonian_energy_error = -230.03123382781632, max_hamiltonian_energy_error = -230.03123382781632, tree_depth = 2, numerical_error = false, step_size = 0.0003962543583196465, nom_step_size = 0.0003962543583196465, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.6777988023161972e6, hamiltonian_energy = 1.6915117094424604e6, hamiltonian_energy_error = -127.40932475379668, max_hamiltonian_energy_error = -127.40932475379668, tree_depth = 2, numerical_error = false, step_size = 0.0006745127317215781, nom_step_size = 0.0006745127317215781, is_adapt = true), (n_steps = 2, is_accept = true, acceptance_rate = 9.560646757463659e-70, log_density = -1.6777988023161972e6, hamiltonian_energy = 1.6778598573927265e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 5849.655226276256, tree_depth = 1, numerical_error = true, step_size = 0.001206997480022779, nom_step_size = 0.001206997480022779, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.6767350030679342e6, hamiltonian_energy = 1.6778399848430739e6, hamiltonian_energy_error = -0.05761943501420319, max_hamiltonian_energy_error = -0.05761943501420319, tree_depth = 2, numerical_error = false, step_size = 9.593825108613214e-5, nom_step_size = 9.593825108613214e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.6729465494634348e6, hamiltonian_energy = 1.676795006323713e6, hamiltonian_energy_error = -0.30013377824798226, max_hamiltonian_energy_error = -0.30013377824798226, tree_depth = 2, numerical_error = false, step_size = 0.0001766210734631453, nom_step_size = 0.0001766210734631453, is_adapt = true)  …  (n_steps = 3, is_accept = true, acceptance_rate = 0.8732038388406395, log_density = -108532.9538542149, hamiltonian_energy = 108829.14231048682, hamiltonian_energy_error = 0.3820397324161604, max_hamiltonian_energy_error = -0.9629192458814941, tree_depth = 2, numerical_error = false, step_size = 0.00036925832678822763, nom_step_size = 0.00036925832678822763, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.4737943467014576, log_density = -108282.15497900062, hamiltonian_energy = 108581.16626133952, hamiltonian_energy_error = -0.9799076239287388, max_hamiltonian_energy_error = 20.654146267144824, tree_depth = 3, numerical_error = false, step_size = 0.00036925832678822763, nom_step_size = 0.00036925832678822763, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.7024507251988406, log_density = -106034.84430397431, hamiltonian_energy = 108327.32619461339, hamiltonian_energy_error = -1.3825197722908342, max_hamiltonian_energy_error = 5.882906415863545, tree_depth = 3, numerical_error = false, step_size = 0.00036925832678822763, nom_step_size = 0.00036925832678822763, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 0.7809004295464312, log_density = -105112.01664337538, hamiltonian_energy = 106081.00859089354, hamiltonian_energy_error = -0.1377611772477394, max_hamiltonian_energy_error = 0.5110638564947294, tree_depth = 2, numerical_error = false, step_size = 0.00036925832678822763, nom_step_size = 0.00036925832678822763, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.0011049446188592215, log_density = -105112.01664337538, hamiltonian_energy = 105176.74249127004, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 770.9466921672138, tree_depth = 3, numerical_error = false, step_size = 0.00036925832678822763, nom_step_size = 0.00036925832678822763, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.7404552456378956, log_density = -104860.59923841215, hamiltonian_energy = 105162.9285165936, hamiltonian_energy_error = -0.4552110963850282, max_hamiltonian_energy_error = 7.841840841269004, tree_depth = 3, numerical_error = false, step_size = 0.00036925832678822763, nom_step_size = 0.00036925832678822763, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 0.5132141456215963, log_density = -104634.97398272953, hamiltonian_energy = 104935.1889935823, hamiltonian_energy_error = -0.04518138761341106, max_hamiltonian_energy_error = 1.5745711116032908, tree_depth = 2, numerical_error = false, step_size = 0.00036925832678822763, nom_step_size = 0.00036925832678822763, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 0.37565860092624487, log_density = -104634.97398272953, hamiltonian_energy = 104681.67081474092, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 2.322902660947875, tree_depth = 2, numerical_error = false, step_size = 0.00036925832678822763, nom_step_size = 0.00036925832678822763, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 0.0017317960633211511, log_density = -104634.97398272953, hamiltonian_energy = 104696.9314402609, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 53.67092906773905, tree_depth = 2, numerical_error = false, step_size = 0.00036925832678822763, nom_step_size = 0.00036925832678822763, is_adapt = false), (n_steps = 5, is_accept = true, acceptance_rate = 0.0006099731099419354, log_density = -104634.97398272953, hamiltonian_energy = 104685.58972706013, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 6923.794823331438, tree_depth = 2, numerical_error = true, step_size = 0.00036925832678822763, nom_step_size = 0.00036925832678822763, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-4.01 ± 0.022, -4.01 ± 0.022, -4.01 ± 0.022, -4.01 ± 0.022, -4.01 ± 0.022, -4.01 ± 0.022, -4.01 ± 0.022, -4.01 ± 0.022, -4.01 ± 0.022, -4.01 ± 0.022  …  -3.8 ± 0.0059, -3.8 ± 0.0059, -3.8 ± 0.0059, -3.8 ± 0.0059, -3.8 ± 0.0058, -3.8 ± 0.0058, -3.8 ± 0.0058, -3.8 ± 0.0058, -3.8 ± 0.0058, -3.8 ± 0.0058]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[1.16 ± 0.021 0.208 ± 0.033; -1.0 ± 0.045 0.317 ± 0.036; … ; -0.499 ± 0.02 0.633 ± 0.14; 0.785 ± 0.0028 -0.877 ± 0.0024], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.19 ± 0.0062; -0.295 ± 0.019; … ; -1.22 ± 0.019; -1.44 ± 0.0077;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.562 ± 0.0027 -0.315 ± 0.0091 … 0.95 ± 0.015 0.746 ± 0.0056; -0.0699 ± 0.0045 0.556 ± 0.00059 … 0.363 ± 0.017 0.0052 ± 0.0064; … ; 0.149 ± 0.0078 -0.493 ± 0.0066 … -0.26 ± 0.0027 -0.718 ± 0.0055; -0.33 ± 0.022 -0.131 ± 0.016 … -0.142 ± 0.017 0.443 ± 0.019], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.569 ± 0.0053; -0.163 ± 0.008; … ; 0.214 ± 0.0043; -0.137 ± 0.016;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-2.23 ± 0.044 -0.963 ± 0.04 … 1.56 ± 0.043 -2.02 ± 0.044], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.584 ± 0.044;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.473 ± 0.011], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="5de68f9e.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Friday 15 March 2024 00:46">Friday 15 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
