<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -3.8100933762502076
 -4.088007482533413
 -4.164486180887069
 -4.314896103950467
 -3.8970507200275617
 -4.191862658674779
 -3.794427358280731
 -3.5358745659383723
 -3.7470204211678264
 -4.132844023530567
  ⋮
 -3.622799850710955
 -4.064947262572055
 -4.27792531193167
 -4.100035936380916
 -4.140564953251392
 -4.232005740539624
 -4.005707832303801
 -3.883074310116529
 -4.076977429007277</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="45aed4d8.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[0.7464901320471689, 0.15326930104709288, 0.314584245129542, 0.03761980200721503, -0.08884044864101191, 0.12688092784107569, -0.7082282057267899, -0.7434068155600188, -0.10283588727308554, -0.3965400029867219  …  0.73973694694483, 0.6544686878506752, 0.5926716675540828, -0.19027564443961215, 0.4069748671549142, 0.1714540422755517, -0.7498052868480527, -0.4473317825464565, -0.17229307418181838, 0.5022856656072329], [0.7464901320471689, 0.15326930104709288, 0.314584245129542, 0.03761980200721503, -0.08884044864101191, 0.12688092784107569, -0.7082282057267899, -0.7434068155600188, -0.10283588727308554, -0.3965400029867219  …  0.73973694694483, 0.6544686878506752, 0.5926716675540828, -0.19027564443961215, 0.4069748671549142, 0.1714540422755517, -0.7498052868480527, -0.4473317825464565, -0.17229307418181838, 0.5022856656072329], [0.7464901320471689, 0.15326930104709288, 0.314584245129542, 0.03761980200721503, -0.08884044864101191, 0.12688092784107569, -0.7082282057267899, -0.7434068155600188, -0.10283588727308554, -0.3965400029867219  …  0.73973694694483, 0.6544686878506752, 0.5926716675540828, -0.19027564443961215, 0.4069748671549142, 0.1714540422755517, -0.7498052868480527, -0.4473317825464565, -0.17229307418181838, 0.5022856656072329], [0.7372934865562146, 0.14862383725447884, 0.3209124236091134, 0.04983188719496445, -0.09748009350318623, 0.0979502588128953, -0.7075727158379767, -0.740098572067967, -0.12032620539921159, -0.3974165569563205  …  0.7369411466812624, 0.6595344975427981, 0.607485142482481, -0.19675671672996128, 0.4129800665093333, 0.16863477348149633, -0.7605067076698656, -0.4508267970788914, -0.20161003670346012, 0.5020668420387974], [0.7149964423444819, 0.1398526895717987, 0.3357224321471216, 0.06920284054268805, -0.10647919344707273, 0.041311383968797744, -0.7060423443907824, -0.7351289002688175, -0.1553562909786455, -0.395655270113934  …  0.7341238267835355, 0.6767667990953918, 0.6306663384244093, -0.20980036957710751, 0.41769586318262963, 0.17016641037170335, -0.7904409950641202, -0.46374140131442576, -0.2536165093262594, 0.5010723105075465], [0.714865157436722, 0.1398280277157793, 0.33597311838675403, 0.06930698431381116, -0.10643957555741547, 0.04110790544820408, -0.7058637921838892, -0.7351962127121918, -0.15558263678664783, -0.3956944355510549  …  0.7340654327676464, 0.6771214151070031, 0.6308276324818798, -0.20980655494490483, 0.41755286315144347, 0.170193756517372, -0.7906415827250574, -0.46377564368452345, -0.2539070704024508, 0.5010167812509678], [0.7142793627830073, 0.1394893956085168, 0.33639901416315104, 0.06967471356978452, -0.10647529963574898, 0.04011008378710944, -0.7057204455181095, -0.7349917969571897, -0.15681333752427815, -0.3957885567357122  …  0.7337058943815015, 0.6779884704787154, 0.6312806474139239, -0.21051234635795327, 0.4173096588999406, 0.17053407399977819, -0.7917745607819682, -0.4639922376749014, -0.2551422637786482, 0.5012662354211047], [0.5337921397256221, 0.1535295338456133, 0.5301298025690584, 0.40327987863481096, -0.08693673028112445, 0.02483755298415513, -0.5770262152150416, -0.5970975618155154, -0.7373728045104546, -0.3427593723141379  …  0.9011469658949709, 1.2370930850930273, 0.9284688176743862, -0.5307075096738988, 0.4206972554081223, 0.3917044787692195, -1.5746441893154373, -0.9608334258127189, -0.8050450493351333, 0.5032819762064042], [0.5340656448469324, 0.15361642415144236, 0.5302077778879276, 0.40333272046711555, -0.0869774766071572, 0.024802077223283512, -0.5770170049498019, -0.5970896721494827, -0.7373476973360535, -0.34270461883242187  …  0.90121930031712, 1.2372026396182434, 0.9285189565048415, -0.5307496214260925, 0.42069890769868523, 0.39175940183175634, -1.5747230946161412, -0.9608201973627516, -0.8050822553328054, 0.5032741291940664], [0.5351301014740955, 0.15368775491525216, 0.5301626017613351, 0.4033351248309902, -0.08697976650256317, 0.024571568432108722, -0.576922106061805, -0.5970678947346665, -0.737209831689891, -0.34250155762676543  …  0.9014622109741537, 1.2374618396583066, 0.9286764271530044, -0.5309746170290838, 0.42083731589392515, 0.39186613445124724, -1.575087153685728, -0.961027271643223, -0.8051689647695418, 0.5033341094879773]  …  [0.848186101575358, 0.5169566347878164, 0.40845079937464984, 0.6243825757668836, -0.2466728438797533, 0.10579343468733908, -0.6314051432171636, -0.47179504954683626, -1.727868198890085, -0.7403478498204646  …  2.401182621443962, 3.6140301222748668, 2.1639898977066188, -2.201805410351866, 1.4531912529658648, 1.6322236437359077, -3.429297118994077, -2.678675649322935, 0.5834380402105576, 0.9026432896162201], [0.8601720016861205, 0.5043241729291669, 0.40604714693839866, 0.6127696105606119, -0.24030698375016205, 0.10304457328089323, -0.6371826955991872, -0.4568509793758758, -1.7389154486088778, -0.72439354842373  …  2.394158940601074, 3.605224595732861, 2.1462431883953186, -2.1876574775821203, 1.4560251140687095, 1.6356343031386131, -3.4626309287238555, -2.68175000463657, 0.5719358048228663, 0.8813160231462405], [0.8543631824268142, 0.5133246036912639, 0.41116444947846936, 0.600665015233405, -0.24558454667976545, 0.08292765391382514, -0.6007390365229973, -0.46163579348223954, -1.7381428259153577, -0.73660143460471  …  2.3952987530468057, 3.5604652578866927, 2.191861032869785, -2.207238687691201, 1.4979244022816431, 1.6682140738168771, -3.3818008355820797, -2.6416426335891146, 0.5685122677870384, 0.9104208289784627], [0.8509133857937845, 0.5269177274448238, 0.4213935059373663, 0.5891354460911252, -0.2592027727843084, 0.1130672412138181, -0.5730835714329429, -0.5259227092467719, -1.7325323749008283, -0.7175797247514667  …  2.3870438294233534, 3.5349849958825903, 2.1804372035551816, -2.337122528873622, 1.4716741453986077, 1.716487188775802, -3.5038135133164836, -2.6816289392989257, 0.5998181688631137, 1.0175131874046783], [0.8567744360338401, 0.5306605313983798, 0.45171018952115355, 0.6335702676700312, -0.2967870398752798, 0.0937461563850595, -0.6158015963123924, -0.5376613398735051, -1.7505272652019717, -0.8796820523103891  …  2.368150096371602, 3.671990799834272, 2.296066629551356, -2.3259764925495814, 1.4143801842942183, 1.7038356103999315, -3.502869167775036, -2.625739743547395, 0.6011763056651672, 1.0533389519683978], [0.8708157382004728, 0.5795106761519283, 0.45186647997246127, 0.668030159521676, -0.31434526397134027, 0.1015617865396397, -0.5709327235313111, -0.5578111579013205, -1.7817120266577178, -0.8819450550443231  …  2.439444863973703, 3.6694301677085255, 2.3309406769819345, -2.347159932931611, 1.4676352252061118, 1.6705153913538593, -3.434006515982592, -2.714392723591142, 0.5151720927288125, 1.0033747269390898], [0.8621556931393939, 0.568636983537143, 0.43826713783989435, 0.6149404342339492, -0.3052632947605515, 0.09973778840654099, -0.6011988563888181, -0.5721654627354659, -1.7620457096074449, -0.8781363438001512  …  2.443219960206994, 3.667580701417912, 2.2666637580057336, -2.305488344356436, 1.483831628220692, 1.7384896065519917, -3.4590081997259463, -2.7147926301301806, 0.5231719557980079, 1.0318384992892133], [0.8821119264250538, 0.6304757031646786, 0.44822224525390597, 0.5719349317644933, -0.31263293174724344, 0.09318061176755556, -0.646398134856743, -0.46891778589135225, -1.784047464936879, -0.9313667256381335  …  2.3640652002461304, 3.7191466744433654, 2.171130346869883, -2.3026976225225577, 1.5532827533660811, 1.7519136997719993, -3.4574765878699982, -2.666799483442545, 0.5223135584345692, 1.1064697340251533], [0.8864579193459625, 0.6956302517083047, 0.45540451891762374, 0.5704541256858284, -0.30234972051925924, 0.09714032463046872, -0.5879647851694867, -0.47350849056343075, -1.8139141366391214, -0.9794595080409211  …  2.400700902052781, 3.7101477234981632, 2.26845310833036, -2.287154781499905, 1.5847990249716715, 1.7062283380931749, -3.3714666855530693, -2.677456760286731, 0.48886074817644765, 1.0527190337771417], [0.8780921202584887, 0.6850470452824879, 0.44760767195385104, 0.5755754896298461, -0.3021846302787895, 0.0905243225394882, -0.6130695642137444, -0.4874838554452111, -1.8051151828237217, -0.976517165950688  …  2.4106886468051343, 3.706591562039799, 2.246489633494601, -2.3399773512111506, 1.5822400331934803, 1.6690820641591262, -3.3622401305861693, -2.7230183598514586, 0.5206810074715177, 1.081665218040303]], NamedTuple[(n_steps = 1, is_accept = true, acceptance_rate = 1.0, log_density = -1.6476488197396607e6, hamiltonian_energy = 1.7402525243627282e6, hamiltonian_energy_error = -7731.225159358932, max_hamiltonian_energy_error = -7731.225159358932, tree_depth = 1, numerical_error = false, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6476488197396607e6, hamiltonian_energy = 1.6477165016447834e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 6.589402307990139e55, tree_depth = 0, numerical_error = true, step_size = 0.022477359524651217, nom_step_size = 0.022477359524651217, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6476488197396607e6, hamiltonian_energy = 1.6477055635315063e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1.759747847860334e6, tree_depth = 0, numerical_error = true, step_size = 0.003798698975534599, nom_step_size = 0.003798698975534599, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.6226015404423897e6, hamiltonian_energy = 1.6476850556752617e6, hamiltonian_energy_error = -16.582764570135623, max_hamiltonian_energy_error = -16.582764570135623, tree_depth = 2, numerical_error = false, step_size = 0.00037467407115379783, nom_step_size = 0.00037467407115379783, is_adapt = true), (n_steps = 4, is_accept = true, acceptance_rate = 0.25, log_density = -1.5754250822837155e6, hamiltonian_energy = 1.6223312682943048e6, hamiltonian_energy_error = -315.6697977744043, max_hamiltonian_energy_error = 1782.170556708239, tree_depth = 2, numerical_error = true, step_size = 0.00050676938898118, nom_step_size = 0.00050676938898118, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.6383664264578112, log_density = -1.5750778167299905e6, hamiltonian_energy = 1.5754777544276947e6, hamiltonian_energy_error = 0.0774434965569526, max_hamiltonian_energy_error = 1.3036417954135686, tree_depth = 3, numerical_error = false, step_size = 8.470168770218192e-5, nom_step_size = 8.470168770218192e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9361644112575682, log_density = -1.5736022681058138e6, hamiltonian_energy = 1.5751289533952803e6, hamiltonian_energy_error = 0.0811184395570308, max_hamiltonian_energy_error = 0.20200993726029992, tree_depth = 3, numerical_error = false, step_size = 4.485651933876797e-5, nom_step_size = 4.485651933876797e-5, is_adapt = true), (n_steps = 69, is_accept = true, acceptance_rate = 0.45634794715707966, log_density = -667034.3171048738, hamiltonian_energy = 1.5735105397608085e6, hamiltonian_energy_error = -143.2663667120505, max_hamiltonian_energy_error = 1411.6526396672707, tree_depth = 6, numerical_error = true, step_size = 6.219134673509538e-5, nom_step_size = 6.219134673509538e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -666837.6370664146, hamiltonian_energy = 667085.190082089, hamiltonian_energy_error = -0.05831256217788905, max_hamiltonian_energy_error = -0.4682672885246575, tree_depth = 3, numerical_error = false, step_size = 2.0022807560379864e-5, nom_step_size = 2.0022807560379864e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -666086.8310558875, hamiltonian_energy = 666882.2828285993, hamiltonian_energy_error = -0.8924673127476126, max_hamiltonian_energy_error = -0.8924673127476126, tree_depth = 2, numerical_error = false, step_size = 3.6461054465457374e-5, nom_step_size = 3.6461054465457374e-5, is_adapt = true)  …  (n_steps = 1023, is_accept = true, acceptance_rate = 0.9999897792487699, log_density = -3468.457798076996, hamiltonian_energy = 3518.075868017619, hamiltonian_energy_error = -0.02588646028061703, max_hamiltonian_energy_error = -0.057378537243494065, tree_depth = 10, numerical_error = false, step_size = 9.214249447583029e-5, nom_step_size = 9.214249447583029e-5, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9983480872053685, log_density = -3476.775839013221, hamiltonian_energy = 3537.0789165882215, hamiltonian_energy_error = -0.004323929585552833, max_hamiltonian_energy_error = -0.027134838942401984, tree_depth = 10, numerical_error = false, step_size = 9.214249447583029e-5, nom_step_size = 9.214249447583029e-5, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9906230800723849, log_density = -3474.6126186837205, hamiltonian_energy = 3538.497294041742, hamiltonian_energy_error = 0.007608972001435177, max_hamiltonian_energy_error = 0.03880462857250677, tree_depth = 10, numerical_error = false, step_size = 9.214249447583029e-5, nom_step_size = 9.214249447583029e-5, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9973803267550512, log_density = -3461.12164725329, hamiltonian_energy = 3517.3042917939265, hamiltonian_energy_error = 0.007182411563917412, max_hamiltonian_energy_error = -0.020545034621136438, tree_depth = 10, numerical_error = false, step_size = 9.214249447583029e-5, nom_step_size = 9.214249447583029e-5, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9718713739024716, log_density = -3464.2141810618705, hamiltonian_energy = 3514.8155176348046, hamiltonian_energy_error = 0.027848316250128846, max_hamiltonian_energy_error = 0.07690994119184325, tree_depth = 10, numerical_error = false, step_size = 9.214249447583029e-5, nom_step_size = 9.214249447583029e-5, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9992470065341879, log_density = -3463.188711705242, hamiltonian_energy = 3521.159760627739, hamiltonian_energy_error = -0.011814704514108598, max_hamiltonian_energy_error = -0.04756580926550669, tree_depth = 10, numerical_error = false, step_size = 9.214249447583029e-5, nom_step_size = 9.214249447583029e-5, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9940072978287116, log_density = -3459.4304537075213, hamiltonian_energy = 3508.866322910426, hamiltonian_energy_error = 0.023687502589382348, max_hamiltonian_energy_error = 0.03113800589926541, tree_depth = 10, numerical_error = false, step_size = 9.214249447583029e-5, nom_step_size = 9.214249447583029e-5, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9960201839761127, log_density = -3457.4312432979627, hamiltonian_energy = 3524.1004351750103, hamiltonian_energy_error = -0.01946549803687958, max_hamiltonian_energy_error = -0.04551437534018987, tree_depth = 10, numerical_error = false, step_size = 9.214249447583029e-5, nom_step_size = 9.214249447583029e-5, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9769440469827394, log_density = -3449.739620965674, hamiltonian_energy = 3502.6986106583317, hamiltonian_energy_error = -0.0015399077128677163, max_hamiltonian_energy_error = 0.07359195059370904, tree_depth = 10, numerical_error = false, step_size = 9.214249447583029e-5, nom_step_size = 9.214249447583029e-5, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9985301561511696, log_density = -3453.2733201497044, hamiltonian_energy = 3496.61219715745, hamiltonian_energy_error = -0.0068397127197386, max_hamiltonian_energy_error = -0.016476779252116103, tree_depth = 10, numerical_error = false, step_size = 9.214249447583029e-5, nom_step_size = 9.214249447583029e-5, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-3.94 ± 0.042, -3.94 ± 0.042, -3.94 ± 0.042, -3.94 ± 0.042, -3.94 ± 0.041, -3.94 ± 0.041, -3.94 ± 0.041, -3.95 ± 0.041, -3.95 ± 0.04, -3.95 ± 0.04  …  -4.02 ± 0.014, -4.02 ± 0.014, -4.02 ± 0.014, -4.02 ± 0.014, -4.02 ± 0.014, -4.02 ± 0.014, -4.02 ± 0.014, -4.02 ± 0.014, -4.02 ± 0.014, -4.02 ± 0.014]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.835 ± 0.042 -1.71 ± 0.05; 0.465 ± 0.094 -0.832 ± 0.12; … ; -0.619 ± 0.042 1.34 ± 0.13; -0.528 ± 0.12 1.32 ± 0.16], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.618 ± 0.092; 0.759 ± 0.088; … ; -0.613 ± 0.085; -0.399 ± 0.22;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-1.6 ± 0.063 0.335 ± 0.11 … -0.964 ± 0.08 -0.183 ± 0.046; -1.76 ± 0.15 0.554 ± 0.069 … -0.148 ± 0.069 0.303 ± 0.055; … ; 1.18 ± 0.052 0.383 ± 0.084 … 0.605 ± 0.11 -0.759 ± 0.17; 1.09 ± 0.071 0.855 ± 0.13 … -0.452 ± 0.09 -0.712 ± 0.11], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.445 ± 0.12; -1.16 ± 0.17; … ; 0.231 ± 0.061; 0.00634 ± 0.069;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[2.45 ± 0.068 3.31 ± 0.3 … -3.33 ± 0.11 -2.63 ± 0.057], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.351 ± 0.22;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.862 ± 0.16], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="b09e18c2.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Saturday 16 March 2024 05:29">Saturday 16 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
