<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/complex/">Complex Equations with PINNs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+
                        randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                        noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -3.8235261465452406
 -4.187922545269026
 -4.1328259854020795
 -4.008682352461038
 -4.289491552235408
 -4.204476244760774
 -3.8612791940775617
 -3.95601819569968
 -3.8010564334698365
 -3.8465320579597537
  ⋮
 -4.209662928535032
 -3.6432837120788
 -3.863355725004886
 -4.235698160851259
 -3.944134806372472
 -3.7118379310866896
 -3.83980757817363
 -3.8420136767573787
 -3.8326427040799182</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title = &quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="2090dbfb.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[0.25060296865710047, -0.3458701117778078, -0.45514877049142743, -0.314383841784791, 0.6701770763184157, 0.05689247406961728, 0.36843875172244694, -0.303987623592633, -0.06881829169071726, 0.18337587802855046  …  0.6332630680319141, 0.603511337925109, 0.17522754497925772, -0.6130021021360035, 0.4829594850766283, -0.046943309568426864, -0.5495851524031496, 0.16143385170396019, -0.1519064609515525, 0.4989941941452678], [0.25060296865710047, -0.3458701117778078, -0.45514877049142743, -0.314383841784791, 0.6701770763184157, 0.05689247406961728, 0.36843875172244694, -0.303987623592633, -0.06881829169071726, 0.18337587802855046  …  0.6332630680319141, 0.603511337925109, 0.17522754497925772, -0.6130021021360035, 0.4829594850766283, -0.046943309568426864, -0.5495851524031496, 0.16143385170396019, -0.1519064609515525, 0.4989941941452678], [0.24939618529310842, -0.3455015171369171, -0.45330006092998515, -0.31589822226816944, 0.6668473957942427, 0.031391346704552195, 0.36836907399650715, -0.3013517986521959, -0.06258704971734337, 0.17723143775284458  …  0.6493559336748037, 0.5859672563379922, 0.18180292190925387, -0.6268909941810791, 0.47859200464682067, -0.04167782055878115, -0.553124851566198, 0.17592974616247495, -0.18232329107443493, 0.49894418495360604], [0.24939618529310842, -0.3455015171369171, -0.45330006092998515, -0.31589822226816944, 0.6668473957942427, 0.031391346704552195, 0.36836907399650715, -0.3013517986521959, -0.06258704971734337, 0.17723143775284458  …  0.6493559336748037, 0.5859672563379922, 0.18180292190925387, -0.6268909941810791, 0.47859200464682067, -0.04167782055878115, -0.553124851566198, 0.17592974616247495, -0.18232329107443493, 0.49894418495360604], [0.24931617812133147, -0.3451685069403661, -0.4530908040503101, -0.3157816640053417, 0.6664617741571838, 0.031326738404077126, 0.36827292969670045, -0.30126231580651175, -0.06238696112201759, 0.1769429088135333  …  0.6499433754530616, 0.5854452948108151, 0.18180788025654324, -0.6273203933439992, 0.47864217935682274, -0.04152005028302293, -0.5532300277127956, 0.1766195982143903, -0.1835137348918151, 0.49918602733532397], [0.24919505286486454, -0.34479730009526527, -0.4521266334251572, -0.31644838699114397, 0.6657131439563018, 0.03021209562574413, 0.3678062724120818, -0.3017944536575896, -0.060554492232096004, 0.17570628435771204  …  0.6543663954061849, 0.5819551069507968, 0.1832293861372996, -0.6308407316761961, 0.47767393755922577, -0.04030270336910614, -0.554999365534955, 0.1797142184903675, -0.1896278504447988, 0.4994019523183832], [0.24910423265026574, -0.34474811706903724, -0.45199663977491733, -0.3163474099319965, 0.6656282854057348, 0.030041420485678202, 0.36777459264155166, -0.30171344627283037, -0.06050959400449529, 0.17562011980305378  …  0.6545512428715383, 0.5818035849830883, 0.18326402986070872, -0.6310056663511633, 0.4776817067857884, -0.040345406913883775, -0.5551083716145232, 0.17993314110029296, -0.18990778898969568, 0.49942880659431726], [0.24878653956430166, -0.34468464848046104, -0.45126342735315417, -0.31642884968493706, 0.6652250816013869, 0.029289428166777744, 0.3676078466180368, -0.3016724528321262, -0.059812748578874426, 0.1750024611138595  …  0.6563297328026071, 0.5801056606100222, 0.18411850810259364, -0.6325764338145167, 0.4774909093546379, -0.03998260782621102, -0.5557589322680708, 0.18133932695488875, -0.19251026996742465, 0.4994933564600948], [0.24857265641934553, -0.3445687999075998, -0.4511313486744259, -0.31676671804807155, 0.6649001911073108, 0.029122071758345178, 0.36728586325535634, -0.3017692703049867, -0.05949612017229853, 0.17466353112910452  …  0.6573374905350319, 0.579357695997586, 0.18450474214421506, -0.6332530764868485, 0.4778126568328803, -0.03970265162222522, -0.5561578532778538, 0.18243040507085134, -0.19391743219264107, 0.49935624329120226], [0.24879693660136107, -0.3443297253126793, -0.45082405366489525, -0.317280558202991, 0.663735247907084, 0.028731057256528646, 0.36735296553202423, -0.3015703134362148, -0.05848605646020373, 0.17450619618231095  …  0.6596928533378787, 0.5778352294056591, 0.18528212837091992, -0.634973367815801, 0.47768718125736104, -0.03934302752371955, -0.5566596833801433, 0.18465699602734842, -0.19700717465769477, 0.4999003443142934]  …  [0.4198240362690245, -0.5891157279576577, -0.6270644154879188, -0.5310362789014658, -0.6139285186673843, -0.6499971242137725, 0.5938421736645496, 2.159701562890826, -0.8708362275952186, 1.2120889028724338  …  6.468318029382047, 3.970909019984791, 4.346081791587223, -6.60513545167122, -2.20955552964031, 2.4148768020177203, -3.859132686418082, 5.686478746002384, 2.2728341646879895, 1.5384063662541219], [0.41970286585471084, -0.5571110359332734, -0.6185408955645041, -0.5291614818218279, -0.5724684565216653, -0.641525306354449, 0.5837278088649503, 2.154326498163016, -0.8595057205362544, 1.2197695276704172  …  6.47612729329327, 3.9571949690449784, 4.34120247349157, -6.605667979488324, -2.2091661548086896, 2.410713967975537, -3.8563843320693985, 5.688109021832847, 2.270101599036031, 1.539501377365481], [0.4234461513591282, -0.5482074713950948, -0.624807170280409, -0.5219159947600703, -0.5430033885659228, -0.6306610698059003, 0.5795334942765515, 2.161474058779396, -0.8481919328341057, 1.2205015434430202  …  6.479303562174313, 3.953813300274228, 4.340221110907866, -6.606227119942826, -2.203824654598788, 2.40574598451783, -3.8607911136305675, 5.682750219714094, 2.2731451948285772, 1.5374805002745626], [0.42768473571707744, -0.5145391550424415, -0.6259381869030695, -0.5151755536317122, -0.5010169821573689, -0.6020205137086044, 0.5734603276860314, 2.1593561620481054, -0.8096863550132358, 1.220874324664886  …  6.478289643714737, 3.951648232081947, 4.328444883606154, -6.606460584706599, -2.200598869397165, 2.405415406425665, -3.85547103715284, 5.687827124118007, 2.2665331327435085, 1.540882167359778], [0.4292746339986991, -0.489822371759026, -0.6171645411135483, -0.5079584564047734, -0.47490522707015015, -0.5767538518426145, 0.5653356238442949, 2.1493873127690586, -0.7906170171410182, 1.1982170881275185  …  6.473545879526647, 3.9538750846523625, 4.329993337327752, -6.60752965797942, -2.185046259563782, 2.4198801431848858, -3.8345678450949934, 5.691899647737778, 2.2577581296246247, 1.5375483591315566], [0.4383222253958177, -0.47537914009362536, -0.6108196354536465, -0.5082624065346356, -0.46510629172007756, -0.5837637201481513, 0.558240816977086, 2.151253290157831, -0.7914986234250548, 1.1830181966794013  …  6.487288312134225, 3.95314264836199, 4.320339813854711, -6.619235234018426, -2.1875618379772943, 2.418937880364829, -3.799520228452035, 5.695428824123379, 2.2568419877746377, 1.5097603473459829], [0.44116302701453597, -0.48820482773228885, -0.6324295813117516, -0.5054803063492103, -0.42191590012165386, -0.5577282866376402, 0.5225731185555329, 2.160366573159781, -0.7874069109320632, 1.1684241630361427  …  6.54772911184394, 4.004131549299266, 4.337923336529771, -6.618087569690748, -2.218017512556869, 2.444603022376949, -3.8121890671548915, 5.776960100862691, 2.265476874305762, 1.3973303211264816], [0.48454766553062373, -0.514728452961351, -0.5392538630176777, -0.5180021554536064, -0.4645387291362488, -0.6364442730678287, 0.5423337307890789, 2.0793893367527976, -0.8068457076251881, 1.3196132012197346  …  6.641296074640703, 4.2238711358686825, 4.739260901790564, -6.337572489346519, -2.125136829848652, 2.221239774831052, -3.805200978878348, 5.677579081021341, 2.517209356176641, 0.8939702163900303], [0.5187080932944819, -0.49189065168484075, -0.540472155375547, -0.39289739531693996, -0.5094951733466452, -0.6916290245866502, 0.3966873704705717, 2.110852045430014, -0.8608769297331653, 1.3046366424238434  …  6.570631204606274, 4.261893645707972, 4.769724233787981, -6.4063530313346355, -2.1769540042788047, 2.4465102157024807, -3.866938329819124, 5.668863163810107, 2.5280686209327143, 0.9738727934799828], [0.537819713138189, -0.5312038031353314, -0.5482477883811692, -0.43569205232520347, -0.5436283270080817, -0.6394324501627106, 0.42493862984979053, 2.071424749425461, -0.8520044797357186, 1.383937920157644  …  6.429145722998652, 4.265382754589461, 5.017745342361363, -6.468043248477194, -2.229832160053917, 2.3671759966309422, -3.9414807713750806, 5.647570175422837, 2.6194638678868536, 0.9493670079952904]], NamedTuple[(n_steps = 3, is_accept = true, acceptance_rate = 0.3333333343921838, log_density = -1.662889534831697e6, hamiltonian_energy = 1.7340728850471315e6, hamiltonian_energy_error = -2804.757576366421, max_hamiltonian_energy_error = -2804.757576366421, tree_depth = 2, numerical_error = false, step_size = 0.00078125, nom_step_size = 0.00078125, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.662889534831697e6, hamiltonian_energy = 1.6629455471155683e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 341557.32712144894, tree_depth = 0, numerical_error = true, step_size = 0.0033442423594318396, nom_step_size = 0.0033442423594318396, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.646265956633479e6, hamiltonian_energy = 1.6627777064048497e6, hamiltonian_energy_error = -162.7137824613601, max_hamiltonian_energy_error = -162.7137824613601, tree_depth = 2, numerical_error = false, step_size = 0.00039461804860466707, nom_step_size = 0.00039461804860466707, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.0004498121936494269, log_density = -1.646265956633479e6, hamiltonian_energy = 1.6463247729236013e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 43.352330862311646, tree_depth = 2, numerical_error = false, step_size = 0.00045538376821972315, nom_step_size = 0.00045538376821972315, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9981152345542486, log_density = -1.6456986154876775e6, hamiltonian_energy = 1.6463263591512342e6, hamiltonian_energy_error = 0.0015746108256280422, max_hamiltonian_energy_error = 0.006566776195541024, tree_depth = 3, numerical_error = false, step_size = 3.776686539791611e-5, nom_step_size = 3.776686539791611e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9652868894171522, log_density = -1.6421306399341535e6, hamiltonian_energy = 1.645760816477138e6, hamiltonian_energy_error = 0.08731967769563198, max_hamiltonian_energy_error = 0.11502348398789763, tree_depth = 4, numerical_error = false, step_size = 5.406365470560301e-5, nom_step_size = 5.406365470560301e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.9784037236045382, log_density = -1.6419918399592156e6, hamiltonian_energy = 1.6421829706692835e6, hamiltonian_energy_error = 0.014428165974095464, max_hamiltonian_energy_error = 0.04770546196959913, tree_depth = 2, numerical_error = false, step_size = 7.841919352020662e-5, nom_step_size = 7.841919352020662e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.6844350585001394, log_density = -1.6403670970785483e6, hamiltonian_energy = 1.642038901955107e6, hamiltonian_energy_error = 0.350567176239565, max_hamiltonian_energy_error = 1.3261554623022676, tree_depth = 3, numerical_error = false, step_size = 0.00012660274972221464, nom_step_size = 0.00012660274972221464, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.9512010487881609, log_density = -1.6395627310988633e6, hamiltonian_energy = 1.6404196380448015e6, hamiltonian_energy_error = 0.1119148179423064, max_hamiltonian_energy_error = 0.1119148179423064, tree_depth = 2, numerical_error = false, step_size = 8.461169405621877e-5, nom_step_size = 8.461169405621877e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.8158364938978234, log_density = -1.6377548721848927e6, hamiltonian_energy = 1.6396166749159824e6, hamiltonian_energy_error = 0.47070901398546994, max_hamiltonian_energy_error = 0.47070901398546994, tree_depth = 2, numerical_error = false, step_size = 0.00013344171956284592, nom_step_size = 0.00013344171956284592, is_adapt = true)  …  (n_steps = 31, is_accept = true, acceptance_rate = 0.9356659560265447, log_density = -6929.0317231867375, hamiltonian_energy = 9382.668902800946, hamiltonian_energy_error = -37.8243139170263, max_hamiltonian_energy_error = -37.8243139170263, tree_depth = 5, numerical_error = false, step_size = 0.00012427404538584386, nom_step_size = 0.00012427404538584386, is_adapt = false), (n_steps = 63, is_accept = true, acceptance_rate = 1.0, log_density = -5995.378212128073, hamiltonian_energy = 6985.390826596856, hamiltonian_energy_error = -4.260119691905857, max_hamiltonian_energy_error = -4.706982668475575, tree_depth = 6, numerical_error = false, step_size = 0.00012427404538584386, nom_step_size = 0.00012427404538584386, is_adapt = false), (n_steps = 63, is_accept = true, acceptance_rate = 1.0, log_density = -5409.041326084151, hamiltonian_energy = 6054.847309011895, hamiltonian_energy_error = -0.7354284926113905, max_hamiltonian_energy_error = -0.8371388009563816, tree_depth = 6, numerical_error = false, step_size = 0.00012427404538584386, nom_step_size = 0.00012427404538584386, is_adapt = false), (n_steps = 63, is_accept = true, acceptance_rate = 0.9993100027942313, log_density = -4706.940241986149, hamiltonian_energy = 5452.105356334205, hamiltonian_energy_error = -0.08304363388651836, max_hamiltonian_energy_error = -0.12805064762505936, tree_depth = 6, numerical_error = false, step_size = 0.00012427404538584386, nom_step_size = 0.00012427404538584386, is_adapt = false), (n_steps = 127, is_accept = true, acceptance_rate = 0.99628050595926, log_density = -4320.898014474736, hamiltonian_energy = 4752.376928697329, hamiltonian_energy_error = -0.07425430987495929, max_hamiltonian_energy_error = -0.10689964937773766, tree_depth = 7, numerical_error = false, step_size = 0.00012427404538584386, nom_step_size = 0.00012427404538584386, is_adapt = false), (n_steps = 255, is_accept = true, acceptance_rate = 0.9243318472334824, log_density = -4113.536446620687, hamiltonian_energy = 4374.246214645833, hamiltonian_energy_error = 0.01865889518558106, max_hamiltonian_energy_error = 0.2359847263278425, tree_depth = 8, numerical_error = false, step_size = 0.00012427404538584386, nom_step_size = 0.00012427404538584386, is_adapt = false), (n_steps = 511, is_accept = true, acceptance_rate = 0.9989411975431977, log_density = -3895.81686751504, hamiltonian_energy = 4167.495453953649, hamiltonian_energy_error = -0.021723335300521285, max_hamiltonian_energy_error = -0.09928252817553584, tree_depth = 9, numerical_error = false, step_size = 0.00012427404538584386, nom_step_size = 0.00012427404538584386, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9892169494314068, log_density = -3690.040282090712, hamiltonian_energy = 3955.950053414845, hamiltonian_energy_error = 0.022665114575829648, max_hamiltonian_energy_error = -0.07778361790951749, tree_depth = 10, numerical_error = false, step_size = 0.00012427404538584386, nom_step_size = 0.00012427404538584386, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.8558770587077674, log_density = -3618.02762351808, hamiltonian_energy = 3736.3321961235815, hamiltonian_energy_error = 0.015551586188848887, max_hamiltonian_energy_error = 0.40064866035345403, tree_depth = 10, numerical_error = false, step_size = 0.00012427404538584386, nom_step_size = 0.00012427404538584386, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9879045454558645, log_density = -3601.7906636282946, hamiltonian_energy = 3674.5143764687773, hamiltonian_energy_error = 0.03226123887588983, max_hamiltonian_energy_error = -0.10678994419140508, tree_depth = 10, numerical_error = false, step_size = 0.00012427404538584386, nom_step_size = 0.00012427404538584386, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-3.61 ± 0.29, -3.61 ± 0.29, -3.61 ± 0.29, -3.61 ± 0.29, -3.61 ± 0.29, -3.61 ± 0.29, -3.61 ± 0.29, -3.61 ± 0.29, -3.61 ± 0.29, -3.61 ± 0.29  …  -4.14 ± 0.084, -4.14 ± 0.084, -4.14 ± 0.084, -4.14 ± 0.084, -4.14 ± 0.084, -4.15 ± 0.084, -4.15 ± 0.084, -4.15 ± 0.084, -4.15 ± 0.084, -4.15 ± 0.084]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.396 ± 0.045 -0.749 ± 0.12; -0.426 ± 0.072 0.646 ± 0.42; … ; 0.438 ± 0.08 0.235 ± 0.1; 0.239 ± 1.3 0.0792 ± 0.51], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.754 ± 0.06; -0.223 ± 0.055; … ; 0.479 ± 0.43; 0.0618 ± 0.3;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.756 ± 0.14 -0.27 ± 0.076 … -0.56 ± 0.2 -0.121 ± 0.037; 1.04 ± 0.49 -0.488 ± 0.16 … 0.537 ± 0.12 -0.0648 ± 0.023; … ; -0.533 ± 0.3 0.23 ± 0.24 … -0.176 ± 0.46 0.366 ± 0.22; 0.674 ± 0.53 0.118 ± 0.22 … -0.148 ± 0.44 0.122 ± 0.11], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.676 ± 0.13; 0.388 ± 0.074; … ; -0.376 ± 0.13; -0.992 ± 1.0;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[4.33 ± 1.5 1.86 ± 1.5 … -2.28 ± 1.1 3.33 ± 1.7], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.46 ± 1.3;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.764 ± 0.44], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain)
          for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="54d01c4e.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Saturday 29 June 2024 17:48">Saturday 29 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
