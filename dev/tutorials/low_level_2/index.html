<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../data_collocation_Inverse/">Improved PINNs for Inverse problems in ODEs</a></li><li><a class="tocitem" href="../pino_ode/">Physics informed Neural Operator ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/complex/">Complex Equations with PINNs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li><li><a class="tocitem" href="../../manual/pino_ode/">Physics-Informed Neural Operator (PINO) for ODEs</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+
                        randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                        noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -3.8312722858247645
 -3.6938911339822997
 -4.126199072631719
 -3.992690731014401
 -3.919340968313827
 -3.8499232140001896
 -3.8775925416919645
 -4.04309332209973
 -3.977539706716
 -3.8160957620290157
  ⋮
 -3.9759503246732546
 -4.474320327916157
 -4.057644750636047
 -3.8145061673432368
 -4.036817016641685
 -4.121118234395343
 -3.903459525189513
 -3.519725444071715
 -4.119483795525267</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title = &quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="b0827eac.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Chain(Dense(2, 8, tanh), Dense(8, 8, tanh), Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, Shaped1DAxis((8,))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, Shaped1DAxis((8,))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, Shaped1DAxis((1,))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[1.0195435900253214, 1.1091891980037498, -2.004054901259954, -1.8594798621823843, -0.35785554079980997, -1.1825071932703446, 1.0942613338375147, 1.112816718936772, 0.852099103373125, 0.43949138622681605  …  -0.26495917383287215, -0.34951329190101277, -0.3215938594758977, -0.20514942200760913, 0.3433607022907383, -0.2756669707623607, 0.40027511864663934, 0.19940542646781584, 0.06876718748541344, 0.498713179431552], [1.0195435900253214, 1.1091891980037498, -2.004054901259954, -1.8594798621823843, -0.35785554079980997, -1.1825071932703446, 1.0942613338375147, 1.112816718936772, 0.852099103373125, 0.43949138622681605  …  -0.26495917383287215, -0.34951329190101277, -0.3215938594758977, -0.20514942200760913, 0.3433607022907383, -0.2756669707623607, 0.40027511864663934, 0.19940542646781584, 0.06876718748541344, 0.498713179431552], [1.0195435900253214, 1.1091891980037498, -2.004054901259954, -1.8594798621823843, -0.35785554079980997, -1.1825071932703446, 1.0942613338375147, 1.112816718936772, 0.852099103373125, 0.43949138622681605  …  -0.26495917383287215, -0.34951329190101277, -0.3215938594758977, -0.20514942200760913, 0.3433607022907383, -0.2756669707623607, 0.40027511864663934, 0.19940542646781584, 0.06876718748541344, 0.498713179431552], [1.0208940142393643, 1.1088515748137018, -2.0025221005085316, -1.8581128857662492, -0.35782506943496567, -1.1802836190203876, 1.0948669578752863, 1.1121426655274744, 0.8511886290711467, 0.4390115904930831  …  -0.26835903677232514, -0.3449021460917373, -0.32694980500019877, -0.21385646509425904, 0.34283022817383285, -0.2672606245320771, 0.3954908236633531, 0.19922013803006958, 0.060398611563835414, 0.4987001263073728], [1.0216266845778053, 1.1086882416019004, -2.0008342170462816, -1.8553393504216766, -0.3558074428430622, -1.1761586783083025, 1.095803088025421, 1.1092468573808512, 0.849140291085895, 0.43819809403128773  …  -0.2763811062813607, -0.33758709280540367, -0.33875845638043445, -0.2294321564993739, 0.34192028976310324, -0.2538724095465939, 0.3871974117679342, 0.19910039991192047, 0.04521972143833984, 0.4981049341750628], [1.0242502949732695, 1.105310863496876, -1.9921377753608032, -1.8415422370554126, -0.3475640503321418, -1.1572732462038071, 1.101600052164061, 1.0891603320450158, 0.8412266740699337, 0.43238621029540336  …  -0.3170957362053941, -0.308417963269553, -0.40797260589846573, -0.30889896912721376, 0.3350951721879836, -0.19766447680101035, 0.3483925493666061, 0.1968637448974952, -0.03471877092259856, 0.4978781219740005], [1.0230499928381824, 1.1026561898963232, -1.9914583026113661, -1.836810422973721, -0.34737081082011295, -1.1525929302925904, 1.1042700447574818, 1.0818116531651778, 0.8404870966607538, 0.43009379740279163  …  -0.32909806007622444, -0.3070151974953659, -0.4338594696350323, -0.33104047498471534, 0.33507350593235313, -0.19351873934945496, 0.33722236256868693, 0.1934224842203226, -0.05634328191332477, 0.49758590532591607], [1.0230499928381824, 1.1026561898963232, -1.9914583026113661, -1.836810422973721, -0.34737081082011295, -1.1525929302925904, 1.1042700447574818, 1.0818116531651778, 0.8404870966607538, 0.43009379740279163  …  -0.32909806007622444, -0.3070151974953659, -0.4338594696350323, -0.33104047498471534, 0.33507350593235313, -0.19351873934945496, 0.33722236256868693, 0.1934224842203226, -0.05634328191332477, 0.49758590532591607], [1.0230595165215242, 1.1026898172441013, -1.9913990706719322, -1.8368233158799294, -0.34745916849109926, -1.1524933269154427, 1.1044286118969595, 1.0815864614570025, 0.8405675984234682, 0.4300821437316204  …  -0.3292548250228962, -0.30708464522017054, -0.4342464681962369, -0.3314046447784711, 0.335145674873847, -0.19356219754736373, 0.3368436908022843, 0.19341910350367056, -0.056803879711597983, 0.4977463248708041], [1.023187985136589, 1.10018284100079, -1.9918615340568242, -1.8351695779474797, -0.34760632706526684, -1.1497035337208483, 1.1056368891945367, 1.0762827381018696, 0.8401908550003107, 0.42893326643287644  …  -0.33758412212649647, -0.3058933435015354, -0.4495020548596021, -0.3434847425064897, 0.3336833706763483, -0.19327783357865458, 0.33101751155133585, 0.19273956358209512, -0.07072498330126938, 0.49732146581999326]  …  [1.358622153957325, 0.47912513098869597, -1.7650194527260588, -1.1433450943765417, -0.5030505114980843, -0.6086249080754961, 1.3049695987718237, 0.8344423860004226, 0.5190985291686224, -1.1554955480527522  …  -3.2166092926909755, -2.2576202143120576, -4.318471583403184, -3.8128465515562042, 0.6966407975191196, -1.9919353504710502, -1.4465936138459974, 0.24044611373176072, 0.42216868450591605, 0.59501018771531], [1.3594075529061427, 0.47907281327804907, -1.7647635033115396, -1.1432483520297005, -0.5033017817235106, -0.6085493461006779, 1.3056883010785179, 0.8335943341784177, 0.5187552889627022, -1.1550909139580332  …  -3.21638120556484, -2.257300793940545, -4.318552083538198, -3.8124798607597143, 0.6966000367347063, -1.9923441066727081, -1.4470189240906737, 0.24054517367602954, 0.4223567426976569, 0.5951687014482931], [1.3596391171739204, 0.4784938425975032, -1.7650944934357384, -1.143473744725448, -0.503028738837277, -0.6093894665141737, 1.3055708291053394, 0.8334747711675607, 0.5191759146278181, -1.1561307963208969  …  -3.2162085411159933, -2.260079054251877, -4.3192524925090545, -3.8131107689541652, 0.6959241346115866, -1.9923631743283183, -1.4480873979601505, 0.24118910432382518, 0.4224496139449346, 0.5936300245281788], [1.3599617948318685, 0.4788669957036937, -1.7644764570761404, -1.1431857872311086, -0.5027328285563045, -0.6097279332880413, 1.3048684714590166, 0.8329775791811842, 0.5188429240692942, -1.1557981214790904  …  -3.216207125237979, -2.259903755283982, -4.31905708586937, -3.813281138244401, 0.6963286560334633, -1.99227520137714, -1.4489531993831046, 0.24042992045837766, 0.42257960586420973, 0.5935501702937503], [1.3602736816007877, 0.47913039001673985, -1.7633968126874893, -1.1443402301170602, -0.5022809401731825, -0.6091062590239386, 1.3039240288879617, 0.8321004262464897, 0.5191303387576647, -1.1566197306639385  …  -3.2169912166602592, -2.260546210922531, -4.319119223495459, -3.8150860287453408, 0.696782613374535, -1.9923496562508272, -1.4515658581123407, 0.2389823901428388, 0.42149661163897173, 0.5952976600393685], [1.3614036277924035, 0.47822394713785504, -1.7630081121617653, -1.1434262710932954, -0.5033295666212795, -0.6085054747694798, 1.3041529544129309, 0.8326153931187191, 0.518561380128835, -1.1553186573983032  …  -3.2220320579023163, -2.260396700251866, -4.320399507071992, -3.8173478037875572, 0.6978067938551743, -1.996046548166893, -1.4527554372314302, 0.239128317240949, 0.4191480971650083, 0.5950616811474533], [1.3601700044556493, 0.4796266480324091, -1.7621454721616363, -1.1424912248302175, -0.5024329353135781, -0.6089419192209096, 1.3030991762419415, 0.8324777571481125, 0.5176952301308884, -1.1550667544154118  …  -3.2227669919546416, -2.260390192609047, -4.32088284111099, -3.8175323852551437, 0.6971305582073225, -1.9955673549022805, -1.4527897303797155, 0.23973080963541743, 0.41996973567802853, 0.5954889493566342], [1.3589329764854783, 0.47895261394752364, -1.7619307333934942, -1.1423519973422993, -0.5028566507545996, -0.6086373709380779, 1.3033466224238262, 0.831916743922939, 0.5177486916672134, -1.155076403641083  …  -3.2226747690548017, -2.2602827296323436, -4.321218938614874, -3.817387585821009, 0.69692655056784, -1.9955997880538496, -1.4521942548118245, 0.23982500276071841, 0.42019976203264675, 0.595185151519259], [1.3589329764854783, 0.47895261394752364, -1.7619307333934942, -1.1423519973422993, -0.5028566507545996, -0.6086373709380779, 1.3033466224238262, 0.831916743922939, 0.5177486916672134, -1.155076403641083  …  -3.2226747690548017, -2.2602827296323436, -4.321218938614874, -3.817387585821009, 0.69692655056784, -1.9955997880538496, -1.4521942548118245, 0.23982500276071841, 0.42019976203264675, 0.595185151519259], [1.3566629150843577, 0.4783443401216389, -1.762761515854434, -1.1420214008280816, -0.5046874036066813, -0.6111191934766219, 1.302061768629315, 0.8323215393216584, 0.5191106059178806, -1.1554681431041363  …  -3.2234927356121212, -2.26119918945816, -4.322241382252979, -3.8172157121868566, 0.697953846982372, -1.9954477677619946, -1.4522713284110391, 0.2391291018853967, 0.4197483913017543, 0.5958161809148061]], NamedTuple[(n_steps = 1, is_accept = true, acceptance_rate = 1.0, log_density = -1.7690210516913182e6, hamiltonian_energy = 1.8272083242768778e6, hamiltonian_energy_error = -3182.093385556247, max_hamiltonian_energy_error = -3182.093385556247, tree_depth = 1, numerical_error = false, step_size = 0.00078125, nom_step_size = 0.00078125, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.7690210516913182e6, hamiltonian_energy = 1.7690815614037148e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1.2534315479193723e12, tree_depth = 0, numerical_error = true, step_size = 0.011238679762325607, nom_step_size = 0.011238679762325607, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.7690210516913182e6, hamiltonian_energy = 1.769059082269861e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 57637.85341683682, tree_depth = 0, numerical_error = true, step_size = 0.0018993494877672993, nom_step_size = 0.0018993494877672993, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.7598423284400383e6, hamiltonian_energy = 1.7690226811523754e6, hamiltonian_energy_error = -62.76647280761972, max_hamiltonian_energy_error = -62.76647280761972, tree_depth = 2, numerical_error = false, step_size = 0.00018733703557689892, nom_step_size = 0.00018733703557689892, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.7449392118233612e6, hamiltonian_energy = 1.7597358088905313e6, hamiltonian_energy_error = -161.1101507851854, max_hamiltonian_energy_error = -161.1101507851854, tree_depth = 2, numerical_error = false, step_size = 0.00025338469449058976, nom_step_size = 0.00025338469449058976, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.6868967533054478e6, hamiltonian_energy = 1.7442564759177826e6, hamiltonian_energy_error = -729.8334349365905, max_hamiltonian_energy_error = -729.8334349365905, tree_depth = 2, numerical_error = false, step_size = 0.0003962543583196465, nom_step_size = 0.0003962543583196465, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 1.0, log_density = -1.6722568091018496e6, hamiltonian_energy = 1.6868624543223896e6, hamiltonian_energy_error = -87.29756334633566, max_hamiltonian_energy_error = -87.29756334633566, tree_depth = 1, numerical_error = false, step_size = 0.0006745127317215788, nom_step_size = 0.0006745127317215788, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 8.7419262333458e-39, log_density = -1.6722568091018496e6, hamiltonian_energy = 1.672316140079934e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 87.63268806855194, tree_depth = 1, numerical_error = false, step_size = 0.00120699748002278, nom_step_size = 0.00120699748002278, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9998763488274477, log_density = -1.6720047237855478e6, hamiltonian_energy = 1.6723123409115935e6, hamiltonian_energy_error = -0.009875689633190632, max_hamiltonian_energy_error = -0.11760172247886658, tree_depth = 3, numerical_error = false, step_size = 9.593825108613214e-5, nom_step_size = 9.593825108613214e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -1.6631707999048433e6, hamiltonian_energy = 1.672055339881497e6, hamiltonian_energy_error = -0.374666313175112, max_hamiltonian_energy_error = -0.4274550557602197, tree_depth = 3, numerical_error = false, step_size = 0.00017655212039107307, nom_step_size = 0.00017655212039107307, is_adapt = true)  …  (n_steps = 19, is_accept = true, acceptance_rate = 0.010831677063186869, log_density = -8423.732713619025, hamiltonian_energy = 8481.116639945685, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1245.0955431610273, tree_depth = 4, numerical_error = true, step_size = 0.00036920983960965395, nom_step_size = 0.00036920983960965395, is_adapt = false), (n_steps = 21, is_accept = true, acceptance_rate = 0.019006068212701094, log_density = -8426.179106541535, hamiltonian_energy = 8470.48574986225, hamiltonian_energy_error = 0.9242218850558857, max_hamiltonian_energy_error = 1448.1443595400306, tree_depth = 4, numerical_error = true, step_size = 0.00036920983960965395, nom_step_size = 0.00036920983960965395, is_adapt = false), (n_steps = 21, is_accept = true, acceptance_rate = 0.06506732277049487, log_density = -8411.719650438446, hamiltonian_energy = 8490.070986601764, hamiltonian_energy_error = 1.0122760176727752, max_hamiltonian_energy_error = 1202.2296527009876, tree_depth = 4, numerical_error = true, step_size = 0.00036920983960965395, nom_step_size = 0.00036920983960965395, is_adapt = false), (n_steps = 26, is_accept = true, acceptance_rate = 0.1393679721750291, log_density = -8403.238464230106, hamiltonian_energy = 8466.677245602392, hamiltonian_energy_error = -3.0604254715271964, max_hamiltonian_energy_error = 1144.8193828803396, tree_depth = 4, numerical_error = true, step_size = 0.00036920983960965395, nom_step_size = 0.00036920983960965395, is_adapt = false), (n_steps = 26, is_accept = true, acceptance_rate = 0.1263968652319276, log_density = -8394.607065876999, hamiltonian_energy = 8464.345214768335, hamiltonian_energy_error = -0.09271280292705342, max_hamiltonian_energy_error = 1509.8524605548864, tree_depth = 4, numerical_error = true, step_size = 0.00036920983960965395, nom_step_size = 0.00036920983960965395, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.20315128745995786, log_density = -8359.258129824193, hamiltonian_energy = 8443.741178992279, hamiltonian_energy_error = 0.2667538883142697, max_hamiltonian_energy_error = 416.5626158628784, tree_depth = 5, numerical_error = false, step_size = 0.00036920983960965395, nom_step_size = 0.00036920983960965395, is_adapt = false), (n_steps = 23, is_accept = true, acceptance_rate = 0.03493617088676137, log_density = -8352.802147717131, hamiltonian_energy = 8422.798929163122, hamiltonian_energy_error = 1.7078810020102537, max_hamiltonian_energy_error = 1089.6279841074756, tree_depth = 4, numerical_error = true, step_size = 0.00036920983960965395, nom_step_size = 0.00036920983960965395, is_adapt = false), (n_steps = 24, is_accept = true, acceptance_rate = 0.08956721833228544, log_density = -8348.102311750357, hamiltonian_energy = 8398.180974988294, hamiltonian_energy_error = -1.8635881565169257, max_hamiltonian_energy_error = 1580.1543300880476, tree_depth = 4, numerical_error = true, step_size = 0.00036920983960965395, nom_step_size = 0.00036920983960965395, is_adapt = false), (n_steps = 19, is_accept = true, acceptance_rate = 0.00039190839280243836, log_density = -8348.102311750357, hamiltonian_energy = 8407.2959210252, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1457.2392016415342, tree_depth = 4, numerical_error = true, step_size = 0.00036920983960965395, nom_step_size = 0.00036920983960965395, is_adapt = false), (n_steps = 28, is_accept = true, acceptance_rate = 0.08746076207715785, log_density = -8333.243371798766, hamiltonian_energy = 8398.94207932812, hamiltonian_energy_error = 2.0872084099974018, max_hamiltonian_energy_error = 1395.4760776027742, tree_depth = 4, numerical_error = true, step_size = 0.00036920983960965395, nom_step_size = 0.00036920983960965395, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-4.0 ± 0.0036, -4.0 ± 0.0036, -4.0 ± 0.0036, -4.0 ± 0.0036, -4.0 ± 0.0036, -4.0 ± 0.0036, -4.0 ± 0.0036, -4.0 ± 0.0036, -4.0 ± 0.0036, -4.0 ± 0.0036  …  -3.93 ± 0.0038, -3.93 ± 0.0038, -3.93 ± 0.0038, -3.93 ± 0.0038, -3.93 ± 0.0038, -3.93 ± 0.0038, -3.93 ± 0.0038, -3.93 ± 0.0038, -3.93 ± 0.0038, -3.93 ± 0.0038]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, Shaped1DAxis((8,))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, Shaped1DAxis((8,))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, Shaped1DAxis((1,))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[1.36 ± 0.0019 0.521 ± 0.0023; 0.479 ± 0.00048 -1.16 ± 0.00063; … ; 1.31 ± 0.0015 0.832 ± 0.0015; 0.833 ± 0.0014 -1.61 ± 0.0022], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.0622 ± 0.0046, 0.734 ± 0.0019, 0.251 ± 0.0013, -0.222 ± 0.0039, 0.0727 ± 0.0024, -0.321 ± 0.0023, -0.0653 ± 0.0027, -0.842 ± 0.0014]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.35 ± 0.0028 -1.19 ± 0.0042 … -0.118 ± 0.0013 1.58 ± 0.0017; 0.847 ± 0.0016 0.132 ± 0.0013 … -0.562 ± 0.0018 0.947 ± 0.0038; … ; -0.347 ± 0.0015 -1.45 ± 0.0015 … -0.593 ± 0.0016 0.797 ± 0.0016; 0.0862 ± 0.0017 0.546 ± 0.0023 … -0.652 ± 0.0017 -0.207 ± 0.0017], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.483 ± 0.0046, -0.569 ± 0.0015, 1.18 ± 0.0011, 0.18 ± 0.0019, -0.997 ± 0.00063, 0.042 ± 0.0028, -0.565 ± 0.00084, -0.44 ± 0.0018]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-3.21 ± 0.0072 -2.25 ± 0.0076 … -1.44 ± 0.0073 0.241 ± 0.002], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.416 ± 0.0078]))], MonteCarloMeasurements.Particles{Float64, 34}[0.593 ± 0.0033], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain)
          for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="9686846f.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Tuesday 27 May 2025 18:58">Tuesday 27 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
