<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -4.206272679500598
 -3.947939028131199
 -3.867297857865823
 -3.889160104666406
 -3.89066762811528
 -4.178329979835371
 -3.840752235270504
 -3.6460419263559896
 -3.9071937583575127
 -3.9063203319605124
  ⋮
 -3.5492628298975935
 -4.111945461255053
 -3.735367540915333
 -3.5652070605178454
 -3.938346537714311
 -4.052650702615878
 -3.727913883733746
 -4.249518490175731
 -3.6427112825689543</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="b14159a6.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2), NamedTuple())), bias = ViewAxis(17:24, ShapedAxis((8, 1), NamedTuple())))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8), NamedTuple())), bias = ViewAxis(65:72, ShapedAxis((8, 1), NamedTuple())))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8), NamedTuple())), bias = ViewAxis(9:9, ShapedAxis((1, 1), NamedTuple())))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[-0.8017183285706422, -0.208774265961276, -0.17774163020232386, -0.3671861206184188, -0.38267547338516145, -0.692810698535878, 0.7037382911255011, -0.5073373007726782, 0.645466555020506, -0.4507192960263415  …  -0.5227578264584306, -0.3218504985938107, 0.7575912595509182, -0.01491073808122545, 0.25933163391400205, -0.447769689117575, 0.12797441340332666, -0.7219802367378502, -0.1727297603739244, 0.49822258138951653], [-0.8017183285706422, -0.208774265961276, -0.17774163020232386, -0.3671861206184188, -0.38267547338516145, -0.692810698535878, 0.7037382911255011, -0.5073373007726782, 0.645466555020506, -0.4507192960263415  …  -0.5227578264584306, -0.3218504985938107, 0.7575912595509182, -0.01491073808122545, 0.25933163391400205, -0.447769689117575, 0.12797441340332666, -0.7219802367378502, -0.1727297603739244, 0.49822258138951653], [-0.8017183285706422, -0.208774265961276, -0.17774163020232386, -0.3671861206184188, -0.38267547338516145, -0.692810698535878, 0.7037382911255011, -0.5073373007726782, 0.645466555020506, -0.4507192960263415  …  -0.5227578264584306, -0.3218504985938107, 0.7575912595509182, -0.01491073808122545, 0.25933163391400205, -0.447769689117575, 0.12797441340332666, -0.7219802367378502, -0.1727297603739244, 0.49822258138951653], [-0.8627296191022988, -0.17578562728033503, -0.38078995770269153, -0.3597896652818664, -0.4254646782501676, -0.671787796682854, 0.553106773732561, -0.4847544802699839, 0.4518653299400071, -0.47589079041952614  …  -0.6106131953600712, -0.4951237777920921, 1.052405679565439, -0.20275310313285144, 0.09399684529844257, -0.6700123557825701, -0.0007635433015389225, -0.929919476029196, -0.5509030003992499, 0.4951790467573189], [-0.8625453711783895, -0.1759919641055652, -0.38089759158199155, -0.35990102646869665, -0.4255639421739828, -0.6717741346992621, 0.5532595986075587, -0.4847621740968043, 0.451776783364168, -0.4759263417844175  …  -0.6109399627449096, -0.49518930474262923, 1.0532155676072048, -0.20290995885464588, 0.09395481740030341, -0.6705900891559958, -0.001080017496132296, -0.9305513049179296, -0.5508646639388071, 0.4952896044707708], [-0.8622856914138083, -0.17620235730660483, -0.38116162163508405, -0.3600185906122271, -0.4259255209942538, -0.6717220871748263, 0.5534463367427754, -0.48474890881180466, 0.4515918729717594, -0.47580741798514353  …  -0.6113597850290721, -0.49560841414881535, 1.0545648952071118, -0.2032950125968691, 0.09390221801049776, -0.6714524969690155, -0.0016501525993583097, -0.9315135564392539, -0.5512309984273638, 0.4953511763457538], [-0.8623470631464217, -0.17696864665986992, -0.3820748137344248, -0.3597038985537393, -0.42669842085953275, -0.6713570358574004, 0.5534682520774716, -0.4847764715859586, 0.45115867738887316, -0.47578364899344994  …  -0.6123178684729044, -0.4959698416602994, 1.0574264208624145, -0.20390688245531852, 0.09374745196843433, -0.6737171438677368, -0.0026208897153331603, -0.9338981132878698, -0.5518474126136098, 0.4948716831109332], [-0.8621736671604449, -0.1787815068133256, -0.38451891955521633, -0.359077370023028, -0.42846597713543283, -0.6704452039178246, 0.5544781583884747, -0.4851634421837321, 0.4499074015459246, -0.47636258537521997  …  -0.6157041152278023, -0.49788054526860165, 1.0669217609837598, -0.20600950909888674, 0.09295501682933341, -0.6805274633396582, -0.006414157687914363, -0.942258340241538, -0.5537426403655126, 0.49480313293660505], [-0.8619665301213073, -0.17904793047596787, -0.38461136985821437, -0.35892032374230465, -0.42870651606126825, -0.670392012623937, 0.5547573084250306, -0.485373359018322, 0.44981455896887246, -0.47635363557978505  …  -0.6159353608491789, -0.4980534173868266, 1.0678200075473778, -0.20632385389252875, 0.09286182521302365, -0.6811994612682138, -0.00677653960939589, -0.9430114779509245, -0.5538568457632991, 0.49483993071243687], [-0.8618765794210445, -0.17907116883924604, -0.3848267515368672, -0.3590250581124438, -0.4288306383964708, -0.670295673346033, 0.5548796453398239, -0.48539583085456833, 0.44979869689770746, -0.47631746474851266  …  -0.6160594621566591, -0.49813036495590746, 1.0684145728174677, -0.20653659553550469, 0.09277016321757972, -0.6816208341897422, -0.0069298289301718725, -0.9435356887803369, -0.5538966759039764, 0.4948568289266324]  …  [-0.5023787051701907, -0.7273107944796336, -1.0096045601243555, -0.32425987562156905, -0.5821550387189964, -0.92009456789936, 0.6993614591580883, -0.4495922922575891, 1.2878249418591339, 0.21363395957569836  …  -2.109434289242313, -1.3925737551594455, 3.1961452084415347, -1.43597825922612, 0.21187555066734018, -2.3847124130450217, -1.3614730359651535, -2.801360480250121, 0.31368307664790884, 0.4735859276006998], [-0.612240141602022, -0.621972571508709, -0.7596670757655859, -0.3373369510011449, -0.7437689391737389, -0.329977273485789, 0.6697741078378852, -0.4758097096724103, 1.4657119305703736, 0.7183875690839815  …  -3.2671176080269513, -2.2032414102939435, 4.326399617243996, -2.396188807785006, 0.5574825756816896, -3.415434153024111, -2.2874796065890655, -3.8100441147075528, 1.1000759556955024, 0.7364755849465943], [-0.5997591795858522, -0.6172841842231194, -0.7428925142967283, -0.3330584822495809, -0.7485901530786967, -0.34164405053176855, 0.6829218773021308, -0.4576156185476937, 1.4740932650827812, 0.7239295947780698  …  -3.26391032678229, -2.201574117893654, 4.3261394554146415, -2.3939578893386555, 0.5541411405702064, -3.418030218819233, -2.285099020670165, -3.8086246341764443, 1.1024862997777063, 0.7368648364681732], [-0.5887026050767131, -0.6075294272923188, -0.7377331341551141, -0.32724496145825677, -0.7492731988030515, -0.35747537591044365, 0.6770643609417463, -0.44599173609340526, 1.4530152004684194, 0.7353256121681057  …  -3.2618596485609586, -2.1944820254557618, 4.323184039307072, -2.3794872670393885, 0.5544936876834085, -3.4203537567940643, -2.2757820646250577, -3.803992848853601, 1.0998619098020752, 0.7366045974424988], [-0.5933043260923152, -0.6053728531686887, -0.7347120371251986, -0.32855052086948083, -0.7527008944588801, -0.3627497837782811, 0.6782076932839072, -0.44368154274132415, 1.4459454699926366, 0.7342425696043098  …  -3.2596152579856863, -2.190432188539212, 4.323614523267552, -2.3769945665283525, 0.554165378008679, -3.421293659060545, -2.274161754520059, -3.802392003913218, 1.0999396448454342, 0.736857590909886], [-0.5801226472311496, -0.5751655556688614, -0.7433327612828918, -0.3473826990706624, -0.7621519442791422, -0.4023254344754057, 0.6823276072540901, -0.4403248782987993, 1.390259379949792, 0.742552408468669  …  -3.261025265787893, -2.1805664118393757, 4.315933709739389, -2.3775989116162712, 0.5496621405491539, -3.411957200705555, -2.2558512874680186, -3.784716469869021, 1.0972091375171646, 0.7456759137669184], [-0.5531853350081952, -0.5771496695008475, -0.7327112066667433, -0.3569470321195584, -0.7707288488095221, -0.4491511897669806, 0.689102732163164, -0.43028297886088607, 1.354783256907791, 0.7426217757021188  …  -3.269773774863785, -2.173637228845545, 4.323693829647856, -2.3661452279482678, 0.5441738087399205, -3.398557741081553, -2.259741123622989, -3.775335348148336, 1.0887649988984436, 0.7522992306754265], [-0.5030482501262845, -0.6094381604539191, -0.7036406826576664, -0.4705393153434619, -0.7288630138977968, -0.6007288581182917, 0.7064283921177965, -0.4017452903537707, 1.2557088633186313, 0.7504420026637247  …  -3.290465499296268, -2.2327905176289193, 4.292255505918626, -2.3348411804689864, 0.5168591112839688, -3.390344320623813, -2.2147816904815523, -3.803465731036405, 1.0626557651127895, 0.798033352020202], [-0.4776313971590302, -0.7690024597480161, -0.6716324740972649, -0.44583014786940534, -0.5900098482173426, -0.6511172393787781, 0.6848297034787868, -0.5206378130351259, 1.039741649770209, 0.4961726057391814  …  -3.23133944769182, -2.279398807160281, 4.253473658296379, -2.5345835994117882, 0.5248197017069255, -3.44976855033685, -2.2228565469046515, -4.009112569830673, 1.1246802373602829, 1.0176737436953005], [-0.47861342904499865, -0.6565681580732415, -0.6624127245906377, -0.43716133984598005, -0.6097943791258177, -0.5964262418242743, 0.6774093648842556, -0.493927423407009, 1.054472299117984, 0.4816453709762938  …  -3.256124185311908, -2.299566223634372, 4.198956840533999, -2.5672241363373165, 0.5663596438607537, -3.4454843055317528, -2.2950650486487865, -4.013667160871354, 1.0915808228123072, 1.029986760869819]], NamedTuple[(n_steps = 2, is_accept = true, acceptance_rate = 0.5, log_density = -1.6423841781049916e6, hamiltonian_energy = 1.7581152546869372e6, hamiltonian_energy_error = -10990.897056782153, max_hamiltonian_energy_error = 24538.799596676603, tree_depth = 1, numerical_error = true, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6423841781049916e6, hamiltonian_energy = 1.6424328602594596e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 4.698420955620601e8, tree_depth = 0, numerical_error = true, step_size = 0.009055910606012648, nom_step_size = 0.009055910606012648, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.0, log_density = -1.6423841781049916e6, hamiltonian_energy = 1.642440528359504e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 5032.236305680359, tree_depth = 1, numerical_error = true, step_size = 0.0011689984204270615, nom_step_size = 0.0011689984204270615, is_adapt = true), (n_steps = 55, is_accept = true, acceptance_rate = 0.6426033001480288, log_density = -1.1280791214125843e6, hamiltonian_energy = 1.6424048469915437e6, hamiltonian_energy_error = -29.41908884863369, max_hamiltonian_energy_error = -1601.800037954934, tree_depth = 5, numerical_error = true, step_size = 9.886049642915416e-5, nom_step_size = 9.886049642915416e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.9939183617975953, log_density = -1.1272957417277747e6, hamiltonian_energy = 1.1281273266940664e6, hamiltonian_energy_error = 0.012989017646759748, max_hamiltonian_energy_error = 0.012989017646759748, tree_depth = 2, numerical_error = false, step_size = 4.374385690362404e-5, nom_step_size = 4.374385690362404e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.9794834579490778, log_density = -1.1259913452807844e6, hamiltonian_energy = 1.1273439752666848e6, hamiltonian_energy_error = 0.04249691031873226, max_hamiltonian_energy_error = 0.04249691031873226, tree_depth = 2, numerical_error = false, step_size = 6.038909183992008e-5, nom_step_size = 6.038909183992008e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.5119360084852355, log_density = -1.122996938108183e6, hamiltonian_energy = 1.1260359608279907e6, hamiltonian_energy_error = 0.15384403290227056, max_hamiltonian_energy_error = 1.8550882586278021, tree_depth = 4, numerical_error = false, step_size = 9.005920095380778e-5, nom_step_size = 9.005920095380778e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9314794290235954, log_density = -1.1131440252559353e6, hamiltonian_energy = 1.1230580871758321e6, hamiltonian_energy_error = 0.09228200791403651, max_hamiltonian_energy_error = 0.17554256482981145, tree_depth = 4, numerical_error = false, step_size = 3.3727083735675245e-5, nom_step_size = 3.3727083735675245e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.9907479911206197, log_density = -1.112279485021257e6, hamiltonian_energy = 1.1131912088257286e6, hamiltonian_energy_error = 0.020679516019299626, max_hamiltonian_energy_error = 0.020679516019299626, tree_depth = 2, numerical_error = false, step_size = 4.8050105954605864e-5, nom_step_size = 4.8050105954605864e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.9328943237221415, log_density = -1.1116345894485353e6, hamiltonian_energy = 1.1123239972846233e6, hamiltonian_energy_error = 0.035926398588344455, max_hamiltonian_energy_error = 0.14045450929552317, tree_depth = 2, numerical_error = false, step_size = 8.533915851356744e-5, nom_step_size = 8.533915851356744e-5, is_adapt = true)  …  (n_steps = 31, is_accept = true, acceptance_rate = 0.9996364647714269, log_density = -28484.168091673546, hamiltonian_energy = 29578.43775129317, hamiltonian_energy_error = -0.16717547029111302, max_hamiltonian_energy_error = -0.16717547029111302, tree_depth = 5, numerical_error = false, step_size = 9.201541678560876e-5, nom_step_size = 9.201541678560876e-5, is_adapt = false), (n_steps = 511, is_accept = true, acceptance_rate = 0.9855647622701275, log_density = -7905.391612773704, hamiltonian_energy = 28531.21344545498, hamiltonian_energy_error = -6.018775479089527, max_hamiltonian_energy_error = -6.018775479089527, tree_depth = 9, numerical_error = false, step_size = 9.201541678560876e-5, nom_step_size = 9.201541678560876e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 1.0, log_density = -6141.547380755939, hamiltonian_energy = 7942.48624289058, hamiltonian_energy_error = -2.673177401285102, max_hamiltonian_energy_error = -2.8510967928705213, tree_depth = 5, numerical_error = false, step_size = 9.201541678560876e-5, nom_step_size = 9.201541678560876e-5, is_adapt = false), (n_steps = 63, is_accept = true, acceptance_rate = 0.9998561794718633, log_density = -5547.934179788219, hamiltonian_energy = 6198.347385406428, hamiltonian_energy_error = -0.3001254346308997, max_hamiltonian_energy_error = -0.761261685923273, tree_depth = 6, numerical_error = false, step_size = 9.201541678560876e-5, nom_step_size = 9.201541678560876e-5, is_adapt = false), (n_steps = 63, is_accept = true, acceptance_rate = 1.0, log_density = -5415.182581410516, hamiltonian_energy = 5593.850412123043, hamiltonian_energy_error = -0.32654281812028785, max_hamiltonian_energy_error = -0.5270577316377967, tree_depth = 6, numerical_error = false, step_size = 9.201541678560876e-5, nom_step_size = 9.201541678560876e-5, is_adapt = false), (n_steps = 127, is_accept = true, acceptance_rate = 0.9952484373666903, log_density = -4736.352707452181, hamiltonian_energy = 5471.560703782132, hamiltonian_energy_error = -0.04184215810892056, max_hamiltonian_energy_error = -0.21049974222205492, tree_depth = 7, numerical_error = false, step_size = 9.201541678560876e-5, nom_step_size = 9.201541678560876e-5, is_adapt = false), (n_steps = 255, is_accept = true, acceptance_rate = 0.9880324171840489, log_density = -4498.941708359975, hamiltonian_energy = 4795.589518592891, hamiltonian_energy_error = -0.023730762456580123, max_hamiltonian_energy_error = -0.19133810784296656, tree_depth = 8, numerical_error = false, step_size = 9.201541678560876e-5, nom_step_size = 9.201541678560876e-5, is_adapt = false), (n_steps = 511, is_accept = true, acceptance_rate = 0.9992959818614704, log_density = -4222.718814386003, hamiltonian_energy = 4547.713941351014, hamiltonian_energy_error = -0.046472660626022844, max_hamiltonian_energy_error = -0.17637647381525312, tree_depth = 9, numerical_error = false, step_size = 9.201541678560876e-5, nom_step_size = 9.201541678560876e-5, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9959860170278616, log_density = -3982.3295682225116, hamiltonian_energy = 4279.378330687882, hamiltonian_energy_error = -0.0035762170036832686, max_hamiltonian_energy_error = -0.13706187218940613, tree_depth = 10, numerical_error = false, step_size = 9.201541678560876e-5, nom_step_size = 9.201541678560876e-5, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9955128156725486, log_density = -3934.508672075804, hamiltonian_energy = 4033.7932830497093, hamiltonian_energy_error = -0.04230045522808723, max_hamiltonian_energy_error = -0.13924095263064373, tree_depth = 10, numerical_error = false, step_size = 9.201541678560876e-5, nom_step_size = 9.201541678560876e-5, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-3.99 ± 0.043, -3.99 ± 0.043, -3.99 ± 0.043, -3.99 ± 0.043, -3.99 ± 0.043, -3.99 ± 0.043, -3.99 ± 0.043, -3.99 ± 0.043, -3.99 ± 0.043, -3.99 ± 0.043  …  -4.06 ± 0.06, -4.06 ± 0.06, -4.06 ± 0.06, -4.06 ± 0.06, -4.06 ± 0.06, -4.06 ± 0.06, -4.06 ± 0.06, -4.06 ± 0.06, -4.06 ± 0.06, -4.06 ± 0.06]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2), NamedTuple())), bias = ViewAxis(17:24, ShapedAxis((8, 1), NamedTuple())))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8), NamedTuple())), bias = ViewAxis(65:72, ShapedAxis((8, 1), NamedTuple())))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8), NamedTuple())), bias = ViewAxis(9:9, ShapedAxis((1, 1), NamedTuple())))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.504 ± 0.044 1.23 ± 0.12; -0.694 ± 0.05 0.274 ± 0.26; … ; 0.683 ± 0.011 -1.53 ± 0.091; -0.451 ± 0.018 -0.0637 ± 0.17], bias = MonteCarloMeasurements.Particles{Float64, 34}[-1.12 ± 0.073; 0.0888 ± 0.089; … ; -0.316 ± 0.21; 0.451 ± 0.031;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.0218 ± 0.15 -0.0968 ± 0.049 … 1.02 ± 0.16 0.197 ± 0.14; 0.256 ± 0.25 0.513 ± 0.063 … -0.00357 ± 0.15 0.178 ± 0.14; … ; 0.81 ± 0.12 0.641 ± 0.12 … 0.505 ± 0.062 -0.573 ± 0.07; 0.792 ± 0.063 0.183 ± 0.043 … 0.861 ± 0.13 -0.549 ± 0.076], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.368 ± 0.094; -0.5 ± 0.24; … ; -0.11 ± 0.066; 0.655 ± 0.031;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-2.33 ± 0.57 -1.57 ± 0.4 … -1.53 ± 0.45 -3.0 ± 0.52], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.461 ± 0.39;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.562 ± 0.16], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="daa5ee7b.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Sunday 18 February 2024 18:47">Sunday 18 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
