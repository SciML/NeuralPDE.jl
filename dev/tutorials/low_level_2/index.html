<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -4.056582636341167
 -3.630591911077823
 -3.83158507681625
 -4.338427786028059
 -3.8660219848364705
 -3.967534981904333
 -4.110288678340627
 -4.132445175983654
 -3.631035672170928
 -3.954446416898393
  ⋮
 -3.9502045438298086
 -4.081340150841116
 -4.236720160471348
 -4.305737479587737
 -4.1173910799046665
 -4.3925409210091155
 -4.178681702502082
 -3.909382781872679
 -4.090302434144744</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="1fbcaf4a.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[-0.39001332463808336, 0.3273647718456617, -0.42166117194117986, -0.11625326678373908, 0.007823707217567033, 0.5208687212121033, -0.46234234287563303, 0.33334290057616534, 0.7626286946560359, 0.6390388901009457  …  0.3837455260267976, 0.7322906880982805, 0.4143886800318416, -0.16714088696166732, 0.3153066688827512, -0.08367134820896589, -0.7134863172709434, -0.07052491540489197, -0.1734856296752519, 0.49944839431147775], [-0.39001332463808336, 0.3273647718456617, -0.42166117194117986, -0.11625326678373908, 0.007823707217567033, 0.5208687212121033, -0.46234234287563303, 0.33334290057616534, 0.7626286946560359, 0.6390388901009457  …  0.3837455260267976, 0.7322906880982805, 0.4143886800318416, -0.16714088696166732, 0.3153066688827512, -0.08367134820896589, -0.7134863172709434, -0.07052491540489197, -0.1734856296752519, 0.49944839431147775], [-0.39001332463808336, 0.3273647718456617, -0.42166117194117986, -0.11625326678373908, 0.007823707217567033, 0.5208687212121033, -0.46234234287563303, 0.33334290057616534, 0.7626286946560359, 0.6390388901009457  …  0.3837455260267976, 0.7322906880982805, 0.4143886800318416, -0.16714088696166732, 0.3153066688827512, -0.08367134820896589, -0.7134863172709434, -0.07052491540489197, -0.1734856296752519, 0.49944839431147775], [-0.3892418609783736, 0.32728742867613086, -0.42221032455578683, -0.11513058346982921, 0.0131585862263149, 0.5213328304495576, -0.4629542717496364, 0.333149816822852, 0.764945574566022, 0.6389636284712022  …  0.3853591063421366, 0.7343397591639561, 0.4130467083581055, -0.16477357498244843, 0.3150409976460188, -0.0823963517960154, -0.7146869085972452, -0.07094052860456404, -0.17860655515320098, 0.4995199274229969], [-0.3884789855130068, 0.32611536380161504, -0.42257269018318633, -0.11501473450286705, 0.020589807767471442, 0.5219797265108099, -0.4638851537705913, 0.332020164350639, 0.7681708004662362, 0.6384369028748441  …  0.38906451953270377, 0.7378148162598755, 0.4095476888361634, -0.1611299614796887, 0.3156755959642246, -0.08017329719521299, -0.7162921189428719, -0.07157948943672197, -0.1874407921884119, 0.5005842003991492], [-0.3847873511032892, 0.3207080740314354, -0.4232799056470007, -0.11096710684066498, 0.04642630101046635, 0.5243126056277365, -0.464371844779646, 0.32632715849575544, 0.784807385106787, 0.6372091999051703  …  0.40508991435778674, 0.7580703140700882, 0.39509074930939525, -0.1423781538098979, 0.3171834637762803, -0.0691654362787927, -0.7245450169156206, -0.07526371781748284, -0.22902938517138027, 0.49968408623448113], [-0.3847873511032892, 0.3207080740314354, -0.4232799056470007, -0.11096710684066498, 0.04642630101046635, 0.5243126056277365, -0.464371844779646, 0.32632715849575544, 0.784807385106787, 0.6372091999051703  …  0.40508991435778674, 0.7580703140700882, 0.39509074930939525, -0.1423781538098979, 0.3171834637762803, -0.0691654362787927, -0.7245450169156206, -0.07526371781748284, -0.22902938517138027, 0.49968408623448113], [-0.38498088843748274, 0.32072555747687853, -0.42316162132485424, -0.11086308138389316, 0.046754235877714094, 0.5243206708932849, -0.46426404210911026, 0.32613143377023, 0.7851048928475406, 0.6372980966161723  …  0.4054139800196357, 0.7589625878867596, 0.394459832985042, -0.14209757575614096, 0.317416459444778, -0.06881568112369481, -0.7244877404466363, -0.07552051225327845, -0.23058459061547407, 0.4995839703764131], [-0.3849124209878333, 0.3207319498810858, -0.423193777714905, -0.1108256405257732, 0.04685416721934947, 0.5243757664843983, -0.46428151672420165, 0.3261837846963513, 0.7853092485182072, 0.6373329225640716  …  0.4053050417468942, 0.7590869537966004, 0.394377458257579, -0.14201985267294298, 0.317370737132394, -0.06882081899084004, -0.7245134496991322, -0.07557092886037296, -0.23085637878194942, 0.4995596896091891], [-0.3849435106416002, 0.32014262987604875, -0.4232496065218509, -0.10969615109951622, 0.0488635777589046, 0.5252295565627292, -0.4644989235853152, 0.3255128919283853, 0.7906977006969417, 0.6363438382292791  …  0.4084769970360052, 0.7671353223343258, 0.3906221157059587, -0.13743418456997264, 0.3186067915063494, -0.06522311570978186, -0.7267194578629538, -0.07710913277721368, -0.2421354396878312, 0.49966840258530193]  …  [-0.7470824689047295, 0.3262591420040921, -0.5237899582384311, -0.17749391743815499, -0.0053294388748278765, 0.505514666780194, -0.46724871154734904, 0.33703595559549826, 1.2171530404514919, 0.6456284104938241  …  0.8224381411379724, 1.964150853984742, 0.12893427867966553, 0.3750610163236238, 0.7449488501561096, 0.39364986537960917, -1.3653064157237331, -0.48881230985889107, -0.8760110378770902, 0.5040819957250875], [-0.7618508095023786, 0.3349767963428771, -0.5535412811863601, -0.18802493226480127, -0.004206757513319014, 0.5053975223477218, -0.466138764014468, 0.35029645829621026, 1.2295028878666903, 0.6395480553366394  …  0.858238184788587, 2.0413935022509824, 0.10771696523205272, 0.40602551430906675, 0.7876079741822756, 0.424233360627332, -1.4301746218077704, -0.5253876995974198, -0.8679024510612975, 0.5047034920572576], [-0.7645875928341493, 0.33648099631166484, -0.559722962554591, -0.19031499059580007, -0.004834004183945765, 0.5053729453762033, -0.4666785816700767, 0.3531505505266493, 1.2316379212012392, 0.638304603660245  …  0.8657544434045034, 2.0585180319916048, 0.10224484715211121, 0.4134884941852379, 0.7978655658641701, 0.43175866651972544, -1.444812510715814, -0.5343345045225667, -0.8654081071609949, 0.504427780325545], [-0.7649870638200533, 0.33703362043130536, -0.5608399401063854, -0.19104525228280697, -0.004837225206388425, 0.5048961424921633, -0.46680593216852323, 0.3541723607623773, 1.232107243368258, 0.6380889501303968  …  0.8681159893452253, 2.062649102981334, 0.10114868255932144, 0.4156495062648055, 0.8003631201099719, 0.4332721356692269, -1.4485831295145664, -0.5366014874071438, -0.8647856215787798, 0.5046192115033068], [-0.7651527446315527, 0.3371593084605081, -0.5612487832828041, -0.19112287233993858, -0.0047927106656626165, 0.5048905253207938, -0.46689417100184055, 0.3543557566414454, 1.2322260326843826, 0.6378181365249346  …  0.868656483679283, 2.0637261743327557, 0.10080771120623894, 0.41641327836093495, 0.8009413442503011, 0.4336807429129618, -1.4495149157107725, -0.5373051228132996, -0.8647904204848744, 0.5045691183466302], [-0.7652577898227384, 0.33712958984706665, -0.5615529469090784, -0.19117949441700466, -0.004642836860275927, 0.5047409974906197, -0.46696403971225925, 0.3545869100521897, 1.232290030301334, 0.637672495228367  …  0.8691851641924474, 2.0648029562239776, 0.1006142596541773, 0.41699848607581397, 0.8013773989455522, 0.4343487988269985, -1.450522755126187, -0.5377768765948487, -0.8646475359127695, 0.5044362997617073], [-0.767210286668676, 0.3387446450549825, -0.566813332081589, -0.1940433781151187, -0.004442079416557807, 0.5051243054134501, -0.4669773559322584, 0.3565956235433499, 1.2341285233947143, 0.6355770045539944  …  0.876949968451387, 2.0806061177814166, 0.09418498054078077, 0.42343486781544387, 0.8117113464319055, 0.4410492601653291, -1.465888372502698, -0.5474628818281848, -0.8616026696505724, 0.5040643752160334], [-0.7751258699178046, 0.36362936626596, -0.6418223936119544, -0.22222377194563786, -0.00220344749417, 0.5042710749004408, -0.4719277561466099, 0.38800127821464275, 1.2657913371096965, 0.6071811124660071  …  0.9951715747189858, 2.329741402252456, 0.011399139414129166, 0.5442139181106032, 0.9660018878548416, 0.55119244441404, -1.6867045870730581, -0.6841136203138679, -0.8159949588150839, 0.5079772908371685], [-0.7695790408706181, 0.36460091520005916, -0.6425308152236265, -0.22331035576267952, -0.0009161529814870022, 0.5028065766356368, -0.4729956742699111, 0.39056611051967144, 1.2645072411303293, 0.6051566915063741  …  1.0010150848074504, 2.3389879803206, 0.006552421707385447, 0.5512020258322182, 0.9733260936704089, 0.5572972553652652, -1.695339822427178, -0.6913489489399627, -0.8125783689847523, 0.5083074949302185], [-0.7687344503847834, 0.36503240279462446, -0.6429692634359909, -0.22381669689952, -0.0010127598599778925, 0.50212767929424, -0.4735171708001889, 0.3913796218326441, 1.26385685722169, 0.6046820446582207  …  1.0022330628874379, 2.341289391824185, 0.00569484363915389, 0.5529126337606792, 0.9746316884362924, 0.5586700862474452, -1.6973391168216496, -0.6926921795409423, -0.8121105442700419, 0.5085186598236935]], NamedTuple[(n_steps = 3, is_accept = true, acceptance_rate = 0.6666666666666666, log_density = -1.6547480545766791e6, hamiltonian_energy = 1.7223817175740958e6, hamiltonian_energy_error = -30969.761931841495, max_hamiltonian_energy_error = 42834.04077189672, tree_depth = 1, numerical_error = true, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6547480545766791e6, hamiltonian_energy = 1.6547984890655961e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 7.336391437042862e26, tree_depth = 0, numerical_error = true, step_size = 0.012261299907089943, nom_step_size = 0.012261299907089943, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6547480545766791e6, hamiltonian_energy = 1.6548048335598414e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 8304.138768760953, tree_depth = 0, numerical_error = true, step_size = 0.001731493674964374, nom_step_size = 0.001731493674964374, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.6513388357045907e6, hamiltonian_energy = 1.6547923115838794e6, hamiltonian_energy_error = -11.152594721410424, max_hamiltonian_energy_error = -11.152594721410424, tree_depth = 2, numerical_error = false, step_size = 0.00015413445733897217, nom_step_size = 0.00015413445733897217, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.6460741082151106e6, hamiltonian_energy = 1.6513791120967986e6, hamiltonian_energy_error = -24.011638725642115, max_hamiltonian_energy_error = -24.011638725642115, tree_depth = 2, numerical_error = false, step_size = 0.0001955224279177154, nom_step_size = 0.0001955224279177154, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.6228761530078077e6, hamiltonian_energy = 1.6460146586640459e6, hamiltonian_energy_error = -119.35724861407652, max_hamiltonian_energy_error = -119.35724861407652, tree_depth = 2, numerical_error = false, step_size = 0.00029335853051706134, nom_step_size = 0.00029335853051706134, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.953155607128451e-6, log_density = -1.6228761530078077e6, hamiltonian_energy = 1.6229323697735919e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 117.02785719325766, tree_depth = 2, numerical_error = false, step_size = 0.0004861498966474869, nom_step_size = 0.0004861498966474869, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9925307691801847, log_density = -1.6221782086617134e6, hamiltonian_energy = 1.62293256875449e6, hamiltonian_energy_error = 0.009066818282008171, max_hamiltonian_energy_error = 0.020858264761045575, tree_depth = 3, numerical_error = false, step_size = 3.804791392899782e-5, nom_step_size = 3.804791392899782e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.9939340360940436, log_density = -1.6220515995648776e6, hamiltonian_energy = 1.6222244206408223e6, hamiltonian_energy_error = -0.0032546084839850664, max_hamiltonian_energy_error = 0.013862827094271779, tree_depth = 2, numerical_error = false, step_size = 6.574732302658087e-5, nom_step_size = 6.574732302658087e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.38580270795274174, log_density = -1.6158973111190377e6, hamiltonian_energy = 1.622103236788135e6, hamiltonian_energy_error = 0.8958657903131098, max_hamiltonian_energy_error = 5.988467267714441, tree_depth = 4, numerical_error = false, step_size = 0.00011812999363981517, nom_step_size = 0.00011812999363981517, is_adapt = true)  …  (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -594334.8778805506, hamiltonian_energy = 597792.7650355843, hamiltonian_energy_error = -2.4637574038933963, max_hamiltonian_energy_error = -2.4637574038933963, tree_depth = 2, numerical_error = false, step_size = 0.0001294658707625735, nom_step_size = 0.0001294658707625735, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 1.0, log_density = -543448.4208869947, hamiltonian_energy = 594354.6559597866, hamiltonian_energy_error = -39.85680745157879, max_hamiltonian_energy_error = -39.85680745157879, tree_depth = 4, numerical_error = false, step_size = 0.0001294658707625735, nom_step_size = 0.0001294658707625735, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -532612.3326770588, hamiltonian_energy = 543501.9808378228, hamiltonian_energy_error = -7.915651296149008, max_hamiltonian_energy_error = -7.915651296149008, tree_depth = 3, numerical_error = false, step_size = 0.0001294658707625735, nom_step_size = 0.0001294658707625735, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -529972.9996950398, hamiltonian_energy = 532659.5378888862, hamiltonian_energy_error = -1.9721093307016417, max_hamiltonian_energy_error = -1.9721093307016417, tree_depth = 2, numerical_error = false, step_size = 0.0001294658707625735, nom_step_size = 0.0001294658707625735, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -529260.2332088739, hamiltonian_energy = 530028.780259824, hamiltonian_energy_error = -0.5863393070176244, max_hamiltonian_energy_error = -2.0718529050936922, tree_depth = 2, numerical_error = false, step_size = 0.0001294658707625735, nom_step_size = 0.0001294658707625735, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -528618.5553869342, hamiltonian_energy = 529298.1682350334, hamiltonian_energy_error = -0.44383625593036413, max_hamiltonian_energy_error = -1.8436236989218742, tree_depth = 2, numerical_error = false, step_size = 0.0001294658707625735, nom_step_size = 0.0001294658707625735, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -518402.04214179557, hamiltonian_energy = 528679.4859241328, hamiltonian_energy_error = -7.419910065946169, max_hamiltonian_energy_error = -7.419910065946169, tree_depth = 3, numerical_error = false, step_size = 0.0001294658707625735, nom_step_size = 0.0001294658707625735, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 1.0, log_density = -396679.20333435724, hamiltonian_energy = 518352.427558185, hamiltonian_energy_error = -103.92158694623504, max_hamiltonian_energy_error = -103.92158694623504, tree_depth = 5, numerical_error = false, step_size = 0.0001294658707625735, nom_step_size = 0.0001294658707625735, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -392130.21657136723, hamiltonian_energy = 396740.81835099426, hamiltonian_energy_error = -3.176522455352824, max_hamiltonian_energy_error = -3.176522455352824, tree_depth = 3, numerical_error = false, step_size = 0.0001294658707625735, nom_step_size = 0.0001294658707625735, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -391068.2458325117, hamiltonian_energy = 392175.8726721574, hamiltonian_energy_error = -0.36202328809304163, max_hamiltonian_energy_error = -0.36202328809304163, tree_depth = 2, numerical_error = false, step_size = 0.0001294658707625735, nom_step_size = 0.0001294658707625735, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-1.9 ± 1.2, -1.9 ± 1.2, -1.9 ± 1.2, -1.9 ± 1.2, -1.9 ± 1.2, -1.9 ± 1.2, -1.9 ± 1.2, -1.9 ± 1.2, -1.9 ± 1.2, -1.9 ± 1.2  …  -2.05 ± 1.3, -2.05 ± 1.3, -2.05 ± 1.3, -2.05 ± 1.3, -2.05 ± 1.3, -2.05 ± 1.3, -2.05 ± 1.3, -2.05 ± 1.3, -2.05 ± 1.3, -2.05 ± 1.3]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.605 ± 0.18 1.06 ± 0.2; 0.325 ± 0.015 0.638 ± 0.012; … ; -0.466 ± 0.0029 0.524 ± 0.013; 0.332 ± 0.023 -0.416 ± 0.016], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.675 ± 0.43; 0.0285 ± 0.044; … ; -0.00512 ± 0.033; -0.0272 ± 0.064;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.301 ± 0.097 0.361 ± 0.074 … 0.22 ± 0.0068 -0.189 ± 0.0081; 0.981 ± 0.26 0.292 ± 0.16 … -0.0276 ± 0.022 -0.491 ± 0.017; … ; -0.824 ± 0.38 -0.0676 ± 0.081 … -0.0807 ± 0.13 -0.218 ± 0.1; -0.345 ± 0.078 0.301 ± 0.0093 … 0.188 ± 0.027 0.5 ± 0.023], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.214 ± 0.13; -0.453 ± 0.24; … ; 0.19 ± 0.16; 0.0798 ± 0.053;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.681 ± 0.21 1.54 ± 0.6 … -1.14 ± 0.35 -0.347 ± 0.22], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.648 ± 0.26;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.503 ± 0.0021], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="39520213.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Sunday 3 March 2024 18:09">Sunday 3 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
