<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -4.072693087474228
 -4.118638252879759
 -4.17746197395792
 -3.816232274979319
 -4.369449995135499
 -3.7753660030891547
 -3.755408835225499
 -3.8304667463898463
 -4.069259155105458
 -3.6399289547195663
  ⋮
 -3.750190214296441
 -3.9400754341177566
 -3.855642499766104
 -4.201818673698293
 -4.214935180188029
 -3.898188532019193
 -3.7997966563762207
 -3.967842259885276
 -3.841801101111234</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="2a414c8c.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2), NamedTuple())), bias = ViewAxis(17:24, ShapedAxis((8, 1), NamedTuple())))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8), NamedTuple())), bias = ViewAxis(65:72, ShapedAxis((8, 1), NamedTuple())))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8), NamedTuple())), bias = ViewAxis(9:9, ShapedAxis((1, 1), NamedTuple())))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[-0.2600193195574802, -0.2647916304549641, 0.07969441153333384, -0.1868223516718331, 0.16664461470450004, -0.6601340058313021, 0.7714729108106774, 0.12694696820781154, -0.1470063439531592, 0.6564000396799503  …  -0.33781946806495244, 0.1883590379164573, -0.45276722254555235, -0.020252950070597044, 0.32230352731733125, -0.3331684320869743, -0.4992491971047752, -0.27222997079196637, -0.16417948187687642, 0.4991167416890381], [-0.2600193195574802, -0.2647916304549641, 0.07969441153333384, -0.1868223516718331, 0.16664461470450004, -0.6601340058313021, 0.7714729108106774, 0.12694696820781154, -0.1470063439531592, 0.6564000396799503  …  -0.33781946806495244, 0.1883590379164573, -0.45276722254555235, -0.020252950070597044, 0.32230352731733125, -0.3331684320869743, -0.4992491971047752, -0.27222997079196637, -0.16417948187687642, 0.4991167416890381], [-0.2589936574243013, -0.25295399636066596, 0.08874748207200826, -0.19556022168195836, 0.143968725681483, -0.6512380229543001, 0.7716205212978509, 0.028775527542590995, -0.12409203276789231, 0.6661019855002281  …  -0.2785462718044184, 0.1661003586391635, -0.40658077222318706, -0.021828087950153337, 0.333963841268488, -0.3835079346397287, -0.5215830148140498, -0.3227656601794692, -0.3419804653607941, 0.5024630378365981], [-0.2589936574243013, -0.25295399636066596, 0.08874748207200826, -0.19556022168195836, 0.143968725681483, -0.6512380229543001, 0.7716205212978509, 0.028775527542590995, -0.12409203276789231, 0.6661019855002281  …  -0.2785462718044184, 0.1661003586391635, -0.40658077222318706, -0.021828087950153337, 0.333963841268488, -0.3835079346397287, -0.5215830148140498, -0.3227656601794692, -0.3419804653607941, 0.5024630378365981], [-0.2588901062549394, -0.2528361315731836, 0.08860080114539212, -0.19562747125901594, 0.14365540532987717, -0.6507444778092099, 0.7719913057292216, 0.028521370529628706, -0.12370234591558155, 0.6664667924081153  …  -0.27861196070827704, 0.16583272638365462, -0.4063338879870211, -0.02191651273359144, 0.3342092978056301, -0.38409558791926424, -0.5222783649944427, -0.3228669480660637, -0.3437273973409638, 0.5019614185757781], [-0.25901384577192665, -0.252942846952753, 0.08853154255632147, -0.1956346002011558, 0.14393380104819198, -0.6508758329687394, 0.7721247821626807, 0.02832557325540587, -0.12336904358260266, 0.6665634746495981  …  -0.2785874457665539, 0.16593275464594417, -0.4061505679691601, -0.021744181508447088, 0.33445268181017335, -0.3843342503621085, -0.5228375523449678, -0.3227528988415811, -0.3447147797831712, 0.5018097396056462], [-0.25887963215807436, -0.2531298320652249, 0.08842135168085688, -0.19556869646113964, 0.14353026930092916, -0.6508613682154046, 0.7718916375901586, 0.02780890572173237, -0.12221238831407612, 0.6675666887248125  …  -0.2778970705176454, 0.1654598495152802, -0.40548812169337156, -0.021659862176511602, 0.3349421633206942, -0.3856147635627134, -0.525014701644054, -0.32341992212186665, -0.34950474079813426, 0.5021220208703016], [-0.2588716216126992, -0.252892776014273, 0.08831058705495956, -0.19562322504992619, 0.1432724972849389, -0.6506768193133681, 0.7720126755663397, 0.02757876573873759, -0.12163629848939228, 0.6678757418143011  …  -0.2779377862585081, 0.1650662744958711, -0.4054245821242648, -0.021305493906138076, 0.3351224376444321, -0.3857266369486816, -0.5255693051777505, -0.32385103877691157, -0.35072704267147603, 0.502119954593512], [-0.2586099510332005, -0.2526759359067672, 0.0874459786628557, -0.1964517793782393, 0.1428266624211244, -0.6499408797832694, 0.7719531812635508, 0.02662698089684844, -0.1207688783066824, 0.6686553315579818  …  -0.27751750002571396, 0.16467986367051307, -0.4053337956991078, -0.021517833030090774, 0.3354806338279916, -0.3864890359373646, -0.52727893855694, -0.3245512878940798, -0.35582417084483203, 0.5019324849169456], [-0.25845657816806483, -0.25279573396655697, 0.08673516978783359, -0.19692366978351775, 0.14198390990381976, -0.6492890957213828, 0.7716520776801127, 0.025750212972261658, -0.11947108805716108, 0.6695355933953022  …  -0.27779203960912285, 0.16433208845129907, -0.40502424118564767, -0.02096347201427477, 0.3368479813785916, -0.38747732529252643, -0.5297221448230219, -0.3266932913720394, -0.3612787197891334, 0.5016582543595768]  …  [-0.26460864520001665, -0.2922426668248357, 0.07255858428123593, -0.21203257073673912, 0.09716294454562285, -0.6256915918277133, 0.7669144414654613, 0.021123151646680587, -0.07061520406513754, 0.7268159285375071  …  -0.2617708101600148, 0.15013757254266266, -0.4088349327832481, -0.005081547517231701, 0.38967580892658527, -0.4799539482951726, -0.6458704416939894, -0.40009788742465874, -0.5544707974935894, 0.5015251221890141], [-0.26463262823372297, -0.29245907470784394, 0.07262199140318405, -0.21201553944624263, 0.09687939141962375, -0.625743379085289, 0.7668867916832446, 0.021204613190072434, -0.07051269188862638, 0.7269506619496948  …  -0.26155790905081355, 0.15005766990476485, -0.4089529035622497, -0.005087964851572269, 0.3897669992706657, -0.48024504611456675, -0.646163020678675, -0.39999083606662056, -0.55469101118669, 0.5015372688332814], [-0.26520086891534494, -0.29331342842284386, 0.0726950914301984, -0.2122647888629068, 0.096145310264165, -0.6256619031354571, 0.7669631128735853, 0.021442500618843875, -0.07024144990181483, 0.7278253326037363  …  -0.2613075604026314, 0.15008533396169976, -0.4092052903455729, -0.00478978788901247, 0.39047962837227007, -0.48167289513495265, -0.6475005250660207, -0.40084664000836384, -0.5561977678901807, 0.5015625088156026], [-0.2651035086283402, -0.29372338307185947, 0.07251465594188934, -0.21243359061054712, 0.09543503016080297, -0.6248805203314761, 0.7668028041828517, 0.021388798179800387, -0.06997919880786203, 0.7287439027243047  …  -0.2610955652136849, 0.14974444720545035, -0.4091477998923207, -0.00441996949629236, 0.39097520692719495, -0.48234492250282873, -0.6492475104021811, -0.4015165711962099, -0.5580744120462701, 0.5014493799853084], [-0.2654328205889983, -0.29460842781431157, 0.07214076242697505, -0.2126677161846411, 0.09479947219421878, -0.6246912361324407, 0.7667074733219599, 0.02144782700227506, -0.06955074764672764, 0.7295028081614049  …  -0.26100859745104693, 0.14963495891704823, -0.409230721551944, -0.004301938892019933, 0.39168239440649083, -0.48392081502586487, -0.6509963207991908, -0.4024345357795955, -0.559523332034546, 0.5012055979981603], [-0.2657228473229216, -0.2952391788404828, 0.07174372389322789, -0.21282209023794668, 0.09451046253681691, -0.6243997410321358, 0.7669547099345303, 0.02131343324410887, -0.06905134663080524, 0.7302462586699131  …  -0.2610589175869165, 0.14956905372723314, -0.4091912333509635, -0.004361634496377607, 0.39236496007676186, -0.48524711974462115, -0.6526053666825771, -0.40343742376184927, -0.5615706005796464, 0.5012144254228328], [-0.26693639154693394, -0.2973504048020892, 0.07122433081428242, -0.21304866771384548, 0.09256737484053384, -0.6231789098704962, 0.7667074414882594, 0.022308303168720883, -0.06689735146084919, 0.7323869281739063  …  -0.26020474012742173, 0.14815753633177436, -0.40932125419540843, -0.003700474957149765, 0.3948114277259782, -0.48962035027916345, -0.6582451937136024, -0.4071329708530131, -0.5680578922938331, 0.5009487637467848], [-0.26675882686666547, -0.29791484415605163, 0.0710641455338244, -0.21316024267505598, 0.0920045061987032, -0.6228999743046015, 0.766508032494341, 0.02250928563304805, -0.06642947115909198, 0.7334296203968836  …  -0.26030151133485196, 0.14825041207959133, -0.40913003030376444, -0.003595935594106736, 0.39525566077528235, -0.4907655240479179, -0.6598278872022773, -0.40791781559411555, -0.5692898435055462, 0.5008691619217396], [-0.2668593899918738, -0.29817387807855167, 0.0709796351074817, -0.21315349676011852, 0.09182072229088944, -0.6227327960140993, 0.7664213720909039, 0.02242198431335802, -0.06624950854220289, 0.7336567700988379  …  -0.2602563624262985, 0.14831234635332505, -0.40919150841539814, -0.003492992682232611, 0.3955100705104395, -0.4909914570713752, -0.6602940870270054, -0.4079018103780191, -0.5697579534393734, 0.5008380574593404], [-0.2670830553362493, -0.29934982932911924, 0.07089449178158838, -0.21314106066960553, 0.0905185741990756, -0.6223169885367849, 0.7664025624538857, 0.022909799707062868, -0.06533298716795025, 0.7352057266504193  …  -0.2598200351168866, 0.14795450353720593, -0.41019124027286485, -0.0029065867373423045, 0.39697424189739916, -0.4937957567568198, -0.6633423456281353, -0.4102804308049283, -0.5730216891970826, 0.5011056453532137]], NamedTuple[(n_steps = 3, is_accept = true, acceptance_rate = 0.6666666666666666, log_density = -1.665818360842348e6, hamiltonian_energy = 1.7978733167583835e6, hamiltonian_energy_error = -75373.20566878468, max_hamiltonian_energy_error = -75373.20566878468, tree_depth = 1, numerical_error = true, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.665818360842348e6, hamiltonian_energy = 1.6658807767707545e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 2.375308147470862e24, tree_depth = 0, numerical_error = true, step_size = 0.012261299907089943, nom_step_size = 0.012261299907089943, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 1.0, log_density = -1.6186549511006672e6, hamiltonian_energy = 1.6611003253311457e6, hamiltonian_energy_error = -4771.588344184216, max_hamiltonian_energy_error = -4771.588344184216, tree_depth = 1, numerical_error = false, step_size = 0.001731493674964374, nom_step_size = 0.001731493674964374, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6186549511006672e6, hamiltonian_energy = 1.618732696341896e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 5591.955992123578, tree_depth = 0, numerical_error = true, step_size = 0.002213917547581264, nom_step_size = 0.002213917547581264, is_adapt = true), (n_steps = 31, is_accept = true, acceptance_rate = 0.15582697098239343, log_density = -1.6181586962438575e6, hamiltonian_energy = 1.618704834272363e6, hamiltonian_energy_error = 0.12542601441964507, max_hamiltonian_energy_error = 128.15760513884015, tree_depth = 5, numerical_error = false, step_size = 0.00019552242791771575, nom_step_size = 0.00019552242791771575, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9991856842915152, log_density = -1.6179029343228731e6, hamiltonian_energy = 1.6182153106628617e6, hamiltonian_energy_error = 0.0004852772690355778, max_hamiltonian_energy_error = 0.002649412490427494, tree_depth = 4, numerical_error = false, step_size = 2.3678271447927842e-5, nom_step_size = 2.3678271447927842e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9885043177103754, log_density = -1.616538185925986e6, hamiltonian_energy = 1.6179537642352085e6, hamiltonian_energy_error = 0.01400294410996139, max_hamiltonian_energy_error = 0.030604567611590028, tree_depth = 4, numerical_error = false, step_size = 3.657197415272596e-5, nom_step_size = 3.657197415272596e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.994713024186798, log_density = -1.6161574019182797e6, hamiltonian_energy = 1.616583040527809e6, hamiltonian_energy_error = 0.00804344192147255, max_hamiltonian_energy_error = 0.014160415856167674, tree_depth = 3, numerical_error = false, step_size = 5.947512060806786e-5, nom_step_size = 5.947512060806786e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.955091391740684, log_density = -1.614868076925024e6, hamiltonian_energy = 1.6162005796384676e6, hamiltonian_energy_error = 0.03696130868047476, max_hamiltonian_energy_error = 0.11502444348298013, tree_depth = 3, numerical_error = false, step_size = 0.00010392830807140955, nom_step_size = 0.00010392830807140955, is_adapt = true), (n_steps = 31, is_accept = true, acceptance_rate = 0.17525614848350854, log_density = -1.6133074533861384e6, hamiltonian_energy = 1.614936683677914e6, hamiltonian_energy_error = 0.24567330651916564, max_hamiltonian_energy_error = 66.01416709297337, tree_depth = 5, numerical_error = false, step_size = 0.000165541403266795, nom_step_size = 0.000165541403266795, is_adapt = true)  …  (n_steps = 15, is_accept = true, acceptance_rate = 0.3128697523634764, log_density = -1.5361950799724765e6, hamiltonian_energy = 1.5364707958488385e6, hamiltonian_energy_error = 0.10438505746424198, max_hamiltonian_energy_error = 6.253277801675722, tree_depth = 4, numerical_error = false, step_size = 0.00010342334686267513, nom_step_size = 0.00010342334686267513, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 0.8364584836420503, log_density = -1.5359988067404456e6, hamiltonian_energy = 1.5362443174718397e6, hamiltonian_energy_error = 0.08658768283203244, max_hamiltonian_energy_error = 0.366420567734167, tree_depth = 2, numerical_error = false, step_size = 0.00010342334686267513, nom_step_size = 0.00010342334686267513, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 0.8267638606005634, log_density = -1.5350236153564507e6, hamiltonian_energy = 1.5360560138234554e6, hamiltonian_energy_error = 0.4086829381994903, max_hamiltonian_energy_error = 0.4086829381994903, tree_depth = 2, numerical_error = false, step_size = 0.00010342334686267513, nom_step_size = 0.00010342334686267513, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.3101806995120121, log_density = -1.5340493932153617e6, hamiltonian_energy = 1.5350829573955669e6, hamiltonian_energy_error = 0.3792178931180388, max_hamiltonian_energy_error = 6.355793713591993, tree_depth = 4, numerical_error = false, step_size = 0.00010342334686267513, nom_step_size = 0.00010342334686267513, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.3086281275473503, log_density = -1.5330530311198407e6, hamiltonian_energy = 1.534100334758716e6, hamiltonian_energy_error = 0.4318594781216234, max_hamiltonian_energy_error = 6.287280851742253, tree_depth = 4, numerical_error = false, step_size = 0.00010342334686267513, nom_step_size = 0.00010342334686267513, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 0.8265834440901817, log_density = -1.532039805948037e6, hamiltonian_energy = 1.5331192665370756e6, hamiltonian_energy_error = 0.40093299211002886, max_hamiltonian_energy_error = 0.40093299211002886, tree_depth = 2, numerical_error = false, step_size = 0.00010342334686267513, nom_step_size = 0.00010342334686267513, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.5942210945830143, log_density = -1.5282521898356164e6, hamiltonian_energy = 1.532091362153208e6, hamiltonian_energy_error = 1.567762539256364, max_hamiltonian_energy_error = 1.567762539256364, tree_depth = 3, numerical_error = false, step_size = 0.00010342334686267513, nom_step_size = 0.00010342334686267513, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 0.8237755961561232, log_density = -1.527352463991417e6, hamiltonian_energy = 1.5282991065832647e6, hamiltonian_energy_error = 0.40127110690809786, max_hamiltonian_energy_error = 0.40127110690809786, tree_depth = 2, numerical_error = false, step_size = 0.00010342334686267513, nom_step_size = 0.00010342334686267513, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 0.8134156114297694, log_density = -1.5271171238469633e6, hamiltonian_energy = 1.527397933377641e6, hamiltonian_energy_error = 0.09280039346776903, max_hamiltonian_energy_error = 0.4463431495241821, tree_depth = 2, numerical_error = false, step_size = 0.00010342334686267513, nom_step_size = 0.00010342334686267513, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.2962427723596355, log_density = -1.5248777823438847e6, hamiltonian_energy = 1.5271645428665613e6, hamiltonian_energy_error = 0.9561232530977577, max_hamiltonian_energy_error = 6.876560986042023, tree_depth = 4, numerical_error = false, step_size = 0.00010342334686267513, nom_step_size = 0.00010342334686267513, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-0.546 ± 0.0084, -0.546 ± 0.0084, -0.546 ± 0.0084, -0.546 ± 0.0084, -0.546 ± 0.0084, -0.546 ± 0.0084, -0.546 ± 0.0084, -0.546 ± 0.0084, -0.546 ± 0.0084, -0.546 ± 0.0084  …  -0.76 ± 0.041, -0.76 ± 0.041, -0.761 ± 0.041, -0.761 ± 0.041, -0.761 ± 0.041, -0.761 ± 0.041, -0.761 ± 0.041, -0.761 ± 0.041, -0.761 ± 0.041, -0.761 ± 0.041]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2), NamedTuple())), bias = ViewAxis(17:24, ShapedAxis((8, 1), NamedTuple())))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8), NamedTuple())), bias = ViewAxis(65:72, ShapedAxis((8, 1), NamedTuple())))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8), NamedTuple())), bias = ViewAxis(9:9, ShapedAxis((1, 1), NamedTuple())))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.265 ± 0.001 -0.074 ± 0.0048; -0.288 ± 0.0063 0.722 ± 0.0072; … ; 0.768 ± 0.00094 -0.158 ± 0.0012; 0.0204 ± 0.0011 -0.603 ± 0.00077], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.166 ± 0.011; 0.0727 ± 0.014; … ; 0.101 ± 0.0017; 0.0757 ± 0.002;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.253 ± 0.0017 0.375 ± 0.0044 … 0.286 ± 0.00076 -0.387 ± 0.0011; 0.657 ± 0.00039 -0.497 ± 0.0018 … 0.134 ± 0.00032 0.372 ± 0.00036; … ; -0.225 ± 0.0044 -0.215 ± 0.011 … -0.0839 ± 0.00095 0.247 ± 0.0013; -0.429 ± 0.0027 -0.275 ± 0.0066 … 0.398 ± 0.00064 0.344 ± 0.0017], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.0273 ± 0.0041; -0.113 ± 0.0023; … ; 0.109 ± 0.0092; -0.103 ± 0.0065;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.262 ± 0.0009 0.151 ± 0.0014 … -0.635 ± 0.015 -0.392 ± 0.0098], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.541 ± 0.018;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.501 ± 0.0004], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="033eafb0.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Sunday 18 February 2024 18:01">Sunday 18 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
