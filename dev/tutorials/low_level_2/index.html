<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -3.883905738049082
 -3.9321449965201247
 -4.050679809833021
 -4.0737203779108455
 -4.108489650787886
 -3.7459273219458082
 -4.167304670123693
 -4.233475757854499
 -3.9492154749736796
 -3.74483639012423
  ⋮
 -4.052028373336952
 -3.8404647513267287
 -4.057652156959137
 -4.175185315034953
 -4.276523348124528
 -4.117295691377126
 -4.036439379202824
 -4.299597205196199
 -3.8674969126652505</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="62e01952.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[-0.48538204115313904, -0.3309692563318156, -0.2776686734454806, -0.4615938722118253, -0.35061783056321966, -0.6662250053703359, 0.7068032588754977, 0.20252049192058513, -0.37340449689978433, -0.02362505194399649  …  -0.7654747604621909, 0.7274488509136143, -0.3474462458008689, 0.46778126351202576, 0.10554415725668777, -0.14346711871722706, -0.1532535256092108, -0.3130467805957906, -0.17310883094423773, 0.5028023413658135], [-0.48538204115313904, -0.3309692563318156, -0.2776686734454806, -0.4615938722118253, -0.35061783056321966, -0.6662250053703359, 0.7068032588754977, 0.20252049192058513, -0.37340449689978433, -0.02362505194399649  …  -0.7654747604621909, 0.7274488509136143, -0.3474462458008689, 0.46778126351202576, 0.10554415725668777, -0.14346711871722706, -0.1532535256092108, -0.3130467805957906, -0.17310883094423773, 0.5028023413658135], [-0.48538204115313904, -0.3309692563318156, -0.2776686734454806, -0.4615938722118253, -0.35061783056321966, -0.6662250053703359, 0.7068032588754977, 0.20252049192058513, -0.37340449689978433, -0.02362505194399649  …  -0.7654747604621909, 0.7274488509136143, -0.3474462458008689, 0.46778126351202576, 0.10554415725668777, -0.14346711871722706, -0.1532535256092108, -0.3130467805957906, -0.17310883094423773, 0.5028023413658135], [-0.47704061117214425, -0.30969273392436264, -0.23741244279674775, -0.42786035686046153, -0.3399078486245493, -0.6686110632205899, 0.7091149572001666, 0.4147243675759284, -0.31625712465342876, 0.006750833784686147  …  -0.7004448491424159, 0.6985634779664605, -0.4372767572565916, 0.5557515629218279, 0.026122818245693083, -0.16403301818031815, -0.23387018320076433, -0.394605936036238, -0.3720987835056964, 0.5032382171186656], [-0.47704061117214425, -0.30969273392436264, -0.23741244279674775, -0.42786035686046153, -0.3399078486245493, -0.6686110632205899, 0.7091149572001666, 0.4147243675759284, -0.31625712465342876, 0.006750833784686147  …  -0.7004448491424159, 0.6985634779664605, -0.4372767572565916, 0.5557515629218279, 0.026122818245693083, -0.16403301818031815, -0.23387018320076433, -0.394605936036238, -0.3720987835056964, 0.5032382171186656], [-0.4770206531170061, -0.30974708972363063, -0.23743134900970414, -0.4276375224407893, -0.33997608408643504, -0.6684548913635747, 0.7090913225228161, 0.4145516123766468, -0.31598356162132263, 0.006649835892778686  …  -0.7009747298293639, 0.6994274979312625, -0.4374224138802588, 0.5563149216574395, 0.02601441428623746, -0.16357113302514162, -0.2341136188390071, -0.39440827945488, -0.37268505877042624, 0.5032591328341909], [-0.47704698433518805, -0.3098041758600061, -0.23733252377881955, -0.427589370341216, -0.3400551931045312, -0.6684051888384456, 0.7089510324577128, 0.4145570913998804, -0.315875999568547, 0.006642983253919505  …  -0.7010705498541395, 0.6995651987032596, -0.43744964806476855, 0.556485372420887, 0.025984382177577436, -0.16337948654579576, -0.23414190051982964, -0.3943756213522643, -0.37297675717711964, 0.503243915660431], [-0.47702664731222844, -0.31026163526110145, -0.23766766165332423, -0.4281358266268405, -0.34015430474238856, -0.6680544993784593, 0.708984581234443, 0.4140720471233447, -0.3151042433032449, 0.006926125807954508  …  -0.7027180245043585, 0.7014723531450169, -0.438192119263142, 0.5581617612859086, 0.02542903827062407, -0.16222807617396198, -0.23426979316191604, -0.3942166729067447, -0.3755413595525076, 0.5029333218229691], [-0.47714942867715643, -0.3105035344176263, -0.23780930923019772, -0.4281455083506392, -0.3399824003739857, -0.6674450424696439, 0.7086112615861658, 0.4136619512951011, -0.3145004429147161, 0.007562174282625665  …  -0.7044214288011199, 0.7038187976924564, -0.43864620078200195, 0.5590849205300105, 0.02504125861486626, -0.16086983631395405, -0.23449359230259864, -0.394114391478872, -0.37800406669631975, 0.5028372310646442], [-0.4774235883156217, -0.3110803772904764, -0.23773659993262972, -0.4286713714932476, -0.3399144485815555, -0.667095011381911, 0.7089377444263977, 0.413340638243812, -0.3137385136022932, 0.008034388295210502  …  -0.7058800962018379, 0.7056819632936959, -0.439513138128644, 0.5606259826520044, 0.024706303285539813, -0.15961603763740656, -0.23495966266737275, -0.3938004902989637, -0.3801521694849576, 0.5030592263807648]  …  [-0.6791900549320927, -0.8757695736469742, -0.3885329305430361, -0.6979575078718068, -0.4803644113638072, -0.43420602970069366, 0.9047732997288708, 0.940893111210716, 0.12915969116312648, 0.45372222655436967  …  -2.5662814023463807, 2.695511868072246, -1.987890032552997, 2.5714241535329467, -1.0989966382569587, 0.932892241976473, -1.4877950781362885, -1.5523664854240107, -0.04910539190577401, 0.4627927095034655], [-0.6786289454709586, -0.8772766322904461, -0.38592039086150687, -0.7005457808993573, -0.47793195957440954, -0.440940199059639, 0.9056498695457886, 0.9331732951816193, 0.13170756169234354, 0.4589516799588912  …  -2.5716947079295602, 2.700843748860707, -1.9930361544826778, 2.578565908288686, -1.1044478090383363, 0.9374296615537715, -1.4936568967098565, -1.5534306045912198, -0.044002683604065715, 0.46132129788827475], [-0.6807448234747061, -0.8796061912610036, -0.38313446097502424, -0.704813362041465, -0.4774520208110713, -0.447558661211913, 0.9107199723604303, 0.921607356137449, 0.1364067852857408, 0.4714518195223812  …  -2.5860244708218043, 2.716168002586472, -2.0106352137548824, 2.593850489098637, -1.1146839171495357, 0.9498657063817135, -1.5044915993284278, -1.5591427296726406, -0.03156512416145573, 0.46400478815048646], [-0.6807855122165662, -0.8795513690364135, -0.3826200253178317, -0.7047530828126093, -0.4775855132789437, -0.4490851122071289, 0.9104092645190387, 0.9217879125008958, 0.1367050886589606, 0.4718118502477186  …  -2.586901912122957, 2.7169941603046777, -2.0109977366639686, 2.5947071900634398, -1.1155820989922018, 0.9506679447845618, -1.505129534798936, -1.559738886191023, -0.030776402499138787, 0.46413112805528384], [-0.6805884588519436, -0.8804983537137614, -0.3827301459453619, -0.7052429396439674, -0.4773583512170228, -0.4492413353955475, 0.9094947322202347, 0.9211675267329366, 0.1381447412960976, 0.47100889434973486  …  -2.5877372925331037, 2.719144889682315, -2.012405234459308, 2.596547111543633, -1.1171928213938997, 0.9508387822516745, -1.5067396189194981, -1.5600112740677512, -0.029270266211170175, 0.46413317838554863], [-0.6829405850046272, -0.8805157160136221, -0.3815532075322284, -0.7059355102717434, -0.4762128761336787, -0.4494232106258496, 0.9106933908294101, 0.9192574801504863, 0.1393934764995163, 0.4750394633726454  …  -2.590844052722948, 2.724025140170487, -2.0173311648117997, 2.599434127897708, -1.1218667274935776, 0.9562043111603932, -1.5117396623947852, -1.5617835952386772, -0.024204441476386628, 0.46461958043074125], [-0.6846695510971229, -0.8809431076146522, -0.3824226887388672, -0.707252724955507, -0.47431046081073186, -0.45041179597585973, 0.9109618275522043, 0.9189373802252514, 0.1407377971969101, 0.47748844156709747  …  -2.5951439490473813, 2.729801079691034, -2.021040220454256, 2.6013847518745203, -1.1240519194054455, 0.9600237435461831, -1.5152763817802328, -1.5651718720215237, -0.018401824977050903, 0.4671317038858653], [-0.6840669040714595, -0.8808166788355949, -0.38276581778660496, -0.7073844454662009, -0.4744707189017822, -0.45040998246163394, 0.9110243919097895, 0.9189370756534907, 0.14102165976875883, 0.47713609077278807  …  -2.595255673323188, 2.729686392010663, -2.02075013177954, 2.6016865837136485, -1.1242660383757568, 0.960086585489518, -1.5155325888735254, -1.5654528995423995, -0.018104517912347667, 0.46691549232614965], [-0.6838676101541098, -0.8829018282947734, -0.3850441900685632, -0.708330092377473, -0.4738286558398809, -0.45129806071238177, 0.9098248364964917, 0.917619122510836, 0.14182024502342463, 0.47842124615724724  …  -2.5962957493470653, 2.732483415686487, -2.023420920175826, 2.6050262601634304, -1.1277782793036373, 0.962132326872482, -1.5172116118419916, -1.5658804518305502, -0.015501715845509136, 0.46640603559742133], [-0.6848035722504462, -0.8827245292862134, -0.384955477806789, -0.7084924871822516, -0.4742366399826109, -0.4514449304274782, 0.9095586648786508, 0.9177070403066977, 0.14204555239360048, 0.47789978168197605  …  -2.5976351655102334, 2.733022863905142, -2.023891084684305, 2.6064224079759692, -1.1278941207609012, 0.9629194787725573, -1.5172450574199008, -1.565834372429563, -0.014762173566801724, 0.46650142257579974]], NamedTuple[(n_steps = 1, is_accept = true, acceptance_rate = 1.0, log_density = -1.6706997104832646e6, hamiltonian_energy = 1.8204784372940303e6, hamiltonian_energy_error = -3443.05432832567, max_hamiltonian_energy_error = -3443.05432832567, tree_depth = 1, numerical_error = false, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6706997104832646e6, hamiltonian_energy = 1.6707535694146848e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 9.611349821530853e42, tree_depth = 0, numerical_error = true, step_size = 0.022477359524651217, nom_step_size = 0.022477359524651217, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6706997104832646e6, hamiltonian_energy = 1.6707566855592688e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 4.208538447350393e7, tree_depth = 0, numerical_error = true, step_size = 0.003798698975534599, nom_step_size = 0.003798698975534599, is_adapt = true), (n_steps = 8, is_accept = true, acceptance_rate = 0.75, log_density = -1.4860103069907804e6, hamiltonian_energy = 1.668850616217262e6, hamiltonian_energy_error = -1891.6176610107068, max_hamiltonian_energy_error = -1891.6176610107068, tree_depth = 3, numerical_error = true, step_size = 0.00037467407115379783, nom_step_size = 0.00037467407115379783, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.030659985096072227, log_density = -1.4860103069907804e6, hamiltonian_energy = 1.4860546952826614e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 81.32931019132957, tree_depth = 4, numerical_error = false, step_size = 0.00024808472769450993, nom_step_size = 0.00024808472769450993, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9985732313469582, log_density = -1.4851119466190746e6, hamiltonian_energy = 1.4860572451525985e6, hamiltonian_energy_error = 0.0036335019394755363, max_hamiltonian_energy_error = 0.0036335019394755363, tree_depth = 3, numerical_error = false, step_size = 2.0901772345396645e-5, nom_step_size = 2.0901772345396645e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9979714095691651, log_density = -1.4848612012948527e6, hamiltonian_energy = 1.4851584721939154e6, hamiltonian_energy_error = -0.0006846028845757246, max_hamiltonian_energy_error = 0.005360345588997006, tree_depth = 3, numerical_error = false, step_size = 3.211483550081279e-5, nom_step_size = 3.211483550081279e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9198261097890962, log_density = -1.4823403560518757e6, hamiltonian_energy = 1.4849163197299438e6, hamiltonian_energy_error = 0.06415677978657186, max_hamiltonian_energy_error = 0.2507524690590799, tree_depth = 4, numerical_error = false, step_size = 5.3672781101353394e-5, nom_step_size = 5.3672781101353394e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9160296351513436, log_density = -1.4796338989118077e6, hamiltonian_energy = 1.4823903389885628e6, hamiltonian_energy_error = 0.0977749649900943, max_hamiltonian_energy_error = 0.19400266814045608, tree_depth = 3, numerical_error = false, step_size = 7.404784279308398e-5, nom_step_size = 7.404784279308398e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.8737416848768856, log_density = -1.4773193039630312e6, hamiltonian_energy = 1.4796859748548712e6, hamiltonian_energy_error = 0.2797056478448212, max_hamiltonian_energy_error = 0.2797056478448212, tree_depth = 2, numerical_error = false, step_size = 0.00010408825784176184, nom_step_size = 0.00010408825784176184, is_adapt = true)  …  (n_steps = 63, is_accept = true, acceptance_rate = 0.9866100669946466, log_density = -37012.60719991175, hamiltonian_energy = 50699.96578952031, hamiltonian_energy_error = -4.914564546852489, max_hamiltonian_energy_error = -4.994516140955966, tree_depth = 6, numerical_error = false, step_size = 0.00011644852803260039, nom_step_size = 0.00011644852803260039, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.999552424685762, log_density = -35678.01336511938, hamiltonian_energy = 37059.300380590816, hamiltonian_energy_error = -0.7526829756316147, max_hamiltonian_energy_error = -0.9359127981442725, tree_depth = 4, numerical_error = false, step_size = 0.00011644852803260039, nom_step_size = 0.00011644852803260039, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 1.0, log_density = -32905.60983588847, hamiltonian_energy = 35728.990194813814, hamiltonian_energy_error = -0.6517939076002222, max_hamiltonian_energy_error = -1.180228055542102, tree_depth = 5, numerical_error = false, step_size = 0.00011644852803260039, nom_step_size = 0.00011644852803260039, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9786427045609095, log_density = -32758.970536511963, hamiltonian_energy = 32957.9426412926, hamiltonian_energy_error = -0.0350796696220641, max_hamiltonian_energy_error = -0.09382634499343112, tree_depth = 4, numerical_error = false, step_size = 0.00011644852803260039, nom_step_size = 0.00011644852803260039, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9595500692181982, log_density = -32566.522498208265, hamiltonian_energy = 32828.04073417609, hamiltonian_energy_error = 0.05495582617004402, max_hamiltonian_energy_error = 0.12476017585868249, tree_depth = 4, numerical_error = false, step_size = 0.00011644852803260039, nom_step_size = 0.00011644852803260039, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.6488656745454394, log_density = -31707.870538686067, hamiltonian_energy = 32616.263708395076, hamiltonian_energy_error = 0.05072528407617938, max_hamiltonian_energy_error = 0.8917561154194118, tree_depth = 4, numerical_error = false, step_size = 0.00011644852803260039, nom_step_size = 0.00011644852803260039, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9930680755082861, log_density = -30929.48583718394, hamiltonian_energy = 31763.685948339094, hamiltonian_energy_error = -0.10941112206273829, max_hamiltonian_energy_error = -0.15255503013759153, tree_depth = 4, numerical_error = false, step_size = 0.00011644852803260039, nom_step_size = 0.00011644852803260039, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9444291281299635, log_density = -30906.635529857176, hamiltonian_energy = 30968.967623286197, hamiltonian_energy_error = 0.14204753470039577, max_hamiltonian_energy_error = 0.19105546208811575, tree_depth = 4, numerical_error = false, step_size = 0.00011644852803260039, nom_step_size = 0.00011644852803260039, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.989884241766166, log_density = -30463.845467111496, hamiltonian_energy = 30961.524580737867, hamiltonian_energy_error = -0.2009050815468072, max_hamiltonian_energy_error = -0.3200947996592731, tree_depth = 4, numerical_error = false, step_size = 0.00011644852803260039, nom_step_size = 0.00011644852803260039, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9816987032909112, log_density = -30326.993536507805, hamiltonian_energy = 30511.612095801996, hamiltonian_energy_error = -0.058276985208067345, max_hamiltonian_energy_error = -0.10849347020484856, tree_depth = 4, numerical_error = false, step_size = 0.00011644852803260039, nom_step_size = 0.00011644852803260039, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-4.04 ± 0.06, -4.04 ± 0.06, -4.04 ± 0.06, -4.04 ± 0.06, -4.04 ± 0.06, -4.04 ± 0.06, -4.04 ± 0.06, -4.04 ± 0.06, -4.04 ± 0.06, -4.04 ± 0.06  …  -4.23 ± 0.058, -4.23 ± 0.058, -4.23 ± 0.058, -4.23 ± 0.058, -4.23 ± 0.058, -4.23 ± 0.058, -4.23 ± 0.058, -4.23 ± 0.058, -4.23 ± 0.058, -4.23 ± 0.058]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.649 ± 0.023 0.0984 ± 0.032; -0.731 ± 0.11 0.361 ± 0.082; … ; 0.922 ± 0.011 0.622 ± 0.023; 0.829 ± 0.081 -0.673 ± 0.088], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.761 ± 0.024; 0.381 ± 0.045; … ; 0.00411 ± 0.056; 1.0 ± 0.023;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.601 ± 0.073 -0.605 ± 0.047 … -0.0705 ± 0.031 -0.778 ± 0.047; -0.298 ± 0.059 -0.0565 ± 0.037 … -0.178 ± 0.092 0.773 ± 0.02; … ; -0.591 ± 0.011 -0.3 ± 0.016 … -0.289 ± 0.028 -0.346 ± 0.036; -0.5 ± 0.012 0.516 ± 0.011 … -0.515 ± 0.098 -0.711 ± 0.09], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.716 ± 0.021; -0.517 ± 0.011; … ; 0.0422 ± 0.053; -0.124 ± 0.034;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-2.35 ± 0.18 2.43 ± 0.22 … -1.26 ± 0.19 -1.41 ± 0.11], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.319 ± 0.23;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.477 ± 0.013], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="5d25c3f2.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Wednesday 6 March 2024 13:51">Wednesday 6 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
