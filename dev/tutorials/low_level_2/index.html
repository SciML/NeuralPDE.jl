<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/complex/">Complex Equations with PINNs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+
                        randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                        noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -3.8145846012273386
 -3.811709204986399
 -4.204353412185567
 -3.9474658065869064
 -3.8726667392529492
 -4.051655716720685
 -4.197497990195818
 -3.415825634369562
 -4.077195508238174
 -3.6328686424567143
  ⋮
 -3.952926336079937
 -4.148136645289637
 -3.8871591048516185
 -3.9021487475542247
 -4.437464955558934
 -3.810201046617735
 -4.006284267129037
 -3.6423368397997447
 -3.966335400936314</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title = &quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="fc069b09.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[-0.5449060607342678, 0.3940189035323302, -0.2011589470580303, 0.15908914934840798, 0.27133325309529444, -0.6570293832239393, -0.17098188113231683, -0.597244825813631, 0.7618624591769433, -0.49805336110414855  …  -0.7022912018283107, 0.6483412251552072, 0.36268341996291975, -0.33805037913667974, -0.589856121026419, -0.16778714285516405, -0.613676684827216, 0.7208319501636574, -0.154234489771306, 0.5007764444449169], [-0.5449060607342678, 0.3940189035323302, -0.2011589470580303, 0.15908914934840798, 0.27133325309529444, -0.6570293832239393, -0.17098188113231683, -0.597244825813631, 0.7618624591769433, -0.49805336110414855  …  -0.7022912018283107, 0.6483412251552072, 0.36268341996291975, -0.33805037913667974, -0.589856121026419, -0.16778714285516405, -0.613676684827216, 0.7208319501636574, -0.154234489771306, 0.5007764444449169], [-0.5449060607342678, 0.3940189035323302, -0.2011589470580303, 0.15908914934840798, 0.27133325309529444, -0.6570293832239393, -0.17098188113231683, -0.597244825813631, 0.7618624591769433, -0.49805336110414855  …  -0.7022912018283107, 0.6483412251552072, 0.36268341996291975, -0.33805037913667974, -0.589856121026419, -0.16778714285516405, -0.613676684827216, 0.7208319501636574, -0.154234489771306, 0.5007764444449169], [-0.5449060607342678, 0.3940189035323302, -0.2011589470580303, 0.15908914934840798, 0.27133325309529444, -0.6570293832239393, -0.17098188113231683, -0.597244825813631, 0.7618624591769433, -0.49805336110414855  …  -0.7022912018283107, 0.6483412251552072, 0.36268341996291975, -0.33805037913667974, -0.589856121026419, -0.16778714285516405, -0.613676684827216, 0.7208319501636574, -0.154234489771306, 0.5007764444449169], [-0.5448920301852062, 0.39402190044451907, -0.20114738059586196, 0.1591231053872602, 0.2713762854724631, -0.6570458810497001, -0.170963838251708, -0.5972915252699535, 0.7619208415642741, -0.49804129682595877  …  -0.7022622252957341, 0.6483778174810977, 0.3626834645768261, -0.33805809395589137, -0.5898753600437837, -0.16777704330084636, -0.613702193867118, 0.7208773434175884, -0.15427532094179905, 0.5007363099899897], [-0.5447763556294991, 0.39430532563661985, -0.200788745870944, 0.15933860984841475, 0.2714965721386715, -0.6562372804491657, -0.1707988743375674, -0.597178659091376, 0.7623508704235418, -0.4975456227041684  …  -0.7022220892125111, 0.6488542835698065, 0.36221420503371016, -0.33827519116711763, -0.5903876478922533, -0.16808023914509707, -0.6142502762969895, 0.7206994791000136, -0.15560478187517846, 0.5004262053214409], [-0.5448089605238721, 0.39453593463200315, -0.20077682575023534, 0.15912581412663312, 0.27150937077334064, -0.655682618538422, -0.1707736044203426, -0.597424432550985, 0.7626010479153292, -0.49666899611461685  …  -0.7026451804579124, 0.6496700818623844, 0.36149139962553417, -0.3390588252012627, -0.5907889826550404, -0.1685268156682337, -0.6147296198077681, 0.7204545217842897, -0.1572814294571836, 0.5003738198103488], [-0.5447051235914523, 0.39519047546074665, -0.19992524934874928, 0.15956156255590637, 0.27156641314428825, -0.6544874900608749, -0.17081355785708183, -0.5976866142018187, 0.7632218197969409, -0.4943079177836984  …  -0.703075371724783, 0.6508286880008739, 0.36059257451325166, -0.34055111099991786, -0.5919564062582938, -0.16952139619210974, -0.6163337316964714, 0.7196188222564575, -0.16012163779941038, 0.5003468821457245], [-0.544647788574623, 0.3952194417674247, -0.20002007808790048, 0.15959666908122552, 0.2717357830305768, -0.6541154529512468, -0.17093582029705728, -0.5976895646032085, 0.7633730833092032, -0.4938816164598425  …  -0.7031054043034951, 0.6512545271987633, 0.3604076872871387, -0.340792182904396, -0.5923474930848325, -0.16985873747402477, -0.6166259683524475, 0.719667624345902, -0.16061428698461194, 0.5003388465854881], [-0.4643918389852865, 0.49536965032505914, -0.1668208337761363, 0.246032311872768, 0.34440680989978517, -0.44193782484662614, -0.2983093785894959, -0.5870388998427815, 0.8708216778735561, -0.2335379916131051  …  -0.8451562823853536, 0.9488082852326686, 0.19510218000529964, -0.6376753378991982, -0.8319823932304125, -0.34938196319599796, -0.9155802000368297, 0.6755767555962449, -0.6372806075743531, 0.5033997357461631]  …  [-0.8306779723266219, 0.7037882605240157, -0.682152695378441, 0.48704806161434455, 0.3768494812151311, -0.6260231992622833, -0.9249468805870371, -0.7848980208693901, 1.6766041449164006, -2.1064889905377515  …  -2.360612991102474, 3.372537003675244, -1.2397194707132255, -2.8754021640100405, -2.9788339667442796, -1.8046926181113614, -3.0405825228373637, 2.5579864978212763, 0.5898296241193705, 0.3112451669470902], [-0.831252766674491, 0.7032496216929878, -0.6819705967495848, 0.48688449569001135, 0.3766000647098664, -0.6271940233204316, -0.9279793334920833, -0.7850058340685789, 1.676514850409399, -2.1064152292174505  …  -2.360733550130816, 3.372571762271598, -1.2395926373452946, -2.8753889405658604, -2.9790091292264966, -1.8046632965390395, -3.0406191081591354, 2.5576219247331005, 0.5898027753341681, 0.3113666216411133], [-0.8319550170005817, 0.7025975436440866, -0.6819824079706971, 0.4869886728069202, 0.3762565239490501, -0.6279948722504176, -0.9287867577417447, -0.7851615631096663, 1.6763391335136808, -2.106409672409567  …  -2.3608156301002294, 3.372645539719816, -1.239251326511951, -2.875470715472988, -2.979277079502245, -1.804668514025282, -3.0405014400922115, 2.557537567744613, 0.5897014319644137, 0.31144951437503077], [-0.8323699969824035, 0.7020431372697149, -0.6820775013564857, 0.486965832708229, 0.37614762045866973, -0.6286867095716886, -0.9292102094010136, -0.7851805106784245, 1.6760640148724868, -2.106090947323785  …  -2.360694773418428, 3.3726178042371098, -1.2392620742345741, -2.875706501421312, -2.979350119330025, -1.8048200305516704, -3.0404675341425396, 2.557498020925147, 0.5894737220025157, 0.31139213956579087], [-0.8328159067161187, 0.7017563143756573, -0.682008088810931, 0.48689696518907055, 0.3760198428341071, -0.6295895000829105, -0.9296735917607798, -0.7851263808115553, 1.675822319138094, -2.1057304420517955  …  -2.360615895467221, 3.37257292398999, -1.2390713974471799, -2.8759335788798652, -2.9794968557417443, -1.804579954742185, -3.0404514008283163, 2.557391949198651, 0.5893686010524729, 0.31123445215963585], [-0.8406050258436216, 0.6958723578991171, -0.6810141577958337, 0.48615523679888584, 0.37439187438303867, -0.6405286124773397, -0.9341201515225912, -0.7853973110132335, 1.6738138164115421, -2.1029331798520707  …  -2.3598431923145853, 3.3735278060831932, -1.238478120603756, -2.876669587769077, -2.9820107043424016, -1.8045332328020918, -3.040702060397947, 2.5560728363245944, 0.5874081601091465, 0.31075858922313937], [-0.8436301571070945, 0.6946005245286321, -0.6808369432928768, 0.4851033296256457, 0.3746812861232263, -0.6438126516231972, -0.9350929196315335, -0.7854818151930945, 1.673134623612154, -2.0999951263476047  …  -2.359789872087124, 3.374771781783257, -1.238333248241422, -2.8776487115136637, -2.983622736421075, -1.804393438517655, -3.0410880140407515, 2.555717507259351, 0.5868834247275725, 0.3102656013301495], [-0.8447235690982589, 0.6944586075267747, -0.6803342926869086, 0.4848363290578295, 0.3742805322530664, -0.6451785740400288, -0.9353381675331338, -0.7853432943866735, 1.6730593051898912, -2.099025229997302  …  -2.3597275420567936, 3.375059121789303, -1.2381377004168315, -2.878044431689352, -2.984075186803593, -1.8043956194956465, -3.041414684708954, 2.5555614758322838, 0.5864415124053473, 0.3102667390877596], [-0.8451734013374899, 0.6940873415055943, -0.6800135462509841, 0.4842796466716532, 0.37405057403283803, -0.6465231133781972, -0.935726349443446, -0.7851864072058969, 1.6725899068191403, -2.0980702402559035  …  -2.359802485324343, 3.37504856229174, -1.2381480737796478, -2.8781661262158353, -2.9839769976622295, -1.804600622871579, -3.0413140269883274, 2.55543366278724, 0.5859204131569111, 0.3105286547298967], [-0.8456292228121687, 0.6942368126171021, -0.6797911051269625, 0.48372141070782493, 0.3740136197167286, -0.6469021186586845, -0.93587282256611, -0.7849469048855211, 1.6726089035089118, -2.097500300132462  …  -2.359779636034554, 3.375372027801245, -1.2381895866522723, -2.8783265686850825, -2.9841097523063818, -1.8045585049156792, -3.0416900958399347, 2.5555838464242826, 0.5859501682535551, 0.31044078611987663]], NamedTuple[(n_steps = 1, is_accept = true, acceptance_rate = 1.0, log_density = -1.6012602589736881e6, hamiltonian_energy = 1.7256774063458284e6, hamiltonian_energy_error = -4121.290331848431, max_hamiltonian_energy_error = -4121.290331848431, tree_depth = 1, numerical_error = false, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6012602589736881e6, hamiltonian_energy = 1.601313459593195e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1.1470177045941713e47, tree_depth = 0, numerical_error = true, step_size = 0.022477359524651217, nom_step_size = 0.022477359524651217, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6012602589736881e6, hamiltonian_energy = 1.6013088236591106e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1.753447678548684e6, tree_depth = 0, numerical_error = true, step_size = 0.003798698975534599, nom_step_size = 0.003798698975534599, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 8.941770302243364e-13, log_density = -1.6012602589736881e6, hamiltonian_energy = 1.60131952509347e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 321.97280167625286, tree_depth = 3, numerical_error = false, step_size = 0.00037467407115379783, nom_step_size = 0.00037467407115379783, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9933925330252974, log_density = -1.6012061819846078e6, hamiltonian_energy = 1.601308432146032e6, hamiltonian_energy_error = 0.0015828937757760286, max_hamiltonian_energy_error = 0.017951882909983397, tree_depth = 3, numerical_error = false, step_size = 2.9105093373913548e-5, nom_step_size = 2.9105093373913548e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9764739086767954, log_density = -1.5999787409384816e6, hamiltonian_energy = 1.6012636895660353e6, hamiltonian_energy_error = 0.04270517732948065, max_hamiltonian_energy_error = 0.07013171422295272, tree_depth = 3, numerical_error = false, step_size = 3.941237582391336e-5, nom_step_size = 3.941237582391336e-5, is_adapt = true), (n_steps = 31, is_accept = true, acceptance_rate = 0.4312890242160492, log_density = -1.5985634299811588e6, hamiltonian_energy = 1.6000305831781668e6, hamiltonian_energy_error = 0.12510585389100015, max_hamiltonian_energy_error = 3.63894328661263, tree_depth = 5, numerical_error = false, step_size = 5.757052689468707e-5, nom_step_size = 5.757052689468707e-5, is_adapt = true), (n_steps = 31, is_accept = true, acceptance_rate = 0.9903241370793572, log_density = -1.5957363570536377e6, hamiltonian_energy = 1.5986271478083539e6, hamiltonian_energy_error = 0.021920488215982914, max_hamiltonian_energy_error = 0.028560198610648513, tree_depth = 5, numerical_error = false, step_size = 1.6649781799840147e-5, nom_step_size = 1.6649781799840147e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9937365491147467, log_density = -1.5950877152301655e6, hamiltonian_energy = 1.5957872591899273e6, hamiltonian_energy_error = 0.017468638718128204, max_hamiltonian_energy_error = 0.017468638718128204, tree_depth = 3, numerical_error = false, step_size = 2.8345175508379494e-5, nom_step_size = 2.8345175508379494e-5, is_adapt = true), (n_steps = 127, is_accept = true, acceptance_rate = 0.47236094776388, log_density = -1.0360309081431059e6, hamiltonian_energy = 1.5951163151118662e6, hamiltonian_energy_error = -19.86529490747489, max_hamiltonian_energy_error = -20.293921088101342, tree_depth = 7, numerical_error = false, step_size = 5.06901247164287e-5, nom_step_size = 5.06901247164287e-5, is_adapt = true)  …  (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -45103.7657975263, hamiltonian_energy = 47230.047067022315, hamiltonian_energy_error = -466.0147771332631, max_hamiltonian_energy_error = -466.0147771332631, tree_depth = 2, numerical_error = false, step_size = 5.313511507190134e-5, nom_step_size = 5.313511507190134e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -42482.99429657237, hamiltonian_energy = 44998.354589776856, hamiltonian_energy_error = -162.75639741130726, max_hamiltonian_energy_error = -162.75639741130726, tree_depth = 3, numerical_error = false, step_size = 5.313511507190134e-5, nom_step_size = 5.313511507190134e-5, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -41704.68879252119, hamiltonian_energy = 42527.44268419213, hamiltonian_energy_error = -13.260261529278068, max_hamiltonian_energy_error = -13.260261529278068, tree_depth = 2, numerical_error = false, step_size = 5.313511507190134e-5, nom_step_size = 5.313511507190134e-5, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -41123.39515114133, hamiltonian_energy = 41751.350393227476, hamiltonian_energy_error = -5.569210958397889, max_hamiltonian_energy_error = -5.569210958397889, tree_depth = 2, numerical_error = false, step_size = 5.313511507190134e-5, nom_step_size = 5.313511507190134e-5, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -40599.16393938514, hamiltonian_energy = 41178.48197566717, hamiltonian_energy_error = -3.480023385491222, max_hamiltonian_energy_error = -3.480023385491222, tree_depth = 2, numerical_error = false, step_size = 5.313511507190134e-5, nom_step_size = 5.313511507190134e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 1.0, log_density = -35362.52541452776, hamiltonian_energy = 40654.21415040703, hamiltonian_energy_error = -16.998951449306333, max_hamiltonian_energy_error = -16.998951449306333, tree_depth = 4, numerical_error = false, step_size = 5.313511507190134e-5, nom_step_size = 5.313511507190134e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 1.0, log_density = -33468.25971013995, hamiltonian_energy = 35420.85476962048, hamiltonian_energy_error = -3.0346894594695186, max_hamiltonian_energy_error = -3.4321857400937006, tree_depth = 4, numerical_error = false, step_size = 5.313511507190134e-5, nom_step_size = 5.313511507190134e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.9892748948019684, log_density = -32919.533447622176, hamiltonian_energy = 33523.580452600174, hamiltonian_energy_error = -0.27276175147562753, max_hamiltonian_energy_error = -0.27276175147562753, tree_depth = 3, numerical_error = false, step_size = 5.313511507190134e-5, nom_step_size = 5.313511507190134e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -32254.715366810742, hamiltonian_energy = 32978.86446144095, hamiltonian_energy_error = -0.5720887031638995, max_hamiltonian_energy_error = -0.5720887031638995, tree_depth = 3, numerical_error = false, step_size = 5.313511507190134e-5, nom_step_size = 5.313511507190134e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.9988396202223674, log_density = -32001.07536859576, hamiltonian_energy = 32301.823076139397, hamiltonian_energy_error = -0.13879646054920158, max_hamiltonian_energy_error = -0.31931640862239874, tree_depth = 3, numerical_error = false, step_size = 5.313511507190134e-5, nom_step_size = 5.313511507190134e-5, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-3.8 ± 0.13, -3.8 ± 0.13, -3.8 ± 0.13, -3.8 ± 0.13, -3.8 ± 0.13, -3.8 ± 0.13, -3.8 ± 0.13, -3.8 ± 0.13, -3.8 ± 0.13, -3.8 ± 0.13  …  -3.88 ± 0.16, -3.88 ± 0.16, -3.88 ± 0.16, -3.88 ± 0.16, -3.88 ± 0.16, -3.88 ± 0.16, -3.88 ± 0.16, -3.88 ± 0.16, -3.88 ± 0.16, -3.88 ± 0.16]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.701 ± 0.098 1.21 ± 0.33; 0.597 ± 0.072 -0.921 ± 0.83; … ; -0.676 ± 0.18 -0.0376 ± 0.61; -0.617 ± 0.12 0.796 ± 0.14], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.357 ± 0.27; 1.19 ± 0.077; … ; -0.315 ± 0.064; -0.0613 ± 0.093;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.372 ± 0.15 -0.345 ± 0.065 … 0.448 ± 0.22 0.519 ± 0.11; 0.365 ± 0.1 1.03 ± 0.23 … -0.16 ± 0.11 0.134 ± 0.0041; … ; -0.301 ± 0.18 -0.371 ± 0.29 … -0.328 ± 0.098 -0.261 ± 0.01; 0.148 ± 0.12 0.864 ± 0.31 … -0.528 ± 0.084 0.226 ± 0.04], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.366 ± 0.077; -0.805 ± 0.017; … ; -0.159 ± 0.27; -0.279 ± 0.068;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-1.66 ± 0.49 2.35 ± 0.72 … -2.06 ± 0.69 1.58 ± 0.68], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.309 ± 0.63;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.436 ± 0.088], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain)
          for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="b60815e6.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Tuesday 9 April 2024 03:22">Tuesday 9 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
