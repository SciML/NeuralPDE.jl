<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -4.383061853279087
 -4.055555409444659
 -3.994335029565173
 -3.707033995560972
 -3.8027857857216785
 -3.737465612132361
 -4.186275846163038
 -4.2097932023570825
 -3.757905118786254
 -3.7999138959537206
  ⋮
 -4.241489517723572
 -4.453922459906191
 -4.068359364177562
 -4.218379171200243
 -4.095404177114854
 -4.185228719523885
 -4.150608456511111
 -3.9209808405374296
 -4.126137703103</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="36dd2f2d.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[-0.7045227628630791, -0.2565203821764762, -0.16332057310014275, -0.6731960067734232, -0.7180229632303546, -0.48510569013073795, -0.3348893269647706, -0.3841741654406843, 0.578132662466632, 0.33422944056090925  …  0.46762880948860325, -0.32054389482477497, -0.49897323070666255, -0.35853154249158514, 0.5684399849569043, -0.7216731802107059, -0.6083208518589982, 0.5148109850473932, -0.19241569369095615, 0.5011772404148244], [-0.7045227628630791, -0.2565203821764762, -0.16332057310014275, -0.6731960067734232, -0.7180229632303546, -0.48510569013073795, -0.3348893269647706, -0.3841741654406843, 0.578132662466632, 0.33422944056090925  …  0.46762880948860325, -0.32054389482477497, -0.49897323070666255, -0.35853154249158514, 0.5684399849569043, -0.7216731802107059, -0.6083208518589982, 0.5148109850473932, -0.19241569369095615, 0.5011772404148244], [-0.7045227628630791, -0.2565203821764762, -0.16332057310014275, -0.6731960067734232, -0.7180229632303546, -0.48510569013073795, -0.3348893269647706, -0.3841741654406843, 0.578132662466632, 0.33422944056090925  …  0.46762880948860325, -0.32054389482477497, -0.49897323070666255, -0.35853154249158514, 0.5684399849569043, -0.7216731802107059, -0.6083208518589982, 0.5148109850473932, -0.19241569369095615, 0.5011772404148244], [-0.6975447135849614, -0.25459020601755805, -0.1571122549224589, -0.6771957526638694, -0.7159398220578315, -0.46789465763601384, -0.33165961138039235, -0.3897533877681296, 0.5876642764190688, 0.3393496338224199  …  0.46408795518742074, -0.3103047667670638, -0.5007352938539625, -0.35846770646389464, 0.5811661359237841, -0.7332255938233245, -0.6191143061809125, 0.5368458292072078, -0.22320455289119445, 0.5008559251692685], [-0.6936028762697898, -0.2548492976413762, -0.1549241593186316, -0.6781788210990226, -0.7144023307983859, -0.46086310235989836, -0.3297131937992333, -0.3924488991823024, 0.5912851581077835, 0.34109650024939847  …  0.46417997951074247, -0.3046658091683847, -0.504467343531998, -0.36015145206784344, 0.5867610499440136, -0.7392314231701257, -0.626102646117221, 0.5446333879459869, -0.23711066380192303, 0.5007992801467732], [-0.692734946795406, -0.25516571098782465, -0.15439398653330497, -0.6781841786917124, -0.71457438394359, -0.4592445092209406, -0.3292202518365935, -0.3926571720831852, 0.5919447792448088, 0.3416327949923638  …  0.4644415287272888, -0.3036096623499433, -0.5055798341431451, -0.3600802405432832, 0.5877649058362191, -0.7412015565732578, -0.6277296628634673, 0.5466541728664202, -0.24022052695399307, 0.500974655729667], [-0.6925168208116951, -0.25510015500856426, -0.15435547469108568, -0.67846525117094, -0.7146803955009171, -0.4590221991408305, -0.3290919152036475, -0.3929019713742224, 0.5922647840204022, 0.3417778537982868  …  0.4644354205440071, -0.30318787147853327, -0.505799951993565, -0.36018416825386873, 0.588095702644904, -0.7417682079594646, -0.628189963291818, 0.5470569034344235, -0.2407932469472211, 0.5009023866626863], [-0.6923453594707665, -0.2550948029884058, -0.15429020885190337, -0.6783319688708166, -0.7147299323094951, -0.4589647585082265, -0.3291194311587929, -0.3929143689387155, 0.5922428733381477, 0.34179212293137307  …  0.4644406811341974, -0.30313090482828076, -0.5058159715810342, -0.3602734473567638, 0.5881349442336531, -0.741821413955123, -0.6282449793258243, 0.5470973059223202, -0.24100193772158296, 0.5009640396246386], [-0.6921568769665744, -0.2550159012895399, -0.15411050213443458, -0.6784150593433257, -0.7147291768988114, -0.45860893160028315, -0.3294087649658219, -0.3930561984719718, 0.5924745013471112, 0.3420412109476374  …  0.46463140771354966, -0.3028482153933199, -0.5061085057254258, -0.36039544702723875, 0.5882961205532538, -0.7419957996995867, -0.6286377867658202, 0.547671408629899, -0.24187159296471242, 0.5011890350066828], [-0.6921278078264002, -0.25510936902139164, -0.15400215985848414, -0.6784671582088283, -0.7147081312484828, -0.45856375192646315, -0.3294870368545179, -0.3931036431019721, 0.5925317738887451, 0.3420710558736576  …  0.4645360991589644, -0.3027586186893467, -0.5060634906470627, -0.3604437951516513, 0.588369267274344, -0.7420084991453352, -0.6286804589071736, 0.547815838288808, -0.24209687272728644, 0.5012427831067333]  …  [-1.0949626168729623, -0.5860468480463635, -0.7773292118918935, -0.1809679604509431, -0.5841775541802033, -0.8108218288890727, -0.8146562149713272, -0.7659120358097198, 2.6027995406956346, 0.209110840286651  …  3.7056240320682114, 2.4984442682024692, -3.811452285095811, -3.6808992091156143, 3.4944627146622906, -3.9781682617948015, -4.107544307884521, 3.2654217922114728, 1.4264234309492756, 0.6207831406871296], [-1.094508842983391, -0.5857362785895731, -0.7774269625307741, -0.18166141415806875, -0.5843854263854384, -0.8105368127494181, -0.8155480287610098, -0.7662553432067429, 2.6026778210405364, 0.2092429492106537  …  3.7057958435482097, 2.498362532534162, -3.8113467414754174, -3.680820605727976, 3.4943863401121815, -3.978416457858002, -4.10801133836852, 3.265403054750669, 1.4261736631890611, 0.6208729443259959], [-1.0942082355219662, -0.5855583997341105, -0.777127470579459, -0.18240910165840732, -0.5847378342647883, -0.8103122462936051, -0.8165936109198667, -0.7665274979753334, 2.6024135146799616, 0.20927942059121402  …  3.7056079558722654, 2.498246583006433, -3.8112232274678433, -3.6806167534901983, 3.494545298666096, -3.9786268808676857, -4.108193072390935, 3.265395889119211, 1.4257816007160053, 0.6207832000606816], [-1.0938416724351834, -0.5853231986964827, -0.7772251968324815, -0.18309599366952703, -0.5851367593582061, -0.8102574335263604, -0.8176167243752486, -0.7669830286058663, 2.602212109616926, 0.20957695216841055  …  3.705417453215547, 2.4980229849219033, -3.8110527047213054, -3.6807370127106958, 3.494485431784326, -3.9789041832796963, -4.1084545100087455, 3.2652866237226164, 1.4254881561099368, 0.6206955657367251], [-1.0932962888916122, -0.5841223257703405, -0.7768212478359944, -0.18510618898498052, -0.5860122869778287, -0.8094795014376184, -0.8215073586108561, -0.7674381373975355, 2.6021100652983433, 0.20975775430374238  …  3.704439480824306, 2.4980832582240438, -3.810556261238373, -3.680626896297942, 3.4942620642843956, -3.9798777412599957, -4.109456406196618, 3.265620768314334, 1.4247419760888684, 0.6205204740255843], [-1.0930596826225738, -0.5834908724880352, -0.7770828769961956, -0.1860433955264446, -0.5868658925709024, -0.8088768684649316, -0.8230235304005159, -0.7678113096844285, 2.602132254076275, 0.20978723263288587  …  3.7046449824517698, 2.497728674512647, -3.810038939365088, -3.6805015475765375, 3.493788205119484, -3.9803542504777805, -4.1098722167454245, 3.2656930365278143, 1.4239751105661418, 0.6202734848573966], [-1.0923048252523704, -0.5827158956085761, -0.7768300305079247, -0.1874624864930635, -0.5874705597943394, -0.8074949601397907, -0.8253552213834915, -0.769140316971522, 2.6021830515789723, 0.21085795551401507  …  3.704883294941853, 2.497565427302699, -3.810297290415882, -3.6800861515099994, 3.4932481803880586, -3.9811959600262714, -4.110245488054379, 3.26531847317374, 1.4234867090104486, 0.6201697307502203], [-1.0922398258184367, -0.5816196697923182, -0.7771768089068251, -0.18926775082998437, -0.5878516000520684, -0.8061689472019296, -0.8273719016859873, -0.770358925614012, 2.602275975334531, 0.2113769958230514  …  3.7041346308870975, 2.497681794558641, -3.809343296862157, -3.679825514168121, 3.492985240964992, -3.98179902675141, -4.11059648852998, 3.2654396919000552, 1.42293382098125, 0.62047667534411], [-1.0919021113256189, -0.5790403986039421, -0.7771966695847486, -0.19243384335651417, -0.5903252289818776, -0.8042768185638137, -0.83087919400065, -0.7723133814162039, 2.602600750144798, 0.21269372667763126  …  3.7034775672714884, 2.497469637131044, -3.8087609133462252, -3.6798476562504425, 3.4926775383453985, -3.9833580516093576, -4.111557943012797, 3.2659419839941086, 1.4219984859433745, 0.6207542332608831], [-1.0915192521185366, -0.5770400469452894, -0.7775719633505097, -0.1950667060262713, -0.5910768710664276, -0.8025155944319852, -0.8321277545426151, -0.7732203353555077, 2.602561508815088, 0.21335025641220023  …  3.7037087058518354, 2.4969752216956804, -3.8089968669892547, -3.6795705994334016, 3.4924498407948783, -3.9834974454005727, -4.111672469039411, 3.2664048158037966, 1.4220232521783407, 0.6206442246945493]], NamedTuple[(n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.578848467101301e6, hamiltonian_energy = 1.6885896649419854e6, hamiltonian_energy_error = -5373.2119635916315, max_hamiltonian_energy_error = -5373.2119635916315, tree_depth = 2, numerical_error = false, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.578848467101301e6, hamiltonian_energy = 1.5788946894109168e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1.9277812234973608e55, tree_depth = 0, numerical_error = true, step_size = 0.022477359524651217, nom_step_size = 0.022477359524651217, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.578848467101301e6, hamiltonian_energy = 1.5789099091968692e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 3.0353590366198365e6, tree_depth = 0, numerical_error = true, step_size = 0.003798698975534599, nom_step_size = 0.003798698975534599, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.5455887147345638e6, hamiltonian_energy = 1.5787507382978015e6, hamiltonian_energy_error = -138.4436483294703, max_hamiltonian_energy_error = -138.4436483294703, tree_depth = 2, numerical_error = false, step_size = 0.00037467407115379783, nom_step_size = 0.00037467407115379783, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.0031900920038344014, log_density = -1.530855258199882e6, hamiltonian_energy = 1.545651171521728e6, hamiltonian_energy_error = 3.801874255295843, max_hamiltonian_energy_error = 132.51155370054767, tree_depth = 3, numerical_error = false, step_size = 0.00050676938898118, nom_step_size = 0.00050676938898118, is_adapt = true), (n_steps = 127, is_accept = true, acceptance_rate = 0.4177387870632322, log_density = -1.5274230963410614e6, hamiltonian_energy = 1.5309152427521981e6, hamiltonian_energy_error = 0.056094643427059054, max_hamiltonian_energy_error = 4.429195749340579, tree_depth = 7, numerical_error = false, step_size = 4.058061750951256e-5, nom_step_size = 4.058061750951256e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9998051109984082, log_density = -1.5267211289617806e6, hamiltonian_energy = 1.527478259371661e6, hamiltonian_energy_error = 0.000563483452424407, max_hamiltonian_energy_error = 0.0008039514068514109, tree_depth = 4, numerical_error = false, step_size = 1.0721376899460004e-5, nom_step_size = 1.0721376899460004e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9990847885932695, log_density = -1.526555348557338e6, hamiltonian_energy = 1.526766612151198e6, hamiltonian_energy_error = 0.0013143850956112146, max_hamiltonian_energy_error = 0.0023983907885849476, tree_depth = 3, numerical_error = false, step_size = 1.7695992066618616e-5, nom_step_size = 1.7695992066618616e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.993969436728005, log_density = -1.5256947278459638e6, hamiltonian_energy = 1.5266114595432049e6, hamiltonian_energy_error = 0.006827557692304254, max_hamiltonian_energy_error = 0.018965017283335328, tree_depth = 3, numerical_error = false, step_size = 3.0985466638193224e-5, nom_step_size = 3.0985466638193224e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9533356757496814, log_density = -1.5255284012481235e6, hamiltonian_energy = 1.5257491668074904e6, hamiltonian_energy_error = 0.008657279424369335, max_hamiltonian_energy_error = 0.12727244454436004, tree_depth = 3, numerical_error = false, step_size = 5.547645414475934e-5, nom_step_size = 5.547645414475934e-5, is_adapt = true)  …  (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -38093.893843459635, hamiltonian_energy = 38872.06951508984, hamiltonian_energy_error = -7.873206401498464, max_hamiltonian_energy_error = -7.873206401498464, tree_depth = 2, numerical_error = false, step_size = 7.596670915182976e-5, nom_step_size = 7.596670915182976e-5, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -37383.6784754423, hamiltonian_energy = 38150.573901352596, hamiltonian_energy_error = -5.739506426703883, max_hamiltonian_energy_error = -5.739506426703883, tree_depth = 2, numerical_error = false, step_size = 7.596670915182976e-5, nom_step_size = 7.596670915182976e-5, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -36763.25395378017, hamiltonian_energy = 37428.0322674725, hamiltonian_energy_error = -4.462367218133295, max_hamiltonian_energy_error = -4.462367218133295, tree_depth = 2, numerical_error = false, step_size = 7.596670915182976e-5, nom_step_size = 7.596670915182976e-5, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -36237.80814927806, hamiltonian_energy = 36805.28891529438, hamiltonian_energy_error = -3.1197199481684947, max_hamiltonian_energy_error = -3.1197199481684947, tree_depth = 2, numerical_error = false, step_size = 7.596670915182976e-5, nom_step_size = 7.596670915182976e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -34414.50605362759, hamiltonian_energy = 36288.5896378252, hamiltonian_energy_error = -8.318207597694709, max_hamiltonian_energy_error = -8.318207597694709, tree_depth = 3, numerical_error = false, step_size = 7.596670915182976e-5, nom_step_size = 7.596670915182976e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -33653.07295323774, hamiltonian_energy = 34474.853823123296, hamiltonian_energy_error = -2.695288285241986, max_hamiltonian_energy_error = -4.407261749933241, tree_depth = 3, numerical_error = false, step_size = 7.596670915182976e-5, nom_step_size = 7.596670915182976e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -32489.601601028968, hamiltonian_energy = 33695.25192656809, hamiltonian_energy_error = -3.5074768674967345, max_hamiltonian_energy_error = -4.9699092236187425, tree_depth = 3, numerical_error = false, step_size = 7.596670915182976e-5, nom_step_size = 7.596670915182976e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -31511.447069846072, hamiltonian_energy = 32544.263134730387, hamiltonian_energy_error = -2.2101532402448356, max_hamiltonian_energy_error = -4.556731642478553, tree_depth = 3, numerical_error = false, step_size = 7.596670915182976e-5, nom_step_size = 7.596670915182976e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -29559.29869023088, hamiltonian_energy = 31547.23031049783, hamiltonian_energy_error = -3.7233763975455076, max_hamiltonian_energy_error = -3.7233763975455076, tree_depth = 3, numerical_error = false, step_size = 7.596670915182976e-5, nom_step_size = 7.596670915182976e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -28532.12400195837, hamiltonian_energy = 29606.861156607338, hamiltonian_energy_error = -1.5788273452526482, max_hamiltonian_energy_error = -1.5788273452526482, tree_depth = 3, numerical_error = false, step_size = 7.596670915182976e-5, nom_step_size = 7.596670915182976e-5, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-3.92 ± 0.065, -3.92 ± 0.065, -3.92 ± 0.065, -3.92 ± 0.065, -3.92 ± 0.065, -3.92 ± 0.065, -3.92 ± 0.066, -3.92 ± 0.066, -3.92 ± 0.066, -3.92 ± 0.066  …  -4.12 ± 0.2, -4.12 ± 0.2, -4.12 ± 0.2, -4.11 ± 0.2, -4.11 ± 0.2, -4.11 ± 0.2, -4.11 ± 0.2, -4.11 ± 0.2, -4.11 ± 0.2, -4.11 ± 0.2]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.683 ± 0.31 1.51 ± 0.82; -0.453 ± 0.098 0.404 ± 0.15; … ; -0.624 ± 0.15 1.21 ± 0.51; -0.658 ± 0.082 1.32 ± 2.4], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.426 ± 0.4; -0.0274 ± 0.43; … ; 0.664 ± 0.15; -1.38 ± 0.31;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.22 ± 0.32 0.0183 ± 0.12 … 0.257 ± 0.13 -0.0168 ± 0.3; 0.559 ± 0.091 0.265 ± 0.00071 … 0.239 ± 0.12 -0.47 ± 0.0066; … ; -0.638 ± 0.03 0.416 ± 0.13 … -0.439 ± 0.11 0.611 ± 0.26; 0.092 ± 0.012 -0.689 ± 0.21 … 0.618 ± 0.034 -0.76 ± 0.23], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.2 ± 0.077; 0.379 ± 0.094; … ; 1.01 ± 0.14; 0.42 ± 0.19;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[1.98 ± 1.3 1.12 ± 1.0 … -2.6 ± 1.1 1.94 ± 0.99], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.174 ± 1.2;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.546 ± 0.056], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="c0760fa4.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Friday 15 March 2024 18:53">Friday 15 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
