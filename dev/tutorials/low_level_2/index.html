<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -3.975131216912681
 -3.9559110849970063
 -4.0216805397229844
 -4.168578201030661
 -4.142856035085865
 -3.5162258481264326
 -3.8877750469758685
 -3.95216063996236
 -3.9265313296124287
 -3.8365851720581863
  ⋮
 -3.9794786980856656
 -3.976939754372049
 -4.11681389178918
 -4.2224261498182845
 -4.151337979796134
 -3.930155604473979
 -3.857799278789345
 -3.967454154765494
 -4.107205274648662</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="67898866.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[0.48942782884940655, -0.6024460437249427, -0.40746985739212815, -0.5560852205011972, 0.5413323737607281, -0.4237073346316354, 0.37245986092734124, -0.4803987154598984, -0.228989278706106, -0.5055779157652949  …  -0.29451685304209463, -0.6119068065621645, 0.23358049861909674, -0.2824836629529009, 0.12986326205819593, -0.5130343492468605, -0.4498426858359844, 0.1758642564377618, -0.1694509814421885, 0.4975525359052353], [0.48942782884940655, -0.6024460437249427, -0.40746985739212815, -0.5560852205011972, 0.5413323737607281, -0.4237073346316354, 0.37245986092734124, -0.4803987154598984, -0.228989278706106, -0.5055779157652949  …  -0.29451685304209463, -0.6119068065621645, 0.23358049861909674, -0.2824836629529009, 0.12986326205819593, -0.5130343492468605, -0.4498426858359844, 0.1758642564377618, -0.1694509814421885, 0.4975525359052353], [0.48942782884940655, -0.6024460437249427, -0.40746985739212815, -0.5560852205011972, 0.5413323737607281, -0.4237073346316354, 0.37245986092734124, -0.4803987154598984, -0.228989278706106, -0.5055779157652949  …  -0.29451685304209463, -0.6119068065621645, 0.23358049861909674, -0.2824836629529009, 0.12986326205819593, -0.5130343492468605, -0.4498426858359844, 0.1758642564377618, -0.1694509814421885, 0.4975525359052353], [0.4890760623268551, -0.6025537154613576, -0.40774637814553005, -0.5559877838099371, 0.5407408564225553, -0.42381457922214927, 0.3717245765202324, -0.4810559421424298, -0.23121491247637704, -0.5068890819022243  …  -0.29472596564427184, -0.6133958508970799, 0.23432478075231444, -0.2843835122608703, 0.1323345442559351, -0.5161882501781181, -0.45242585772654936, 0.17617237941445715, -0.1816058854049001, 0.49782677352421095], [0.4887833591030298, -0.6024072593407129, -0.40756034330481516, -0.5561691413961275, 0.5409378687251949, -0.4239180193992508, 0.37172781481879064, -0.48135865781843445, -0.23226488164219036, -0.5070064340620101  …  -0.29523120233957845, -0.6139200684391097, 0.23448151164062742, -0.2852450499582914, 0.13343655772848967, -0.5169535870544331, -0.45344941184127985, 0.17598601704483263, -0.18536922484223092, 0.4976363708154053], [0.48880439535447306, -0.6024605513932713, -0.40758147787579335, -0.5561601516467041, 0.5409004517223472, -0.4239306688742612, 0.3717226073361008, -0.4813492891924672, -0.23233071338845196, -0.5070406848760699  …  -0.2952657338331895, -0.613932056576918, 0.23443547245792237, -0.28524038006530644, 0.13344041345678054, -0.5169464872592028, -0.4535488661713332, 0.1759311195579317, -0.18545184116899818, 0.4976045224482256], [0.48858430402333203, -0.6021541137755684, -0.4078502951194047, -0.5559182340983204, 0.5406808698019534, -0.4235822048577655, 0.3717460683289406, -0.48153826725251536, -0.23299395732718906, -0.507364200575652  …  -0.29560211522984614, -0.6145914739604557, 0.2348289412929581, -0.28565296604987, 0.13373553310133973, -0.5176381072357954, -0.4537885899068783, 0.1757616523724096, -0.18822044950028036, 0.49771973966292604], [0.48734621385621757, -0.6011290057024464, -0.40747624645282937, -0.5553273327296583, 0.5409648488651368, -0.4243339294281001, 0.37152469169558017, -0.48274566094827803, -0.23705560568984324, -0.5082968046538322  …  -0.2964810155842764, -0.6170500410069308, 0.23447682672257786, -0.28930739180085063, 0.13881592662641531, -0.5230087246252898, -0.4583873542803409, 0.17676039531608748, -0.2048334069650254, 0.49808673456941643], [0.4873546012690796, -0.6009736819715029, -0.40751752786212797, -0.5553035133838827, 0.5408102334432596, -0.42423643777223485, 0.37153921840365317, -0.482837426086104, -0.23739871117719052, -0.5083304782175891  …  -0.29650368140154426, -0.6171472353684646, 0.23443611329548486, -0.2895300916160773, 0.13906768076343423, -0.5234820252531519, -0.45874991111478713, 0.17667519217592992, -0.20567828206680977, 0.4981439629604931], [0.48692040143477305, -0.6009693386598142, -0.4073777393348091, -0.5552478469716003, 0.5408560496814179, -0.4244103572601063, 0.3714412399239777, -0.48276805008303975, -0.23795420767126158, -0.5082462262203356  …  -0.2965423095385776, -0.6173294348395133, 0.23430543408460797, -0.2900947848045243, 0.13986230969717142, -0.5238068414605855, -0.45930498901244216, 0.17657006863750163, -0.20770136067751624, 0.4980843273521807]  …  [0.7782112176630466, -1.0435247506132177, -0.3351605829959585, -0.6241007015283742, 0.48379059422913356, -0.43092090109394054, 0.7023985642524716, -0.38287546995088906, -0.8307234588760389, 0.34350623215166837  …  -1.4329658695643674, -2.2293943750362124, -0.29160659224250407, -1.7069840486605792, 1.7163451173006299, -2.829191694192674, -2.210513524588092, 1.0679724326590057, -0.4516231999619372, 0.4522174715862022], [0.7803316152484819, -1.052233765218581, -0.3335085756904974, -0.624291566376798, 0.4823656438941782, -0.43206769367552333, 0.7021781580752406, -0.3859746093496596, -0.8333671376248022, 0.34597992694681656  …  -1.4353064754740572, -2.2313438995392487, -0.2936457985479512, -1.7085822677542262, 1.719105498300135, -2.832237079986395, -2.2131099901408042, 1.0721711369746942, -0.4469535274751757, 0.44973855751634645], [0.7811239882552623, -1.0570904831615164, -0.3331411657349804, -0.6249112466759276, 0.48272503756462104, -0.4323951262342125, 0.7020127716391761, -0.3868221200672033, -0.83354771134266, 0.3477929228784079  …  -1.4382662346854758, -2.2325577605443705, -0.2938463365754762, -1.7102861861175735, 1.7201770099523852, -2.831709259132547, -2.214085192249203, 1.0756496463787464, -0.44521165745892205, 0.4487830701958224], [0.7815659258639849, -1.0595220537401098, -0.3322987411671461, -0.6252145259888159, 0.48263997806250314, -0.43256264179193127, 0.7020178885963237, -0.38824990807515464, -0.8344902823204658, 0.34850351035540306  …  -1.4386634145315023, -2.233467900790582, -0.2947508085285962, -1.7112554002146523, 1.721252895303109, -2.8329877723521504, -2.214866348975578, 1.077461164645303, -0.4440863161244771, 0.44875143167499204], [0.7842617356821475, -1.0749172570569556, -0.3302637071132956, -0.6270785447725014, 0.48154141416557544, -0.43505687616189614, 0.7037387104449244, -0.3957436481618527, -0.8378598858957869, 0.35353157172173383  …  -1.4412890206367293, -2.241410819743849, -0.30035243926190097, -1.7164804242515987, 1.7282187432973057, -2.839812719698633, -2.22036976668826, 1.0860242236210356, -0.43648339380084183, 0.4478607225782024], [0.7891963474713546, -1.110785580161774, -0.3292869764904351, -0.6321787650005201, 0.47405695137740017, -0.43626519022638266, 0.7091702320827984, -0.40910006848079905, -0.8470185714444463, 0.3648833211968896  …  -1.4547129438178814, -2.261377029064468, -0.31047581565014815, -1.730946568632408, 1.7458084685157154, -2.857428285538238, -2.2358291873625755, 1.1096924664127281, -0.4196349046682072, 0.4373292538015315], [0.7894287813880193, -1.1115248934156043, -0.32931003507689427, -0.6326378956079362, 0.474149092184662, -0.43592126240388274, 0.708886941167036, -0.40930581966777524, -0.8476867151250603, 0.36459910481056124  …  -1.4546506663840824, -2.2616729684661814, -0.31161895809680973, -1.7316243300734717, 1.7462144452050339, -2.858388329524044, -2.2359238559608854, 1.1104121780810157, -0.41930475562239633, 0.43762929843292814], [0.7896313689025759, -1.1121484126865102, -0.328889271123984, -0.6326925416375873, 0.4739763390355257, -0.43576837206123137, 0.7088303051726702, -0.4102199190570425, -0.8486643413644662, 0.3649134608538722  …  -1.455270444805388, -2.2624654039077976, -0.3114692183491772, -1.731750642516568, 1.7468856687803187, -2.8587977576504877, -2.236399776847246, 1.1109735916810037, -0.4189768231992135, 0.43759294826390294], [0.7898835763951817, -1.1128327676337302, -0.3289025033373415, -0.6323903291624384, 0.4735965894228594, -0.4352768235838682, 0.7085604674310265, -0.41066375616546597, -0.8490700724570135, 0.3661589944057621  …  -1.4558795440639665, -2.2630039081112043, -0.3118804117228523, -1.7311756067967403, 1.747807256848818, -2.8592477938352467, -2.2374945029673836, 1.1117979751450067, -0.4187132889112798, 0.4377155289887652], [0.7901745861260702, -1.1134298055829357, -0.32895209746585047, -0.6322365062927212, 0.4732522190393704, -0.43560534890056685, 0.7089907856618491, -0.41121900695338276, -0.8497174631473089, 0.36631888821270014  …  -1.4561736142102317, -2.2637129335153, -0.31265325489354256, -1.7314403630523554, 1.748174663219766, -2.859865845375326, -2.2378756142166774, 1.1123242153260395, -0.41805426192795947, 0.4375114552523848]], NamedTuple[(n_steps = 3, is_accept = true, acceptance_rate = 0.3333333333333333, log_density = -1.6432671076705775e6, hamiltonian_energy = 1.7145868654221846e6, hamiltonian_energy_error = -2284.447895776946, max_hamiltonian_energy_error = 6835.574489502236, tree_depth = 1, numerical_error = true, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6432671076705775e6, hamiltonian_energy = 1.6433129149323532e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 6.401505377962993e6, tree_depth = 0, numerical_error = true, step_size = 0.006688484705987125, nom_step_size = 0.006688484705987125, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 9.467238433387715e-74, log_density = -1.6432671076705775e6, hamiltonian_energy = 1.6433130227109056e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1535.4549831186887, tree_depth = 1, numerical_error = true, step_size = 0.0007892360952396099, nom_step_size = 0.0007892360952396099, is_adapt = true), (n_steps = 31, is_accept = true, acceptance_rate = 0.6265046250963623, log_density = -1.637634760549984e6, hamiltonian_energy = 1.6433176192583272e6, hamiltonian_energy_error = 0.31336593022570014, max_hamiltonian_energy_error = 1.7828340900596231, tree_depth = 5, numerical_error = false, step_size = 6.340826005391609e-5, nom_step_size = 6.340826005391609e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9918052041179943, log_density = -1.63575508056218e6, hamiltonian_energy = 1.6376813374394649e6, hamiltonian_energy_error = 0.018817934673279524, max_hamiltonian_energy_error = 0.02755923173390329, tree_depth = 4, numerical_error = false, step_size = 2.5949815472218504e-5, nom_step_size = 2.5949815472218504e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9959094905354753, log_density = -1.635711590419676e6, hamiltonian_energy = 1.6358137416093848e6, hamiltonian_energy_error = 0.00030794134363532066, max_hamiltonian_energy_error = 0.009514323668554425, tree_depth = 3, numerical_error = false, step_size = 3.479964899265022e-5, nom_step_size = 3.479964899265022e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.958831976908821, log_density = -1.6344290977570855e6, hamiltonian_energy = 1.6357747685524456e6, hamiltonian_energy_error = 0.050450592301785946, max_hamiltonian_energy_error = 0.12388030393049121, tree_depth = 3, numerical_error = false, step_size = 5.3768565147049504e-5, nom_step_size = 5.3768565147049504e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.352941180892604, log_density = -1.6254762226066382e6, hamiltonian_energy = 1.6344806918408668e6, hamiltonian_energy_error = 1.1172115989029408, max_hamiltonian_energy_error = 5.223027522442862, tree_depth = 4, numerical_error = false, step_size = 8.023805969474912e-5, nom_step_size = 8.023805969474912e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.997121264231749, log_density = -1.6249727932346126e6, hamiltonian_energy = 1.6255205421628235e6, hamiltonian_energy_error = 0.004122376907616854, max_hamiltonian_energy_error = 0.009664106415584683, tree_depth = 4, numerical_error = false, step_size = 1.871148561527904e-5, nom_step_size = 1.871148561527904e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9923950865931782, log_density = -1.6237663344927102e6, hamiltonian_energy = 1.6250164407950973e6, hamiltonian_energy_error = 0.022560412297025323, max_hamiltonian_energy_error = 0.022560412297025323, tree_depth = 3, numerical_error = false, step_size = 3.375376350430896e-5, nom_step_size = 3.375376350430896e-5, is_adapt = true)  …  (n_steps = 15, is_accept = true, acceptance_rate = 0.49873786560324285, log_density = -97059.7907997376, hamiltonian_energy = 97732.99471663726, hamiltonian_energy_error = 0.4004511368111707, max_hamiltonian_energy_error = 1.416907334161806, tree_depth = 4, numerical_error = false, step_size = 5.58410711024798e-5, nom_step_size = 5.58410711024798e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.6988436512851302, log_density = -95764.67001223599, hamiltonian_energy = 97111.38018822674, hamiltonian_energy_error = 0.024385925964452326, max_hamiltonian_energy_error = 1.1349705286556855, tree_depth = 5, numerical_error = false, step_size = 5.58410711024798e-5, nom_step_size = 5.58410711024798e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.7119609547257972, log_density = -95142.30557365228, hamiltonian_energy = 95827.80129018432, hamiltonian_energy_error = 0.4158493405266199, max_hamiltonian_energy_error = 0.8452154637343483, tree_depth = 5, numerical_error = false, step_size = 5.58410711024798e-5, nom_step_size = 5.58410711024798e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.927496858302965, log_density = -94662.48088225174, hamiltonian_energy = 95186.05574310836, hamiltonian_energy_error = 0.09934605335001834, max_hamiltonian_energy_error = -0.6105239527823869, tree_depth = 5, numerical_error = false, step_size = 5.58410711024798e-5, nom_step_size = 5.58410711024798e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9561759726933081, log_density = -91973.32089839444, hamiltonian_energy = 94720.64876249219, hamiltonian_energy_error = 0.06545759296568576, max_hamiltonian_energy_error = -0.575339324423112, tree_depth = 5, numerical_error = false, step_size = 5.58410711024798e-5, nom_step_size = 5.58410711024798e-5, is_adapt = false), (n_steps = 63, is_accept = true, acceptance_rate = 0.9745320508713166, log_density = -84489.03959547821, hamiltonian_energy = 92030.34676372084, hamiltonian_energy_error = -0.2928922942955978, max_hamiltonian_energy_error = -1.1340049537975574, tree_depth = 6, numerical_error = false, step_size = 5.58410711024798e-5, nom_step_size = 5.58410711024798e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9965490906153734, log_density = -84291.14374043999, hamiltonian_energy = 84546.95788644423, hamiltonian_energy_error = -0.05964158580172807, max_hamiltonian_energy_error = -0.42969843042374123, tree_depth = 4, numerical_error = false, step_size = 5.58410711024798e-5, nom_step_size = 5.58410711024798e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9271905344923984, log_density = -84120.28490879986, hamiltonian_energy = 84348.02105468305, hamiltonian_energy_error = -0.19535569813160691, max_hamiltonian_energy_error = -0.4780191858881153, tree_depth = 5, numerical_error = false, step_size = 5.58410711024798e-5, nom_step_size = 5.58410711024798e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.8311448301518845, log_density = -83876.91894530316, hamiltonian_energy = 84177.07233017773, hamiltonian_energy_error = 0.14954911892709788, max_hamiltonian_energy_error = 0.36771104342187755, tree_depth = 4, numerical_error = false, step_size = 5.58410711024798e-5, nom_step_size = 5.58410711024798e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9319441699270956, log_density = -83721.23915785317, hamiltonian_energy = 83924.87802502766, hamiltonian_energy_error = -0.20719354994071182, max_hamiltonian_energy_error = 0.5109499706304632, tree_depth = 4, numerical_error = false, step_size = 5.58410711024798e-5, nom_step_size = 5.58410711024798e-5, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-4.06 ± 0.39, -4.06 ± 0.39, -4.06 ± 0.38, -4.06 ± 0.38, -4.06 ± 0.38, -4.06 ± 0.38, -4.06 ± 0.38, -4.06 ± 0.38, -4.06 ± 0.38, -4.06 ± 0.38  …  -4.05 ± 0.33, -4.05 ± 0.33, -4.05 ± 0.33, -4.05 ± 0.33, -4.05 ± 0.33, -4.05 ± 0.33, -4.05 ± 0.33, -4.05 ± 0.33, -4.05 ± 0.33, -4.05 ± 0.33]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.723 ± 0.081 -0.797 ± 0.076; -0.889 ± 0.23 0.0995 ± 0.39; … ; 0.709 ± 0.014 -0.855 ± 0.044; -0.39 ± 0.036 0.882 ± 0.33], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.694 ± 0.072; -0.259 ± 0.18; … ; -1.04 ± 0.055; -0.978 ± 0.079;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.267 ± 0.06 0.517 ± 0.025 … -0.0513 ± 0.054 0.564 ± 0.053; 0.708 ± 0.041 -0.294 ± 0.027 … 1.01 ± 0.038 0.0559 ± 0.028; … ; 0.925 ± 0.072 0.413 ± 0.038 … 0.71 ± 0.08 0.536 ± 0.11; -0.534 ± 0.059 0.463 ± 0.019 … -0.702 ± 0.058 -0.0687 ± 0.025], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.336 ± 0.036; -0.182 ± 0.024; … ; 0.679 ± 0.04; 0.304 ± 0.04;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-1.27 ± 0.26 -2.04 ± 0.31 … -2.02 ± 0.32 0.903 ± 0.26], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.609 ± 0.24;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.471 ± 0.025], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="81187ebd.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Monday 4 March 2024 20:33">Monday 4 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
