<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -4.224284143365092
 -4.449459863111031
 -3.668740614975545
 -3.896580335444223
 -3.9623447334055073
 -4.083267942077456
 -3.561055147678084
 -3.8907047935362318
 -3.735918687791363
 -3.861391018839769
  ⋮
 -3.9696136204578663
 -3.6908215770934216
 -3.753026292926282
 -3.914376704673297
 -4.3521167119615365
 -4.038639104232362
 -3.96528444671015
 -4.031367437019125
 -3.8357333578495036</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="cc812ff6.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[0.33014143966852916, -0.22201812295108167, -0.13122314198094115, 0.3137472984993566, -0.2386785657396224, -0.3227261899881051, 0.5485302152919156, -0.2928120399165497, -0.2035935071491614, 0.07081483963623045  …  0.7094940994463943, 0.5774732715313151, 0.6001376712793068, -0.6448065167999308, 0.34766897940297964, 0.3419401644013421, 0.4220076044126568, -0.40812690744748303, -0.1544665371916616, 0.5035082850995151], [0.33014143966852916, -0.22201812295108167, -0.13122314198094115, 0.3137472984993566, -0.2386785657396224, -0.3227261899881051, 0.5485302152919156, -0.2928120399165497, -0.2035935071491614, 0.07081483963623045  …  0.7094940994463943, 0.5774732715313151, 0.6001376712793068, -0.6448065167999308, 0.34766897940297964, 0.3419401644013421, 0.4220076044126568, -0.40812690744748303, -0.1544665371916616, 0.5035082850995151], [0.33014143966852916, -0.22201812295108167, -0.13122314198094115, 0.3137472984993566, -0.2386785657396224, -0.3227261899881051, 0.5485302152919156, -0.2928120399165497, -0.2035935071491614, 0.07081483963623045  …  0.7094940994463943, 0.5774732715313151, 0.6001376712793068, -0.6448065167999308, 0.34766897940297964, 0.3419401644013421, 0.4220076044126568, -0.40812690744748303, -0.1544665371916616, 0.5035082850995151], [0.330275942479406, -0.2204612912392322, -0.1266408206217766, 0.31433129212339955, -0.2450283706950762, -0.3227482638964221, 0.548855247630132, -0.2910180364246502, -0.20384914927223574, 0.0707556424866335  …  0.7073364946420861, 0.5780859560493554, 0.5970396003156598, -0.6498781178035111, 0.34528549148746535, 0.34189786964637753, 0.42402826912692126, -0.4098775066346176, -0.15977817175062647, 0.5034541855870035], [0.33007954041283843, -0.21268782096965952, -0.09856811200359175, 0.3196415333162689, -0.2793679588796445, -0.32147409614147443, 0.5500126732652342, -0.28180787583247174, -0.20444262105919186, 0.07327398693890295  …  0.6967517958519337, 0.5841486521385126, 0.5806285037591249, -0.6809302079260511, 0.3306248271808155, 0.3441550770833712, 0.4329022624878693, -0.4229692148163245, -0.1928149802096378, 0.5038607354238962], [0.3274680971906878, -0.20205691167121642, -0.061939127525458965, 0.3376226186861437, -0.32573668517129767, -0.3154408997532025, 0.5467850252344952, -0.2774921952051945, -0.21008437478870573, 0.0827343317055686  …  0.6922088033684441, 0.6056712830195806, 0.5617774241954381, -0.7371703608184303, 0.3186547975198315, 0.36039428937348983, 0.44760714225886, -0.45377536460757345, -0.2679830988435358, 0.5036119889431594], [0.3274680971906878, -0.20205691167121642, -0.061939127525458965, 0.3376226186861437, -0.32573668517129767, -0.3154408997532025, 0.5467850252344952, -0.2774921952051945, -0.21008437478870573, 0.0827343317055686  …  0.6922088033684441, 0.6056712830195806, 0.5617774241954381, -0.7371703608184303, 0.3186547975198315, 0.36039428937348983, 0.44760714225886, -0.45377536460757345, -0.2679830988435358, 0.5036119889431594], [0.3272337415697917, -0.2021140494502698, -0.06190011128781089, 0.3381342758099017, -0.3260399255955113, -0.3149130592782138, 0.5466724900881753, -0.27781811834163916, -0.21027396677810725, 0.08321947060974791  …  0.6922437008778841, 0.607026079368209, 0.5617842752728611, -0.738799925153171, 0.31884063407738417, 0.36110632546637816, 0.4479631326125542, -0.45496381752451565, -0.26980703125211736, 0.5037722302928911], [0.3273417554843799, -0.20215282969509243, -0.061754619358354, 0.3387447127767447, -0.32645607653325465, -0.3148496544687852, 0.5464580115486353, -0.2780696560759516, -0.21044419913720028, 0.08363601574640428  …  0.6926651144223702, 0.6081441685045218, 0.5618221321596188, -0.7397309867290991, 0.3192290238155746, 0.36143850013492207, 0.4479414332304887, -0.45581399515598475, -0.27091197355126095, 0.5039142913021358], [0.3269573749283549, -0.20183140893383533, -0.062118598499478324, 0.34021318779748033, -0.32825948629948315, -0.31464575082731816, 0.5462589240646885, -0.27918329587870905, -0.21062909624289128, 0.08410209776137677  …  0.6938182670011791, 0.6100303703265785, 0.5620553977027377, -0.7421920215216976, 0.3195259395763868, 0.36258770204258295, 0.4486954696950511, -0.4574073061278481, -0.2743062906403527, 0.504127922729898]  …  [0.5396518161952111, -0.08198392291012332, -0.13912640228571427, 0.9303388654556091, -0.7213403410033119, -0.7988450599062589, 0.6709476318518413, -0.5719738992449815, -0.543349866375377, 0.30797224662784783  …  1.9965367473772297, 2.211782952482871, 1.4738877262448793, -2.045063374217305, 1.4187318388115289, 0.9111574714684109, 1.1432367542510316, -1.8474304320828943, -0.43271850603218753, 0.4663171740964337], [0.5435412653269849, -0.07780838655405456, -0.13708229558850787, 0.9278939690402115, -0.7169656986969474, -0.7994328559793018, 0.6718495728813929, -0.5768443423814451, -0.5450862402949082, 0.31239521796773695  …  2.0020050560249136, 2.219438942861475, 1.4769951698220096, -2.053765490464725, 1.4275900996604243, 0.9150130096324735, 1.1493656217244757, -1.8533528333028526, -0.4249836061771322, 0.4651637281993338], [0.546017551333081, -0.07609188234849765, -0.1364683820126949, 0.9268270434256084, -0.7158328744275764, -0.8013464465600425, 0.669786226473968, -0.5778291942328931, -0.5459304878387269, 0.3156253021133219  …  2.003804378458952, 2.2230633667035606, 1.4793394732766407, -2.0599067939682536, 1.43152259519098, 0.9195385720233515, 1.1546070049446082, -1.8572021914041, -0.4202462324372147, 0.46506816171206394], [0.5481035828520274, -0.07206800972952855, -0.1364059405596891, 0.9250695688554451, -0.7139848225597345, -0.8014763807453014, 0.6702773669578135, -0.5794429999920674, -0.5486997043911485, 0.3197682011866359  …  2.01008858198192, 2.2314091260131623, 1.4852331155167686, -2.0679825594057735, 1.439500320316025, 0.9250447275619365, 1.1612372740202979, -1.8640480635361627, -0.411992973305988, 0.4653265611653854], [0.5494555162275533, -0.07124154141511653, -0.13604722897400018, 0.9229107642669178, -0.7148062963251225, -0.8012258554998946, 0.670576020155901, -0.5795329956070301, -0.5486599483467023, 0.32260667189023684  …  2.013538891825394, 2.234686851011364, 1.4877250824270978, -2.071749604299228, 1.4429309447510283, 0.9269217386604638, 1.1645642492883579, -1.8662832276233527, -0.40919934589989215, 0.4641549696742888], [0.5501146470395571, -0.06958336886341436, -0.1360096370596841, 0.921865140846996, -0.7142846092216716, -0.8013833826332116, 0.6715492328202011, -0.5802867529034089, -0.549111526773482, 0.32536386525863936  …  2.016335401603366, 2.2378718439343457, 1.4914357456348395, -2.0759999024250244, 1.4458629366325326, 0.9297849128216712, 1.1687274262379108, -1.8685933362375446, -0.4044857718098394, 0.4627950744499223], [0.5522478552680564, -0.06903657815982693, -0.13678982641920048, 0.9208784526235613, -0.7140987867384623, -0.8021825500237872, 0.671676985125576, -0.5811145642620364, -0.5509039460024271, 0.3277588882093074  …  2.0194464136792956, 2.2406751596393453, 1.494292188814028, -2.0809861400467957, 1.4485332167399345, 0.9323059003162104, 1.1714696569789391, -1.8717076672433648, -0.40140909591468504, 0.4616117116920132], [0.6263591363152275, -0.0030979041066060715, -0.15384818059583502, 0.8433174898023988, -0.6857844659702632, -0.8359635809938285, 0.6448673119628807, -0.6255857459224858, -0.6097051277686035, 0.4704710220376753  …  2.163746897475914, 2.4088814938030194, 1.6068659293598484, -2.3010729294431878, 1.630652501789357, 1.0797166739812885, 1.3420798221052876, -2.044437589891769, -0.22303127228511366, 0.44072955536166747], [0.6419767453109834, -0.0021108220403178446, -0.16130632008102289, 0.8265024062587296, -0.6849268367193458, -0.8314582452558288, 0.64867123694079, -0.6231556033633071, -0.6057093750451272, 0.48321653660713  …  2.17951677035579, 2.4271777818429525, 1.619539106389145, -2.319119762692247, 1.6439553157765028, 1.0938897945256676, 1.3557552712292058, -2.062897270477861, -0.21374012011446, 0.4419730640593204], [0.644771447171261, -0.0004694525283556579, -0.16545356084584212, 0.8194640673794397, -0.6861104870122314, -0.8291208357549663, 0.6505626638594284, -0.6229199749133298, -0.6062599541934749, 0.4882106517461982  …  2.181631895392764, 2.432136405246296, 1.622963677375194, -2.326157485324888, 1.6497273870156914, 1.0984674954313383, 1.3595708851750201, -2.067063662884377, -0.20753727284705029, 0.4415106681481433]], NamedTuple[(n_steps = 3, is_accept = true, acceptance_rate = 0.6666666666666666, log_density = -1.66560784939786e6, hamiltonian_energy = 1.797116739318275e6, hamiltonian_energy_error = -23289.927590809064, max_hamiltonian_energy_error = 27385.578100464074, tree_depth = 1, numerical_error = true, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.66560784939786e6, hamiltonian_energy = 1.665656077403936e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1.5005777117053566e48, tree_depth = 0, numerical_error = true, step_size = 0.012261299907089943, nom_step_size = 0.012261299907089943, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.66560784939786e6, hamiltonian_energy = 1.6656619326426531e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 4488.822070438415, tree_depth = 0, numerical_error = true, step_size = 0.001731493674964374, nom_step_size = 0.001731493674964374, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.657502406622906e6, hamiltonian_energy = 1.6656367500945413e6, hamiltonian_energy_error = -26.031700196675956, max_hamiltonian_energy_error = -26.031700196675956, tree_depth = 2, numerical_error = false, step_size = 0.00015413445733897217, nom_step_size = 0.00015413445733897217, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -1.6125716099896808e6, hamiltonian_energy = 1.6573557179875714e6, hamiltonian_energy_error = -194.78912714868784, max_hamiltonian_energy_error = -194.78912714868784, tree_depth = 3, numerical_error = false, step_size = 0.0001955224279177154, nom_step_size = 0.0001955224279177154, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -1.5349364356392336e6, hamiltonian_energy = 1.6124347296503407e6, hamiltonian_energy_error = -202.51919694640674, max_hamiltonian_energy_error = -202.51919694640674, tree_depth = 3, numerical_error = false, step_size = 0.00029335853051706134, nom_step_size = 0.00029335853051706134, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 2.8460920273547612e-33, log_density = -1.5349364356392336e6, hamiltonian_energy = 1.5349916014499697e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 280.58071848610416, tree_depth = 2, numerical_error = false, step_size = 0.0004861498966474869, nom_step_size = 0.0004861498966474869, is_adapt = true), (n_steps = 63, is_accept = true, acceptance_rate = 0.5094060631957718, log_density = -1.5329681828489157e6, hamiltonian_energy = 1.534990015539746e6, hamiltonian_energy_error = 0.07429341343231499, max_hamiltonian_energy_error = 2.54469399061054, tree_depth = 6, numerical_error = false, step_size = 3.804768261790023e-5, nom_step_size = 3.804768261790023e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9973705328897561, log_density = -1.5314381253680522e6, hamiltonian_energy = 1.533038686335302e6, hamiltonian_energy_error = 0.008610353106632829, max_hamiltonian_energy_error = 0.008610353106632829, tree_depth = 4, numerical_error = false, step_size = 1.4403890555884545e-5, nom_step_size = 1.4403890555884545e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9755418661585037, log_density = -1.5276086900007122e6, hamiltonian_energy = 1.531482286136104e6, hamiltonian_energy_error = 0.06995691987685859, max_hamiltonian_energy_error = 0.083976837573573, tree_depth = 4, numerical_error = false, step_size = 2.5970846492004442e-5, nom_step_size = 2.5970846492004442e-5, is_adapt = true)  …  (n_steps = 15, is_accept = true, acceptance_rate = 0.9993915601022941, log_density = -109784.58158157892, hamiltonian_energy = 112691.72152840169, hamiltonian_energy_error = -1.3329527985770255, max_hamiltonian_energy_error = -1.5056999257067218, tree_depth = 4, numerical_error = false, step_size = 8.768006154595456e-5, nom_step_size = 8.768006154595456e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9967477806464264, log_density = -107841.80071956849, hamiltonian_energy = 109836.21331881969, hamiltonian_energy_error = -0.13374850174295716, max_hamiltonian_energy_error = -0.30089616691111587, tree_depth = 4, numerical_error = false, step_size = 8.768006154595456e-5, nom_step_size = 8.768006154595456e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9972202589054301, log_density = -106590.10950534549, hamiltonian_energy = 107898.71983688278, hamiltonian_energy_error = -0.11621547846880276, max_hamiltonian_energy_error = -0.23443614717689343, tree_depth = 4, numerical_error = false, step_size = 8.768006154595456e-5, nom_step_size = 8.768006154595456e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9838906985901208, log_density = -104689.80942316477, hamiltonian_energy = 106629.53257158127, hamiltonian_energy_error = 0.01724484615260735, max_hamiltonian_energy_error = -0.10702209267765284, tree_depth = 4, numerical_error = false, step_size = 8.768006154595456e-5, nom_step_size = 8.768006154595456e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 1.0, log_density = -103854.28538646457, hamiltonian_energy = 104737.2943817797, hamiltonian_energy_error = -0.15626880299532786, max_hamiltonian_energy_error = -0.15626880299532786, tree_depth = 4, numerical_error = false, step_size = 8.768006154595456e-5, nom_step_size = 8.768006154595456e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9525075215559006, log_density = -102887.85054607368, hamiltonian_energy = 103912.02890987834, hamiltonian_energy_error = -0.06891743112646509, max_hamiltonian_energy_error = 0.14009843629901297, tree_depth = 4, numerical_error = false, step_size = 8.768006154595456e-5, nom_step_size = 8.768006154595456e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.945031449925555, log_density = -102070.11274242128, hamiltonian_energy = 102930.25019703296, hamiltonian_energy_error = 0.09552801695826929, max_hamiltonian_energy_error = 0.1622658190462971, tree_depth = 4, numerical_error = false, step_size = 8.768006154595456e-5, nom_step_size = 8.768006154595456e-5, is_adapt = false), (n_steps = 63, is_accept = true, acceptance_rate = 0.9942612484609845, log_density = -57660.37293253573, hamiltonian_energy = 102125.26641685946, hamiltonian_energy_error = -3.3663585820031585, max_hamiltonian_energy_error = -3.762936240513227, tree_depth = 6, numerical_error = false, step_size = 8.768006154595456e-5, nom_step_size = 8.768006154595456e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.8888441299437043, log_density = -53131.30233242683, hamiltonian_energy = 57716.06832569323, hamiltonian_energy_error = -0.48482083094859263, max_hamiltonian_energy_error = -0.7861366877405089, tree_depth = 5, numerical_error = false, step_size = 8.768006154595456e-5, nom_step_size = 8.768006154595456e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 1.0, log_density = -51885.25095298817, hamiltonian_energy = 53190.11694428241, hamiltonian_energy_error = -0.4229320995291346, max_hamiltonian_energy_error = -0.6298218449592241, tree_depth = 4, numerical_error = false, step_size = 8.768006154595456e-5, nom_step_size = 8.768006154595456e-5, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-3.88 ± 0.079, -3.88 ± 0.079, -3.88 ± 0.079, -3.88 ± 0.079, -3.88 ± 0.079, -3.88 ± 0.079, -3.88 ± 0.079, -3.88 ± 0.078, -3.88 ± 0.078, -3.88 ± 0.078  …  -4.14 ± 0.11, -4.14 ± 0.11, -4.14 ± 0.11, -4.14 ± 0.11, -4.14 ± 0.11, -4.14 ± 0.11, -4.14 ± 0.11, -4.13 ± 0.11, -4.13 ± 0.11, -4.13 ± 0.11]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.517 ± 0.05 -0.468 ± 0.08; -0.0689 ± 0.022 0.301 ± 0.06; … ; 0.58 ± 0.078 -0.284 ± 0.11; -0.561 ± 0.028 0.411 ± 0.079], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.256 ± 0.035; 0.271 ± 0.038; … ; 0.157 ± 0.03; -1.07 ± 0.025;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.123 ± 0.013 -0.377 ± 0.008 … -0.21 ± 0.011 -0.983 ± 0.045; -0.504 ± 0.013 0.107 ± 0.012 … 0.388 ± 0.0031 -0.944 ± 0.024; … ; -0.21 ± 0.011 0.299 ± 0.014 … -0.0766 ± 0.0054 -0.406 ± 0.041; 0.466 ± 0.013 0.26 ± 0.0049 … -0.394 ± 0.0034 0.529 ± 0.042], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.569 ± 0.016; -0.76 ± 0.019; … ; 0.0154 ± 0.0084; 0.51 ± 0.0047;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[1.85 ± 0.16 2.07 ± 0.18 … 1.02 ± 0.16 -1.71 ± 0.17], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.553 ± 0.16;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.486 ± 0.023], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="a9cda325.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Monday 4 March 2024 17:56">Monday 4 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
