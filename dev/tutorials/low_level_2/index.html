<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -4.168285153031082
 -4.046239257418726
 -4.455130221206817
 -3.850584306662129
 -3.9787061057384303
 -3.895398471907927
 -4.060253468375344
 -4.042456170396519
 -3.6206141070748563
 -3.5570032407308294
  ⋮
 -3.8161444553924055
 -4.15798778218064
 -3.9424703848063065
 -4.103873304293442
 -3.9100531722291128
 -3.9507056820453013
 -4.196568914646324
 -3.9409489060448304
 -4.070868020596935</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="7be36f4e.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[-0.17461408759393293, 0.257177011064939, 0.1424849683586361, -0.5118050551675274, 0.3678148950696393, 0.1635793079700656, 0.6841705257081695, 0.05148614365639434, 0.4837168799170171, 0.12443362942007663  …  0.14186626133653188, 0.17905968889716511, -0.6138968489706006, -0.3437507404611635, -0.7654524607363564, 0.2589534013102478, -0.6766118231274307, -0.5573225116269358, -0.18927201481073994, 0.4993163538251233], [-0.17461408759393293, 0.257177011064939, 0.1424849683586361, -0.5118050551675274, 0.3678148950696393, 0.1635793079700656, 0.6841705257081695, 0.05148614365639434, 0.4837168799170171, 0.12443362942007663  …  0.14186626133653188, 0.17905968889716511, -0.6138968489706006, -0.3437507404611635, -0.7654524607363564, 0.2589534013102478, -0.6766118231274307, -0.5573225116269358, -0.18927201481073994, 0.4993163538251233], [-0.17461408759393293, 0.257177011064939, 0.1424849683586361, -0.5118050551675274, 0.3678148950696393, 0.1635793079700656, 0.6841705257081695, 0.05148614365639434, 0.4837168799170171, 0.12443362942007663  …  0.14186626133653188, 0.17905968889716511, -0.6138968489706006, -0.3437507404611635, -0.7654524607363564, 0.2589534013102478, -0.6766118231274307, -0.5573225116269358, -0.18927201481073994, 0.4993163538251233], [-0.1742896706405285, 0.2625856265364503, 0.14520062388086288, -0.509112353943865, 0.365802055977689, 0.16947996707084179, 0.6819185202886744, 0.04160486841482546, 0.48297426517763054, 0.130126233639602  …  0.14690475241478598, 0.18215833764322428, -0.6164618120920229, -0.34399409071870957, -0.7754156266233575, 0.25428947285337133, -0.6830508016652951, -0.5580479471892499, -0.20922605875585734, 0.4986724751631659], [-0.17422160926644237, 0.2629542614791573, 0.14534456495010692, -0.5091637181393591, 0.3659609555406487, 0.17003820447198748, 0.6818044792335484, 0.04062705414692222, 0.4828687346330981, 0.13090425331079392  …  0.1476426213392669, 0.18192016206082157, -0.6167198394412563, -0.3441253463547101, -0.7760739931759676, 0.25387961409059173, -0.6839494308567208, -0.5583620348912173, -0.21099161321696253, 0.4986171067430624], [-0.17456253946662886, 0.2635311222220406, 0.1455287105482376, -0.5084819090352181, 0.3659750181497231, 0.1710489823733305, 0.6816987022109418, 0.03971633935425312, 0.4832064992080577, 0.13155740117204584  …  0.14797527381111428, 0.18212034549506492, -0.6171100235907456, -0.3443076048001517, -0.7775976790237663, 0.2531381380960666, -0.6847124572391017, -0.5584515821993355, -0.2143113846414146, 0.4986633897469496], [-0.17481189730544858, 0.26413835804538044, 0.14591246587267628, -0.5084469947581439, 0.3658066436377916, 0.17134187640374265, 0.6812251049776951, 0.03902840527461763, 0.483382257918864, 0.13203996130032644  …  0.14808034517096239, 0.18217645654289852, -0.6171696478443977, -0.34420217449207924, -0.7785155271894972, 0.2530807544385547, -0.6853392379090458, -0.5587209858321757, -0.21571900536851504, 0.4985229987704994], [-0.30682757087589807, 0.4706837130195814, 0.27677035866672955, -0.3941287995870278, 0.3833805044347196, 0.3871468940679279, 0.5687570474338105, 0.0470705417264225, 0.5094088064188029, 0.36666789026841323  …  0.4080848441352019, 0.339109382117531, -0.8775097620561884, -0.5040684194789982, -1.4588236158635834, 0.028317101278089438, -1.1139448016350717, -0.7683957428924885, -0.8516162376981822, 0.4920099975266152], [-0.30743050252034415, 0.47124610944975825, 0.2770614444519538, -0.395550900329034, 0.3840696214130005, 0.38717080661044806, 0.569333752711247, 0.04707258020799523, 0.5092688057656557, 0.36664469468597227  …  0.4083409403893094, 0.33932801327326456, -0.8783325752162281, -0.5044754995482125, -1.4600672978612343, 0.02808246863636502, -1.114602605963237, -0.7690608193476541, -0.8518947339961107, 0.491867274561952], [-0.30943791694691997, 0.47388529177540417, 0.28006445238005034, -0.40378542384580424, 0.38772310402512505, 0.38735716944569376, 0.5726211996020079, 0.04738214053716295, 0.5097579162116944, 0.36530756169789036  …  0.4116527274071937, 0.34196568184068055, -0.8828589672118556, -0.5086751694669105, -1.46751755375307, 0.0271188377430237, -1.1186839167453333, -0.77415166049583, -0.8548094231605321, 0.49183128630589473]  …  [-0.8066487169291577, 0.8364590156139533, 0.5243253780421382, -0.6346621423386504, 0.8216880421269209, 0.7536014476208092, 0.38666076684228107, -0.2666118640869901, 0.8131827356406679, -0.7049899991851658  …  1.4845904561712746, 1.2924058277550023, -2.1814235446508654, -1.813282130211991, -3.049562109904328, -0.722640505763116, -2.3629908226279555, -2.1073849279801973, -0.20294562722847778, 0.4372413104347936], [-0.8081373239288994, 0.8353271518725701, 0.5241818175326005, -0.6341275126834748, 0.8223391838459829, 0.7546681392530971, 0.3872810906149785, -0.26756805794868255, 0.8132548027942414, -0.7051594518751942  …  1.4837426326548178, 1.294097791134022, -2.1829260026789243, -1.814337390072505, -3.0508084815550034, -0.7228510140633919, -2.3643955854580967, -2.1079482766517157, -0.2016973573426805, 0.4375494226383758], [-0.8087353869959721, 0.8344508713758736, 0.5247677543510864, -0.6348742718085103, 0.8223567951049302, 0.7546081003890908, 0.38772571799663086, -0.2677249586579485, 0.8138032056976721, -0.7040599287608431  …  1.4847820829816594, 1.294989711005701, -2.1838234901048845, -1.8149199192832504, -3.0524773072381715, -0.7241801555503371, -2.3654122027555182, -2.1098382788647894, -0.20048194061634292, 0.4379202783359244], [-0.8092813114173087, 0.8320689434852047, 0.5261063272089143, -0.6335770812858593, 0.8239738271805706, 0.7554596768194647, 0.3882487746120337, -0.26728313860368114, 0.8165598913282823, -0.7046837796182331  …  1.4867768947515163, 1.2958390088303267, -2.1873345725950597, -1.817984373175494, -3.05734464021641, -0.7251195507875318, -2.3671468133083184, -2.110253800027402, -0.1992391998083416, 0.438389106599596], [-0.8101338410865487, 0.8317368936804566, 0.5261566734989943, -0.6349047857828518, 0.8244377738773925, 0.7556106914620406, 0.3876315204641364, -0.26811532973466407, 0.8182700001759464, -0.7044213385467591  …  1.4883404876688213, 1.2969710102075778, -2.188619045856448, -1.8195956179190296, -3.059392993451989, -0.7266780837571996, -2.3686510055128176, -2.1109215513197137, -0.19755661836193755, 0.4387272078912682], [-0.8136647939080652, 0.8282664003804727, 0.5273262523915487, -0.6348542460875191, 0.8243983454070769, 0.7542758233173426, 0.38989169329597384, -0.2707998069819418, 0.8200779183975364, -0.7024827658065871  …  1.490589385168935, 1.3003371962273964, -2.1910630766984887, -1.8207699822040688, -3.0602589790993986, -0.7279022675239296, -2.370664169564392, -2.1137042724642185, -0.1944687437804539, 0.43860735538131024], [-0.8192568405650917, 0.8248087711289055, 0.5274999354501125, -0.633929822833492, 0.8245913253951598, 0.7544426410775127, 0.3896890848610295, -0.2729281040132641, 0.8244144090647199, -0.7014672489494639  …  1.4947661220053514, 1.3051440442280613, -2.196249323631352, -1.8277399156183332, -3.0675099770899803, -0.7337905010230197, -2.377841540035449, -2.1207206830237637, -0.18942954567897802, 0.4426757649387007], [-0.8221681232996179, 0.8192289696410268, 0.5295930680659744, -0.6354158369911764, 0.8280180968188717, 0.7519226972495295, 0.39147962250709323, -0.2778813388775833, 0.8294050380360936, -0.6987838326550748  …  1.5015155687144177, 1.3100131339354633, -2.2058073337680435, -1.833188713395945, -3.077879732315835, -0.73833839046024, -2.3851071214959325, -2.126128258641226, -0.18559453176112017, 0.4478118514252169], [-0.8257473419573826, 0.8173753223585962, 0.529867130193111, -0.6353349877118775, 0.8291923102411819, 0.7511831099038232, 0.3926769746044846, -0.27968098533298336, 0.832472204143759, -0.6977594462502864  …  1.505013317325079, 1.315233940532534, -2.206842648178376, -1.8368265293534956, -3.081572297005266, -0.7406451142378669, -2.3897494703810875, -2.1300789713181203, -0.18233286150700226, 0.44912664707143196], [-0.844355551245613, 0.796663026783778, 0.5378123054106078, -0.6329569393759783, 0.838200477965729, 0.7450622936872076, 0.4003482157550526, -0.29102350652618253, 0.849456290501857, -0.6847534683395787  …  1.5267723412024816, 1.334084753615322, -2.2281506334821644, -1.8653972615834793, -3.113177734439018, -0.7565316136614775, -2.4108049934353275, -2.1498683396034566, -0.16206250412797454, 0.45726008337536905]], NamedTuple[(n_steps = 3, is_accept = true, acceptance_rate = 0.6666666666666666, log_density = -1.6139368408090735e6, hamiltonian_energy = 1.695757607098057e6, hamiltonian_energy_error = -4963.98861011141, max_hamiltonian_energy_error = 90962.15194611182, tree_depth = 1, numerical_error = true, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6139368408090735e6, hamiltonian_energy = 1.6139962801231379e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 7.199077196679106e20, tree_depth = 0, numerical_error = true, step_size = 0.012261299907089943, nom_step_size = 0.012261299907089943, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6139368408090735e6, hamiltonian_energy = 1.6139825015532346e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 36551.00830365205, tree_depth = 0, numerical_error = true, step_size = 0.001731493674964374, nom_step_size = 0.001731493674964374, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9973457134579091, log_density = -1.6011956809414597e6, hamiltonian_energy = 1.6139800096691523e6, hamiltonian_energy_error = -0.8203746879007667, max_hamiltonian_energy_error = -0.8203746879007667, tree_depth = 3, numerical_error = false, step_size = 0.00015413445733897217, nom_step_size = 0.00015413445733897217, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.4755824740741615, log_density = -1.600021405488627e6, hamiltonian_energy = 1.6012579370176517e6, hamiltonian_energy_error = 0.13549863919615746, max_hamiltonian_energy_error = 1.44534907117486, tree_depth = 2, numerical_error = false, step_size = 0.0001940452574764896, nom_step_size = 0.0001940452574764896, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9570237059378348, log_density = -1.5980733724926745e6, hamiltonian_energy = 1.6000775770826517e6, hamiltonian_energy_error = 0.12078894535079598, max_hamiltonian_energy_error = 0.12078894535079598, tree_depth = 3, numerical_error = false, step_size = 6.0944948860712026e-5, nom_step_size = 6.0944948860712026e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.9589466017473475, log_density = -1.5970806944580919e6, hamiltonian_energy = 1.5981215212113424e6, hamiltonian_energy_error = 0.07151495851576328, max_hamiltonian_energy_error = 0.07151495851576328, tree_depth = 2, numerical_error = false, step_size = 8.486894714174222e-5, nom_step_size = 8.486894714174222e-5, is_adapt = true), (n_steps = 45, is_accept = true, acceptance_rate = 0.4582003536908069, log_density = -837032.1507790945, hamiltonian_energy = 1.5968833978160974e6, hamiltonian_energy_error = -255.9497061735019, max_hamiltonian_energy_error = 6256.632394917076, tree_depth = 5, numerical_error = true, step_size = 0.00012765668805606335, nom_step_size = 0.00012765668805606335, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -835619.5180823434, hamiltonian_energy = 837084.4293118964, hamiltonian_energy_error = -0.30887053441256285, max_hamiltonian_energy_error = -0.5479852898279205, tree_depth = 3, numerical_error = false, step_size = 4.162764069483411e-5, nom_step_size = 4.162764069483411e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -827300.881173007, hamiltonian_energy = 835673.3548184943, hamiltonian_energy_error = -5.72204731812235, max_hamiltonian_energy_error = -5.72204731812235, tree_depth = 3, numerical_error = false, step_size = 7.607171175759333e-5, nom_step_size = 7.607171175759333e-5, is_adapt = true)  …  (n_steps = 15, is_accept = true, acceptance_rate = 0.9976453458709471, log_density = -27442.682150293756, hamiltonian_energy = 28416.797039429497, hamiltonian_energy_error = -0.13078853632032406, max_hamiltonian_energy_error = -0.1815393059332564, tree_depth = 4, numerical_error = false, step_size = 0.00012407038104342077, nom_step_size = 0.00012407038104342077, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9966048652812589, log_density = -27285.45224180918, hamiltonian_energy = 27508.95194965867, hamiltonian_energy_error = -0.022380600279575447, max_hamiltonian_energy_error = -0.23558957816203474, tree_depth = 4, numerical_error = false, step_size = 0.00012407038104342077, nom_step_size = 0.00012407038104342077, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9987875138850527, log_density = -27135.8267942818, hamiltonian_energy = 27342.158404565747, hamiltonian_energy_error = -0.02977409109371365, max_hamiltonian_energy_error = -0.22971969906211598, tree_depth = 4, numerical_error = false, step_size = 0.00012407038104342077, nom_step_size = 0.00012407038104342077, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9981560947943251, log_density = -26713.503338762428, hamiltonian_energy = 27195.779494694583, hamiltonian_energy_error = -0.03960159830239718, max_hamiltonian_energy_error = -0.27133985486943857, tree_depth = 4, numerical_error = false, step_size = 0.00012407038104342077, nom_step_size = 0.00012407038104342077, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.995558214418041, log_density = -26487.936784661724, hamiltonian_energy = 26760.028054670263, hamiltonian_energy_error = -0.0803172824671492, max_hamiltonian_energy_error = -0.203351719515922, tree_depth = 4, numerical_error = false, step_size = 0.00012407038104342077, nom_step_size = 0.00012407038104342077, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9997289406864527, log_density = -26109.27337137445, hamiltonian_energy = 26544.27877617651, hamiltonian_energy_error = -0.03938888439006405, max_hamiltonian_energy_error = -0.2786312058051408, tree_depth = 5, numerical_error = false, step_size = 0.00012407038104342077, nom_step_size = 0.00012407038104342077, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 1.0, log_density = -25268.90426318106, hamiltonian_energy = 26157.514945233863, hamiltonian_energy_error = -0.21156108225841308, max_hamiltonian_energy_error = -0.26391222979145823, tree_depth = 4, numerical_error = false, step_size = 0.00012407038104342077, nom_step_size = 0.00012407038104342077, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9848450465697589, log_density = -24275.71453554879, hamiltonian_energy = 25331.239599929213, hamiltonian_energy_error = -0.16239318796579028, max_hamiltonian_energy_error = -0.27019462285534246, tree_depth = 5, numerical_error = false, step_size = 0.00012407038104342077, nom_step_size = 0.00012407038104342077, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9459592710113881, log_density = -23850.212470617716, hamiltonian_energy = 24320.287093677765, hamiltonian_energy_error = 0.009917725445120595, max_hamiltonian_energy_error = 0.15668321285920683, tree_depth = 4, numerical_error = false, step_size = 0.00012407038104342077, nom_step_size = 0.00012407038104342077, is_adapt = false), (n_steps = 63, is_accept = true, acceptance_rate = 0.9895729572897636, log_density = -20985.55100592252, hamiltonian_energy = 23910.05859010796, hamiltonian_energy_error = -0.3178856753584114, max_hamiltonian_energy_error = -0.7087160654991749, tree_depth = 6, numerical_error = false, step_size = 0.00012407038104342077, nom_step_size = 0.00012407038104342077, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-4.03 ± 0.039, -4.03 ± 0.038, -4.03 ± 0.038, -4.03 ± 0.038, -4.03 ± 0.038, -4.03 ± 0.038, -4.03 ± 0.038, -4.02 ± 0.038, -4.02 ± 0.038, -4.02 ± 0.038  …  -3.91 ± 0.049, -3.91 ± 0.049, -3.91 ± 0.049, -3.91 ± 0.05, -3.91 ± 0.05, -3.9 ± 0.05, -3.9 ± 0.05, -3.9 ± 0.05, -3.9 ± 0.05, -3.9 ± 0.05]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.769 ± 0.044 0.748 ± 0.068; 0.825 ± 0.032 -0.673 ± 0.034; … ; 0.433 ± 0.052 -0.754 ± 0.29; -0.193 ± 0.074 0.0599 ± 0.038], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.0733 ± 0.013; 0.934 ± 0.034; … ; 0.902 ± 0.017; 0.347 ± 0.033;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.615 ± 0.03 0.787 ± 0.0037 … 0.262 ± 0.0066 0.0858 ± 0.0066; -0.13 ± 0.035 0.333 ± 0.04 … 0.953 ± 0.045 0.287 ± 0.0085; … ; -0.632 ± 0.037 0.13 ± 0.022 … -0.158 ± 0.013 0.51 ± 0.0082; 0.106 ± 0.016 -1.14 ± 0.021 … -0.282 ± 0.028 -0.217 ± 0.011], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.181 ± 0.008; -0.0143 ± 0.011; … ; -0.258 ± 0.015; 0.604 ± 0.01;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[1.4 ± 0.089 1.22 ± 0.081 … -2.25 ± 0.12 -2.03 ± 0.083], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.268 ± 0.077;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.436 ± 0.008], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="2aa8ff4d.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Saturday 23 March 2024 09:20">Saturday 23 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
