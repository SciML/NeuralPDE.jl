<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -3.8731958989275137
 -3.8252773500331507
 -4.465340892377002
 -4.0189430551824135
 -4.159228915181828
 -4.138322352436431
 -4.036947542729543
 -3.8504596304612355
 -3.536817395680464
 -3.6253847507611128
  ⋮
 -4.123452757810606
 -4.107697494563859
 -4.159854626653998
 -4.068476012072153
 -4.165746408995328
 -4.098134305084654
 -4.242535988674295
 -4.136724350284811
 -4.293749860570033</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="1339b791.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[0.10724938420256885, 0.02501680534134884, -0.11826601014725958, 0.26440789675374055, -0.5933191096349127, -0.3590561185152968, 0.6161376579510212, -0.6988271043551146, -0.5312304567625794, 0.33132091023167537  …  0.22456755715139215, 0.31145016321041824, -0.6970503238408968, -0.1417069711870411, -0.2937868402180852, 0.7753751331402193, -0.3902383055097737, 0.36078901111173106, -0.038305320775257744, 0.5009560015292573], [0.10724938420256885, 0.02501680534134884, -0.11826601014725958, 0.26440789675374055, -0.5933191096349127, -0.3590561185152968, 0.6161376579510212, -0.6988271043551146, -0.5312304567625794, 0.33132091023167537  …  0.22456755715139215, 0.31145016321041824, -0.6970503238408968, -0.1417069711870411, -0.2937868402180852, 0.7753751331402193, -0.3902383055097737, 0.36078901111173106, -0.038305320775257744, 0.5009560015292573], [0.10724938420256885, 0.02501680534134884, -0.11826601014725958, 0.26440789675374055, -0.5933191096349127, -0.3590561185152968, 0.6161376579510212, -0.6988271043551146, -0.5312304567625794, 0.33132091023167537  …  0.22456755715139215, 0.31145016321041824, -0.6970503238408968, -0.1417069711870411, -0.2937868402180852, 0.7753751331402193, -0.3902383055097737, 0.36078901111173106, -0.038305320775257744, 0.5009560015292573], [0.08205269156931715, 0.00940890937668709, -0.06777777530144721, 0.25591325136316884, -0.5926760676145608, -0.35862075945626626, 0.6156749340334703, -0.6979945866915817, -0.5301145844852797, 0.3259202365563446  …  0.22790273070995304, 0.3092077340324804, -0.6963205804465981, -0.13261870322318178, -0.2887518251009732, 0.767405590307994, -0.3923076271305588, 0.3585550907520591, -0.056341093069885176, 0.5008898066664272], [0.07837637864705495, 0.008231970315249465, -0.062071673372904014, 0.254917832423805, -0.592832834955805, -0.35850173481138525, 0.6154459090542579, -0.6978551096119764, -0.5303443923544394, 0.32527139014975964  …  0.22872569196989626, 0.30890641815267705, -0.6966360010422342, -0.13162341342307235, -0.28865125428545285, 0.7669376277206987, -0.39212754076993517, 0.357721766725562, -0.05839791802814276, 0.500720687572479], [0.03440449425432587, -0.0044878932184521875, 2.9250221337699667e-5, 0.2412868031937648, -0.5917656662612657, -0.35712190191601695, 0.6137938360081786, -0.6967926170492551, -0.5298778264250974, 0.31537996376364197  …  0.24288150289554813, 0.3035227965519392, -0.7000076079607181, -0.12326181690488106, -0.28797371197348465, 0.7627409757759677, -0.38707815524414935, 0.35064122195814224, -0.0865724541753645, 0.5014292063189523], [0.02691150953174845, 0.003833519431976144, -0.006981659586769912, 0.23567722379834213, -0.5915882771156816, -0.35726633279233366, 0.6131087638386583, -0.6953044146968439, -0.5299943454404429, 0.3115544857478205  …  0.2518768153911725, 0.3027837531596751, -0.7015014677751992, -0.12374950211036892, -0.2906361156502482, 0.7625064080142298, -0.3825419394683118, 0.3455944004393228, -0.09765634521266894, 0.5006957471090593], [0.0015514936766124789, 0.01991612117903802, -0.005477578621121703, 0.21746259300653015, -0.591925009611515, -0.3583053290137896, 0.6112253181247649, -0.6913181849459292, -0.5330938762637079, 0.29923175416865205  …  0.27767512988856174, 0.3013335646045496, -0.7091953715699378, -0.12098399314326934, -0.2977336002566715, 0.7651990896331237, -0.3712698604952067, 0.32996707017848775, -0.13041391641268088, 0.5003535870773694], [-0.024493555757140635, 0.04498453170472835, 0.014515594774396885, 0.14915365006095888, -0.5868582538195556, -0.3561470519830698, 0.6084860092862774, -0.6750468924178389, -0.5410882917994685, 0.2674032492837792  …  0.3498403475075025, 0.30436855079450437, -0.7435778704238606, -0.10103324683976024, -0.31339544165313477, 0.7850434736278757, -0.3534605919934012, 0.2921833301077633, -0.22179530130106953, 0.49935322766806134], [-0.024493555757140635, 0.04498453170472835, 0.014515594774396885, 0.14915365006095888, -0.5868582538195556, -0.3561470519830698, 0.6084860092862774, -0.6750468924178389, -0.5410882917994685, 0.2674032492837792  …  0.3498403475075025, 0.30436855079450437, -0.7435778704238606, -0.10103324683976024, -0.31339544165313477, 0.7850434736278757, -0.3534605919934012, 0.2921833301077633, -0.22179530130106953, 0.49935322766806134]  …  [-0.023580478624142334, 0.04081225703426714, 0.015244909564131876, 0.1446232314345032, -0.5858180051059191, -0.35634366770759046, 0.6086271342847004, -0.6744737089092929, -0.5411649396044812, 0.2665519252692261  …  0.35341193963884454, 0.30560649900719167, -0.7463783893220001, -0.0982435807453017, -0.3139080722087415, 0.7873066344572123, -0.3547104986143674, 0.29029668004728887, -0.22506973196620356, 0.49960793607588], [-0.023580478624142334, 0.04081225703426714, 0.015244909564131876, 0.1446232314345032, -0.5858180051059191, -0.35634366770759046, 0.6086271342847004, -0.6744737089092929, -0.5411649396044812, 0.2665519252692261  …  0.35341193963884454, 0.30560649900719167, -0.7463783893220001, -0.0982435807453017, -0.3139080722087415, 0.7873066344572123, -0.3547104986143674, 0.29029668004728887, -0.22506973196620356, 0.49960793607588], [-0.023580478624142334, 0.04081225703426714, 0.015244909564131876, 0.1446232314345032, -0.5858180051059191, -0.35634366770759046, 0.6086271342847004, -0.6744737089092929, -0.5411649396044812, 0.2665519252692261  …  0.35341193963884454, 0.30560649900719167, -0.7463783893220001, -0.0982435807453017, -0.3139080722087415, 0.7873066344572123, -0.3547104986143674, 0.29029668004728887, -0.22506973196620356, 0.49960793607588], [-0.023580478624142334, 0.04081225703426714, 0.015244909564131876, 0.1446232314345032, -0.5858180051059191, -0.35634366770759046, 0.6086271342847004, -0.6744737089092929, -0.5411649396044812, 0.2665519252692261  …  0.35341193963884454, 0.30560649900719167, -0.7463783893220001, -0.0982435807453017, -0.3139080722087415, 0.7873066344572123, -0.3547104986143674, 0.29029668004728887, -0.22506973196620356, 0.49960793607588], [-0.023580478624142334, 0.04081225703426714, 0.015244909564131876, 0.1446232314345032, -0.5858180051059191, -0.35634366770759046, 0.6086271342847004, -0.6744737089092929, -0.5411649396044812, 0.2665519252692261  …  0.35341193963884454, 0.30560649900719167, -0.7463783893220001, -0.0982435807453017, -0.3139080722087415, 0.7873066344572123, -0.3547104986143674, 0.29029668004728887, -0.22506973196620356, 0.49960793607588], [-0.023580478624142334, 0.04081225703426714, 0.015244909564131876, 0.1446232314345032, -0.5858180051059191, -0.35634366770759046, 0.6086271342847004, -0.6744737089092929, -0.5411649396044812, 0.2665519252692261  …  0.35341193963884454, 0.30560649900719167, -0.7463783893220001, -0.0982435807453017, -0.3139080722087415, 0.7873066344572123, -0.3547104986143674, 0.29029668004728887, -0.22506973196620356, 0.49960793607588], [-0.023580478624142334, 0.04081225703426714, 0.015244909564131876, 0.1446232314345032, -0.5858180051059191, -0.35634366770759046, 0.6086271342847004, -0.6744737089092929, -0.5411649396044812, 0.2665519252692261  …  0.35341193963884454, 0.30560649900719167, -0.7463783893220001, -0.0982435807453017, -0.3139080722087415, 0.7873066344572123, -0.3547104986143674, 0.29029668004728887, -0.22506973196620356, 0.49960793607588], [-0.023580478624142334, 0.04081225703426714, 0.015244909564131876, 0.1446232314345032, -0.5858180051059191, -0.35634366770759046, 0.6086271342847004, -0.6744737089092929, -0.5411649396044812, 0.2665519252692261  …  0.35341193963884454, 0.30560649900719167, -0.7463783893220001, -0.0982435807453017, -0.3139080722087415, 0.7873066344572123, -0.3547104986143674, 0.29029668004728887, -0.22506973196620356, 0.49960793607588], [-0.023580478624142334, 0.04081225703426714, 0.015244909564131876, 0.1446232314345032, -0.5858180051059191, -0.35634366770759046, 0.6086271342847004, -0.6744737089092929, -0.5411649396044812, 0.2665519252692261  …  0.35341193963884454, 0.30560649900719167, -0.7463783893220001, -0.0982435807453017, -0.3139080722087415, 0.7873066344572123, -0.3547104986143674, 0.29029668004728887, -0.22506973196620356, 0.49960793607588], [-0.023580478624142334, 0.04081225703426714, 0.015244909564131876, 0.1446232314345032, -0.5858180051059191, -0.35634366770759046, 0.6086271342847004, -0.6744737089092929, -0.5411649396044812, 0.2665519252692261  …  0.35341193963884454, 0.30560649900719167, -0.7463783893220001, -0.0982435807453017, -0.3139080722087415, 0.7873066344572123, -0.3547104986143674, 0.29029668004728887, -0.22506973196620356, 0.49960793607588]], NamedTuple[(n_steps = 1, is_accept = true, acceptance_rate = 1.0, log_density = -1.7660017516316494e6, hamiltonian_energy = 1.8275205486256573e6, hamiltonian_energy_error = -2066.9977025205735, max_hamiltonian_energy_error = -2066.9977025205735, tree_depth = 1, numerical_error = false, step_size = 0.00078125, nom_step_size = 0.00078125, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.7660017516316494e6, hamiltonian_energy = 1.7660560122733905e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 5.097770057070224e40, tree_depth = 0, numerical_error = true, step_size = 0.011238679762325607, nom_step_size = 0.011238679762325607, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.7660017516316494e6, hamiltonian_energy = 1.7660443893509277e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 247050.05155634508, tree_depth = 0, numerical_error = true, step_size = 0.0018993494877672993, nom_step_size = 0.0018993494877672993, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.6766140598861544, log_density = -1.7343423306710613e6, hamiltonian_energy = 1.7656465378026934e6, hamiltonian_energy_error = -412.9794991235249, max_hamiltonian_energy_error = -412.9794991235249, tree_depth = 2, numerical_error = false, step_size = 0.00018733703557689892, nom_step_size = 0.00018733703557689892, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.7309642003553924e6, hamiltonian_energy = 1.7343761827963768e6, hamiltonian_energy_error = -13.93956297589466, max_hamiltonian_energy_error = -13.93956297589466, tree_depth = 2, numerical_error = false, step_size = 0.00010057955803562483, nom_step_size = 0.00010057955803562483, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 1.0, log_density = -1.7011364352235121e6, hamiltonian_energy = 1.7306656238716736e6, hamiltonian_energy_error = -354.2129514524713, max_hamiltonian_energy_error = -354.2129514524713, tree_depth = 4, numerical_error = false, step_size = 0.00015109453954864166, nom_step_size = 0.00015109453954864166, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.6919093882460543e6, hamiltonian_energy = 1.7010817225207987e6, hamiltonian_energy_error = -101.23509123362601, max_hamiltonian_energy_error = -101.23509123362601, tree_depth = 2, numerical_error = false, step_size = 0.00025059231414395716, nom_step_size = 0.00025059231414395716, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.6675745116863751e6, hamiltonian_energy = 1.691578447816916e6, hamiltonian_energy_error = -368.7465367659461, max_hamiltonian_energy_error = -368.7465367659461, tree_depth = 2, numerical_error = false, step_size = 0.00044111443833129486, nom_step_size = 0.00044111443833129486, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.6079957249076618e6, hamiltonian_energy = 1.6665685336045048e6, hamiltonian_energy_error = -1066.616220013937, max_hamiltonian_energy_error = -1066.616220013937, tree_depth = 2, numerical_error = false, step_size = 0.0008044007667307767, nom_step_size = 0.0008044007667307767, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6079957249076618e6, hamiltonian_energy = 1.6080463309325082e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 19746.130488987546, tree_depth = 0, numerical_error = true, step_size = 0.001496198128230554, nom_step_size = 0.001496198128230554, is_adapt = true)  …  (n_steps = 6, is_accept = true, acceptance_rate = 3.610320112707323e-6, log_density = -1.6044698965732493e6, hamiltonian_energy = 1.6045200782960171e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1060.4142366328742, tree_depth = 2, numerical_error = true, step_size = 0.00039702166118940044, nom_step_size = 0.00039702166118940044, is_adapt = false), (n_steps = 6, is_accept = true, acceptance_rate = 6.593742393501275e-6, log_density = -1.6044698965732493e6, hamiltonian_energy = 1.6045171373187252e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1087.967594390735, tree_depth = 2, numerical_error = true, step_size = 0.00039702166118940044, nom_step_size = 0.00039702166118940044, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 6.232315028859059e-5, log_density = -1.6044698965732493e6, hamiltonian_energy = 1.604521954877138e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 33.8908751627896, tree_depth = 2, numerical_error = false, step_size = 0.00039702166118940044, nom_step_size = 0.00039702166118940044, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 4.889890762923629e-5, log_density = -1.6044698965732493e6, hamiltonian_energy = 1.6045192626828204e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 35.87701416295022, tree_depth = 2, numerical_error = false, step_size = 0.00039702166118940044, nom_step_size = 0.00039702166118940044, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 7.527971835875458e-5, log_density = -1.6044698965732493e6, hamiltonian_energy = 1.6045305668365676e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 41.156945863505825, tree_depth = 2, numerical_error = false, step_size = 0.00039702166118940044, nom_step_size = 0.00039702166118940044, is_adapt = false), (n_steps = 6, is_accept = true, acceptance_rate = 8.090248892086546e-6, log_density = -1.6044698965732493e6, hamiltonian_energy = 1.6045147128431208e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1098.6775361176115, tree_depth = 2, numerical_error = true, step_size = 0.00039702166118940044, nom_step_size = 0.00039702166118940044, is_adapt = false), (n_steps = 6, is_accept = true, acceptance_rate = 1.1184842353412147e-5, log_density = -1.6044698965732493e6, hamiltonian_energy = 1.6045397855732744e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1071.4845091504976, tree_depth = 2, numerical_error = true, step_size = 0.00039702166118940044, nom_step_size = 0.00039702166118940044, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 3.857271695351438e-5, log_density = -1.6044698965732493e6, hamiltonian_energy = 1.6045289000705855e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 38.726563568925485, tree_depth = 2, numerical_error = false, step_size = 0.00039702166118940044, nom_step_size = 0.00039702166118940044, is_adapt = false), (n_steps = 6, is_accept = true, acceptance_rate = 4.893762047190251e-6, log_density = -1.6044698965732493e6, hamiltonian_energy = 1.6045391314199406e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1076.946145251859, tree_depth = 2, numerical_error = true, step_size = 0.00039702166118940044, nom_step_size = 0.00039702166118940044, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 3.429874911442565e-5, log_density = -1.6044698965732493e6, hamiltonian_energy = 1.6045183574517008e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 36.42479060846381, tree_depth = 2, numerical_error = false, step_size = 0.00039702166118940044, nom_step_size = 0.00039702166118940044, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-0.713 ± 3.4e-16, -0.713 ± 2.3e-16, -0.713 ± 3.4e-16, -0.713 ± 4.5e-16, -0.713 ± 2.3e-16, -0.713 ± 3.4e-16, -0.713 ± 2.3e-16, -0.713 ± 4.5e-16, -0.713 ± 4.5e-16, -0.713 ± 4.5e-16  …  -0.808, -0.808 ± 2.3e-16, -0.808 ± 4.5e-16, -0.808 ± 2.3e-16, -0.808 ± 6.8e-16, -0.807, -0.807 ± 5.6e-16, -0.807 ± 3.4e-16, -0.807 ± 4.5e-16, -0.806 ± 4.5e-16]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.0236 -0.541; 0.0408 0.267; … ; 0.609 0.367; -0.674 0.325], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.0202; -0.147; … ; -0.125; 0.151;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.422 -0.0947 … 0.368 -0.536; -0.219 0.11 … 0.156 0.561; … ; -0.442 0.189 … -0.0363 -0.525; 0.229 0.0205 … 0.492 0.532], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.0351; -0.0742; … ; -0.114; -0.0352;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.353 0.306 … -0.355 0.29], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.225;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.5], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="709626a7.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 29 February 2024 12:07">Thursday 29 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
