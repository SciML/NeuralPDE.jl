<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -3.8008262265333133
 -4.050692760242026
 -3.6907678195122484
 -3.803865001540625
 -3.6389884798242003
 -4.135868674743277
 -4.093823505507464
 -4.05556982835171
 -3.912578650329721
 -3.9324349479977245
  ⋮
 -4.214816253062563
 -4.0062637351765105
 -4.038142338591275
 -3.9790655319284722
 -4.071190794115232
 -3.798269189488203
 -3.9456779956235932
 -4.149381257241209
 -4.087559623816835</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="e394f5c0.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2), NamedTuple())), bias = ViewAxis(17:24, ShapedAxis((8, 1), NamedTuple())))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8), NamedTuple())), bias = ViewAxis(65:72, ShapedAxis((8, 1), NamedTuple())))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8), NamedTuple())), bias = ViewAxis(9:9, ShapedAxis((1, 1), NamedTuple())))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[-0.2649486196077341, 0.35312719099550316, 0.6706726640550021, -0.15603425786599084, -0.47710710083302055, -0.24394694658860475, 0.3394709971252679, 0.5807206038739241, 0.5826550581831973, 0.275343389520396  …  0.4080172663498099, 0.4780274342891552, 0.6836658376373805, 0.07886535744371673, 0.35550317201938464, 0.5319569272872722, -0.41353427539008525, -0.15431716005959545, -0.1693494193010389, 0.4984293990188172], [-0.2649486196077341, 0.35312719099550316, 0.6706726640550021, -0.15603425786599084, -0.47710710083302055, -0.24394694658860475, 0.3394709971252679, 0.5807206038739241, 0.5826550581831973, 0.275343389520396  …  0.4080172663498099, 0.4780274342891552, 0.6836658376373805, 0.07886535744371673, 0.35550317201938464, 0.5319569272872722, -0.41353427539008525, -0.15431716005959545, -0.1693494193010389, 0.4984293990188172], [-0.2545387881722286, 0.35534863765396196, 0.6614744804386833, -0.39948766461526236, -0.4735918407331287, -0.18701303020290688, 0.3305276329519074, 0.5710918773268627, 0.5413155522075088, 0.2296123689599708  …  0.4061479537450264, 0.5333980104617407, 0.7440435505896786, 0.16839231105671879, 0.3306306899831175, 0.5106713901860818, -0.34823687349272686, -0.17075536381187487, -0.3402934491064382, 0.49783208779134486], [-0.2498587729742718, 0.3421139402797873, 0.642072447691018, -0.38016887927963755, -0.4767250687155054, -0.2030925468351414, 0.33624331573281735, 0.5687465726050901, 0.534907314072895, 0.2050278566140969  …  0.42796462875852365, 0.5135215224040094, 0.7900877827735194, 0.15359643251138133, 0.35174884883855656, 0.5245071048354664, -0.39215103069462376, -0.20216106795386174, -0.39433111475322946, 0.49793489371412103], [-0.2498587729742718, 0.3421139402797873, 0.642072447691018, -0.38016887927963755, -0.4767250687155054, -0.2030925468351414, 0.33624331573281735, 0.5687465726050901, 0.534907314072895, 0.2050278566140969  …  0.42796462875852365, 0.5135215224040094, 0.7900877827735194, 0.15359643251138133, 0.35174884883855656, 0.5245071048354664, -0.39215103069462376, -0.20216106795386174, -0.39433111475322946, 0.49793489371412103], [-0.24984898515064238, 0.3421852555803652, 0.6419833136034959, -0.3801917880855663, -0.4766968050809135, -0.2030317096023235, 0.3361422983046848, 0.5686888379643159, 0.5348608380114646, 0.20487910055073838  …  0.4279955076024043, 0.5136534242131059, 0.7903584914738288, 0.15366774279741785, 0.3517993748985184, 0.5246221007385786, -0.39225293619945595, -0.20226825018645586, -0.3944520173004256, 0.49786806137703515], [-0.24986842136460874, 0.3421194938126626, 0.6413190585838641, -0.3798976217784901, -0.4765448194177388, -0.20332945309194025, 0.33629438399580214, 0.5686514699319035, 0.5345424611280549, 0.20466852895261517  …  0.4286113244080148, 0.513932026348068, 0.7918095675787229, 0.15388155308390886, 0.35217107855777136, 0.525151622119005, -0.3930319200501597, -0.20275897202993245, -0.39546088135469093, 0.49789791997317], [-0.2500790024696715, 0.34205662200659753, 0.6403256387032326, -0.37986929536775627, -0.4764194060663995, -0.20337689476683576, 0.33676595442981294, 0.5683100223702594, 0.5337937766736173, 0.2034064368282787  …  0.43031883615026933, 0.5143857214600095, 0.7948938360976247, 0.15448230858506184, 0.3532400709893408, 0.5262851257152091, -0.394644072926285, -0.20363209990046222, -0.39819585241770244, 0.49763438501820817], [-0.25003795599135353, 0.34187906275596464, 0.6399685371506494, -0.3798923584573416, -0.47669224760211487, -0.2032469956482514, 0.3369012600593692, 0.5682330687224878, 0.5338896675605477, 0.20285253058881156  …  0.43099639461160655, 0.514358468102075, 0.7958577592940765, 0.1545546944112851, 0.35323094351546735, 0.5266683549685471, -0.39472364247729824, -0.20379218076463285, -0.3990603886888285, 0.49767011910612496], [-0.25000802308456893, 0.34180430783820537, 0.6392315006350369, -0.37982464485965306, -0.4767779996400673, -0.20324797288358487, 0.337102405408699, 0.5680914799720186, 0.5338481960411625, 0.20244337113054925  …  0.431840906289688, 0.5142824504601746, 0.7975389238034802, 0.15475205080727034, 0.3536168354685971, 0.5271451270906309, -0.39534108277398783, -0.20446850367962485, -0.4001692269932811, 0.49741628700838897]  …  [-0.38206904084890186, 0.9108395298038868, 0.6753005827751545, -0.8836009464019758, -0.047163861163902566, -0.41853946603693587, 0.4288600889902156, 0.96781770628876, 1.0670723129650066, -0.269457084542803  …  2.2623375890314943, 2.0741376864737804, 3.2724134705450627, 1.4105468958978669, 1.480294050581494, 2.2025341171773216, -1.9745249723140303, -0.9266442435841914, -0.15606639229837477, 0.4178742251739571], [-0.38711536351407216, 0.9101435301192424, 0.6764270376299014, -0.8845946520310645, -0.04854622292129969, -0.4179816429587546, 0.4269064539290762, 0.9707864392101309, 1.0708857566771, -0.27313622876708127  …  2.265545618018999, 2.0774730346391967, 3.2747847705758084, 1.418027522620558, 1.4823977431213002, 2.2052665473349995, -1.9757337228293113, -0.9303365658691317, -0.15061484034075945, 0.41799229915821196], [-0.38717124758176064, 0.910348936420832, 0.6767949420350685, -0.8847472787320275, -0.04861307552205009, -0.4177157213454713, 0.42635158918421084, 0.9715424237590744, 1.070972288867614, -0.273003722433092  …  2.2662775901955157, 2.0771376602226796, 3.2748464992285977, 1.4183982798934207, 1.4830922499907673, 2.2056332419916584, -1.9759332421464737, -0.9306961013177989, -0.1503210796968955, 0.4178035269651962], [-0.3949047239966854, 0.9044319474598497, 0.6776739395315486, -0.8866474284512318, -0.048271100005056716, -0.4163196148296635, 0.4243474074202695, 0.9755479635343485, 1.0856687407163168, -0.2713745261931982  …  2.277576805915565, 2.0889847695139934, 3.2833094863219086, 1.4380625700223764, 1.4921000433743352, 2.213700358432436, -1.9889162127264475, -0.9372745097573533, -0.13936598261903507, 0.42043641983174684], [-0.3983592892768078, 0.9021440955416384, 0.6762818898388548, -0.8879751810198555, -0.049581662073582694, -0.41519909195906857, 0.4188577266388988, 0.976400560140501, 1.0952543847402807, -0.2709347454157613  …  2.2838991814474148, 2.092674011136043, 3.285116155326634, 1.4427155633558693, 1.4963288607894525, 2.219388690264664, -1.9944857757906862, -0.9412739077790786, -0.13417101434486023, 0.4215465804171715], [-0.4022977650682794, 0.9000404417670872, 0.6768414312241487, -0.8869980615007269, -0.049820959661306195, -0.4102664254223773, 0.42108599900953697, 0.9817408643182628, 1.110127776328288, -0.2697986208158164  …  2.2911131615954923, 2.102706887395821, 3.2964464944324017, 1.453750823950678, 1.5042501855303638, 2.2270468764380302, -2.002269328829421, -0.9463963897138312, -0.11958801987716845, 0.42448162277559054], [-0.40231675669439126, 0.8999523956308316, 0.6762857041425531, -0.8908250472787649, -0.05058631269379509, -0.4038306470608261, 0.4219898425085494, 0.9864083825894462, 1.1171343502792628, -0.26937131436419653  …  2.296003477404292, 2.1060137923047133, 3.301336487785553, 1.4579882294017155, 1.511568846101962, 2.229108379509362, -2.0077671008120874, -0.949156625302593, -0.11683013879771773, 0.42624636672008565], [-0.404535670839175, 0.8968424908118177, 0.674261677958663, -0.8898069127430965, -0.05018195114630146, -0.39741978689783847, 0.4258936862592708, 0.9891944704530046, 1.1289346794846142, -0.2716127542822362  …  2.3005384432663867, 2.1163152849848625, 3.3084243866310636, 1.4650106432365237, 1.5185527615565289, 2.2318637196145965, -2.014476958145821, -0.9534109289533814, -0.10739324995461431, 0.4288412077956914], [-0.4051327843090494, 0.8939527839874388, 0.6764588363408661, -0.889226436387454, -0.05151347379067155, -0.39679658661293726, 0.42516457259310425, 0.9905285288334732, 1.1307793940234456, -0.27032668002343424  …  2.3011909050806745, 2.116889898894235, 3.3100909903647118, 1.4681576965053034, 1.5185122964322084, 2.2354859197150394, -2.0182870917049947, -0.955155371128882, -0.10522638420028009, 0.4298964802181573], [-0.4064086778048568, 0.891802514596984, 0.6728054041640833, -0.8902116598465502, -0.051573162192694706, -0.39123574218440954, 0.4262010298960047, 0.9932789889442956, 1.143698754955388, -0.2702530732516719  …  2.30806233260705, 2.123257771729546, 3.3165761845373933, 1.4756876951618314, 1.5247239918894961, 2.2429549617090982, -2.0271975576059225, -0.9608016369465786, -0.09796898093135537, 0.43162429252510276]], NamedTuple[(n_steps = 3, is_accept = true, acceptance_rate = 0.6666666666666666, log_density = -1.6676111858243113e6, hamiltonian_energy = 1.7717251784926434e6, hamiltonian_energy_error = -37707.95548980334, max_hamiltonian_energy_error = -37707.95548980334, tree_depth = 1, numerical_error = true, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6676111858243113e6, hamiltonian_energy = 1.6676610230694043e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 6.3133515510855806e32, tree_depth = 0, numerical_error = true, step_size = 0.012261299907089943, nom_step_size = 0.012261299907089943, is_adapt = true), (n_steps = 2, is_accept = true, acceptance_rate = 0.5, log_density = -1.5753808266106094e6, hamiltonian_energy = 1.666709886299598e6, hamiltonian_energy_error = -949.8368401352782, max_hamiltonian_energy_error = 26537.162183473818, tree_depth = 1, numerical_error = true, step_size = 0.001731493674964374, nom_step_size = 0.001731493674964374, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.5135694451157546e6, hamiltonian_energy = 1.574382802035146e6, hamiltonian_energy_error = -1045.1821249374188, max_hamiltonian_energy_error = -1045.1821249374188, tree_depth = 2, numerical_error = false, step_size = 0.0005841583516390621, nom_step_size = 0.0005841583516390621, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 7.041052283595178e-272, log_density = -1.5135694451157546e6, hamiltonian_energy = 1.5136202002713045e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 624.3513876632787, tree_depth = 1, numerical_error = false, step_size = 0.0008158630599756176, nom_step_size = 0.0008158630599756176, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.9364393849074935, log_density = -1.5133632523851788e6, hamiltonian_energy = 1.5136114582858714e6, hamiltonian_energy_error = 0.047481991816312075, max_hamiltonian_energy_error = 0.14906530687585473, tree_depth = 2, numerical_error = false, step_size = 6.606793491950245e-5, nom_step_size = 6.606793491950245e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.3735873661808436, log_density = -1.5121420829823562e6, hamiltonian_energy = 1.5134045950764045e6, hamiltonian_energy_error = 0.3241430225316435, max_hamiltonian_energy_error = 3.9403251609764993, tree_depth = 3, numerical_error = false, step_size = 8.657162214671619e-5, nom_step_size = 8.657162214671619e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9832284177058168, log_density = -1.5093888682316279e6, hamiltonian_energy = 1.5122063603801369e6, hamiltonian_energy_error = 0.044002415146678686, max_hamiltonian_energy_error = 0.05133278644643724, tree_depth = 4, numerical_error = false, step_size = 2.106304770030016e-5, nom_step_size = 2.106304770030016e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9809521680519693, log_density = -1.5084963901004372e6, hamiltonian_energy = 1.5094392425283573e6, hamiltonian_energy_error = 0.036430912325158715, max_hamiltonian_energy_error = 0.0566565350163728, tree_depth = 3, numerical_error = false, step_size = 3.514737814222723e-5, nom_step_size = 3.514737814222723e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.6784487887650279, log_density = -1.5071073144994455e6, hamiltonian_energy = 1.5085377247262734e6, hamiltonian_energy_error = 0.16288622422143817, max_hamiltonian_energy_error = 1.2366543856915087, tree_depth = 4, numerical_error = false, step_size = 6.04304277541842e-5, nom_step_size = 6.04304277541842e-5, is_adapt = true)  …  (n_steps = 31, is_accept = true, acceptance_rate = 0.9911946660044846, log_density = -15870.072721494696, hamiltonian_energy = 16479.279861303607, hamiltonian_energy_error = -0.13682865984810633, max_hamiltonian_energy_error = -0.13682865984810633, tree_depth = 5, numerical_error = false, step_size = 9.123201803727984e-5, nom_step_size = 9.123201803727984e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9937655043012465, log_density = -15399.54809745281, hamiltonian_energy = 15920.601158187432, hamiltonian_energy_error = -0.029782208110191277, max_hamiltonian_energy_error = -0.0968214184158569, tree_depth = 5, numerical_error = false, step_size = 9.123201803727984e-5, nom_step_size = 9.123201803727984e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9993405190675694, log_density = -15368.661323529115, hamiltonian_energy = 15446.656831384356, hamiltonian_energy_error = -0.043826228746183915, max_hamiltonian_energy_error = -0.1145528050383291, tree_depth = 5, numerical_error = false, step_size = 9.123201803727984e-5, nom_step_size = 9.123201803727984e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9903946910900243, log_density = -14377.924707193095, hamiltonian_energy = 15415.119022977513, hamiltonian_energy_error = -0.05277570309590374, max_hamiltonian_energy_error = -0.06882607553416165, tree_depth = 5, numerical_error = false, step_size = 9.123201803727984e-5, nom_step_size = 9.123201803727984e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9936772472024958, log_density = -13920.112368552751, hamiltonian_energy = 14430.00043274762, hamiltonian_energy_error = -0.029055853145109722, max_hamiltonian_energy_error = -0.053113616560949595, tree_depth = 5, numerical_error = false, step_size = 9.123201803727984e-5, nom_step_size = 9.123201803727984e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.980138858014834, log_density = -13125.966841155701, hamiltonian_energy = 13973.43987262769, hamiltonian_energy_error = -0.003657181803646381, max_hamiltonian_energy_error = 0.07065671654709149, tree_depth = 5, numerical_error = false, step_size = 9.123201803727984e-5, nom_step_size = 9.123201803727984e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9951992677811454, log_density = -12728.286828915787, hamiltonian_energy = 13178.658990400076, hamiltonian_energy_error = -0.0029393245658866363, max_hamiltonian_energy_error = -0.055103182237871806, tree_depth = 5, numerical_error = false, step_size = 9.123201803727984e-5, nom_step_size = 9.123201803727984e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9921737576311834, log_density = -12179.03755247297, hamiltonian_energy = 12776.253198124035, hamiltonian_energy_error = 0.007931659685709747, max_hamiltonian_energy_error = -0.05745864040727611, tree_depth = 5, numerical_error = false, step_size = 9.123201803727984e-5, nom_step_size = 9.123201803727984e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9894712196850034, log_density = -12018.335572887077, hamiltonian_energy = 12231.252059034245, hamiltonian_energy_error = -0.010255588869767962, max_hamiltonian_energy_error = -0.07851988509537478, tree_depth = 5, numerical_error = false, step_size = 9.123201803727984e-5, nom_step_size = 9.123201803727984e-5, is_adapt = false), (n_steps = 63, is_accept = true, acceptance_rate = 0.9997969018253731, log_density = -11455.628946046407, hamiltonian_energy = 12066.512381284443, hamiltonian_energy_error = -0.06856142225296935, max_hamiltonian_energy_error = -0.09343202895615832, tree_depth = 6, numerical_error = false, step_size = 9.123201803727984e-5, nom_step_size = 9.123201803727984e-5, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-3.95 ± 0.031, -3.95 ± 0.031, -3.95 ± 0.031, -3.95 ± 0.031, -3.95 ± 0.031, -3.95 ± 0.031, -3.95 ± 0.03, -3.95 ± 0.03, -3.95 ± 0.03, -3.95 ± 0.03  …  -4.14 ± 0.065, -4.13 ± 0.065, -4.13 ± 0.065, -4.13 ± 0.065, -4.13 ± 0.065, -4.13 ± 0.065, -4.13 ± 0.065, -4.13 ± 0.065, -4.13 ± 0.065, -4.13 ± 0.065]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2), NamedTuple())), bias = ViewAxis(17:24, ShapedAxis((8, 1), NamedTuple())))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8), NamedTuple())), bias = ViewAxis(65:72, ShapedAxis((8, 1), NamedTuple())))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8), NamedTuple())), bias = ViewAxis(9:9, ShapedAxis((1, 1), NamedTuple())))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.356 ± 0.042 0.953 ± 0.18; 0.881 ± 0.047 -0.238 ± 0.051; … ; 0.454 ± 0.036 -0.628 ± 0.13; 1.02 ± 0.09 -0.738 ± 0.23], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.578 ± 0.075; -0.746 ± 0.078; … ; 0.804 ± 0.024; 0.239 ± 0.022;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.598 ± 0.061 -0.387 ± 0.042 … 0.409 ± 0.039 0.622 ± 0.0077; 0.0927 ± 0.036 -0.297 ± 0.069 … 0.00735 ± 0.011 -0.344 ± 0.013; … ; 0.85 ± 0.077 0.431 ± 0.018 … -0.511 ± 0.042 -0.564 ± 0.018; -0.225 ± 0.014 -0.24 ± 0.04 … 0.0146 ± 0.011 -0.724 ± 0.035], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.524 ± 0.014; 0.439 ± 0.016; … ; -0.51 ± 0.035; -0.0461 ± 0.054;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[2.19 ± 0.12 1.97 ± 0.16 … -1.89 ± 0.14 -0.879 ± 0.082], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.247 ± 0.15;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.421 ± 0.018], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="e2421799.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Sunday 18 February 2024 18:02">Sunday 18 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
