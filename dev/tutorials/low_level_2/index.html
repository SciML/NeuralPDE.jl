<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -4.093088975403634
 -4.2088500086717655
 -3.9081641663355873
 -3.752961170856737
 -4.245035990024448
 -4.0051777597576965
 -3.6910394633200982
 -4.0223039902453
 -3.7622815334013833
 -3.768647367429038
  ⋮
 -3.9864005267818525
 -3.716324882067587
 -3.9445195255822294
 -3.97093154736181
 -3.9157394524918963
 -3.989538732916271
 -3.736068988510859
 -3.9267068513043792
 -3.7082915441738287</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="5829bcf6.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[-0.12743715876003547, -0.2682110676148574, 0.6922825341832444, -0.3902035122112756, -0.15461054255662632, 0.472698983604347, -0.553013750892237, -0.7127584190971422, -0.2465649536772597, -0.6165323034367176  …  0.21442823053023446, 0.7287114490275588, -0.3238284713835651, -0.15344193543404028, 0.6835359932492348, -0.41622725027431046, -0.14777893949338466, 0.7800414828881481, -0.16472861885240084, 0.49758022248498546], [-0.12743715876003547, -0.2682110676148574, 0.6922825341832444, -0.3902035122112756, -0.15461054255662632, 0.472698983604347, -0.553013750892237, -0.7127584190971422, -0.2465649536772597, -0.6165323034367176  …  0.21442823053023446, 0.7287114490275588, -0.3238284713835651, -0.15344193543404028, 0.6835359932492348, -0.41622725027431046, -0.14777893949338466, 0.7800414828881481, -0.16472861885240084, 0.49758022248498546], [-0.039031064824740114, -0.19407095826962614, 0.6312521835057827, -0.38846632992817504, -0.17211219453557955, 0.46966278568639147, -0.5491798140625064, -0.6985046050848616, -0.2342358251008432, -0.5835498423180651  …  0.19098214168105257, 0.7233653319892068, -0.4660860883653043, -0.23120574539889388, 0.7819162656718486, -0.5201960738875804, -0.1012099962657153, 0.7561712418017642, -0.3239954211484709, 0.4994906716516021], [-0.03648618702262205, -0.19176964464887566, 0.6191058389043982, -0.3812835386379434, -0.17421846510841188, 0.4627436486710479, -0.541539057134238, -0.6881974005081913, -0.23555916609097077, -0.5787072088314091  …  0.17749775479686847, 0.7557420707927931, -0.4797003878440895, -0.22492001992092045, 0.8174527613110159, -0.5175207554981659, -0.10068769358799336, 0.7869933786785737, -0.3627910605578335, 0.5000742281292603], [-0.055864738677171476, -0.0992407492611172, 0.7539193057849695, -0.36704882782344506, -0.1450572116406179, 0.35870384549460466, -0.45314391728201786, -0.5349928388241881, -0.25751551531301003, -0.5173070527437061  …  0.03972041111062957, 1.3744305602242437, -0.8932437892987307, -0.3509942376139085, 1.5896125686511964, -0.7503047965074938, -0.09943740498133555, 1.363957081258057, -0.876044085869017, 0.5024911560881095], [-0.053328678333865655, -0.0997872076900413, 0.7684138467846625, -0.37630187742776766, -0.14939228958170775, 0.3611175606636694, -0.4577200413036378, -0.539499551231477, -0.2583766129914242, -0.5192456259584471  …  0.03984295237623284, 1.3888244451821747, -0.8989366580216066, -0.35455188169219215, 1.6062067129452837, -0.7556851037163763, -0.10092353902819598, 1.3774690938857947, -0.8793548913769782, 0.502260203198675], [-0.04817149988482668, -0.10301145163215167, 0.7946544838553588, -0.39881691473983644, -0.1592300601364238, 0.36447776486735484, -0.4683164635701337, -0.5492231458522066, -0.26041547180636887, -0.5215939016321703  …  0.03935117958268489, 1.4287543793575959, -0.914236215196986, -0.3649022313736254, 1.6499514349188782, -0.7685367226000522, -0.10267438947225763, 1.4169057006242047, -0.8870066473026423, 0.5011703454278406], [-0.04646178312965715, -0.1067710748927723, 0.8026148939914429, -0.4088769003549601, -0.16309014757269974, 0.3655803147941323, -0.4711267240787825, -0.553251133949703, -0.2609677294403691, -0.5222145727979315  …  0.03678696677193962, 1.4576358103891307, -0.9267339719287728, -0.3727649683504867, 1.6819892087153556, -0.7789920262588481, -0.10515759703941473, 1.4445273256915707, -0.8890545649760534, 0.5007256778419492], [-0.039462811271102696, -0.11819107132867313, 0.8109694066321134, -0.43548705837151946, -0.17349179825520006, 0.36776057194544975, -0.48171712158797125, -0.5720051773594873, -0.26524547194804654, -0.526843582994847  …  0.02961361413434285, 1.5509587198757768, -0.9640800283245567, -0.3949450824825515, 1.7833959596697464, -0.8111106896495552, -0.11098109161740664, 1.5387240119627779, -0.8889388080240911, 0.5028887555263546], [-0.039462811271102696, -0.11819107132867313, 0.8109694066321134, -0.43548705837151946, -0.17349179825520006, 0.36776057194544975, -0.48171712158797125, -0.5720051773594873, -0.26524547194804654, -0.526843582994847  …  0.02961361413434285, 1.5509587198757768, -0.9640800283245567, -0.3949450824825515, 1.7833959596697464, -0.8111106896495552, -0.11098109161740664, 1.5387240119627779, -0.8889388080240911, 0.5028887555263546]  …  [-0.02815289424043465, -0.1328285260749831, 0.7364974152923421, -0.48894033800497755, -0.1380062660645564, 0.3467285143789984, -0.5226698617329454, -0.728073809102193, -0.3087026377742434, -0.5920453487964461  …  -0.05135275925449768, 2.026369963787886, -1.2397746716354687, -0.5964335020662976, 2.2389617253615226, -1.0298509799095896, -0.16185894167387574, 2.0125368030110917, -0.7317536032752685, 0.5074049121314406], [-0.02815289424043465, -0.1328285260749831, 0.7364974152923421, -0.48894033800497755, -0.1380062660645564, 0.3467285143789984, -0.5226698617329454, -0.728073809102193, -0.3087026377742434, -0.5920453487964461  …  -0.05135275925449768, 2.026369963787886, -1.2397746716354687, -0.5964335020662976, 2.2389617253615226, -1.0298509799095896, -0.16185894167387574, 2.0125368030110917, -0.7317536032752685, 0.5074049121314406], [-0.02815289424043465, -0.1328285260749831, 0.7364974152923421, -0.48894033800497755, -0.1380062660645564, 0.3467285143789984, -0.5226698617329454, -0.728073809102193, -0.3087026377742434, -0.5920453487964461  …  -0.05135275925449768, 2.026369963787886, -1.2397746716354687, -0.5964335020662976, 2.2389617253615226, -1.0298509799095896, -0.16185894167387574, 2.0125368030110917, -0.7317536032752685, 0.5074049121314406], [-0.02815289424043465, -0.1328285260749831, 0.7364974152923421, -0.48894033800497755, -0.1380062660645564, 0.3467285143789984, -0.5226698617329454, -0.728073809102193, -0.3087026377742434, -0.5920453487964461  …  -0.05135275925449768, 2.026369963787886, -1.2397746716354687, -0.5964335020662976, 2.2389617253615226, -1.0298509799095896, -0.16185894167387574, 2.0125368030110917, -0.7317536032752685, 0.5074049121314406], [-0.02815289424043465, -0.1328285260749831, 0.7364974152923421, -0.48894033800497755, -0.1380062660645564, 0.3467285143789984, -0.5226698617329454, -0.728073809102193, -0.3087026377742434, -0.5920453487964461  …  -0.05135275925449768, 2.026369963787886, -1.2397746716354687, -0.5964335020662976, 2.2389617253615226, -1.0298509799095896, -0.16185894167387574, 2.0125368030110917, -0.7317536032752685, 0.5074049121314406], [-0.02815289424043465, -0.1328285260749831, 0.7364974152923421, -0.48894033800497755, -0.1380062660645564, 0.3467285143789984, -0.5226698617329454, -0.728073809102193, -0.3087026377742434, -0.5920453487964461  …  -0.05135275925449768, 2.026369963787886, -1.2397746716354687, -0.5964335020662976, 2.2389617253615226, -1.0298509799095896, -0.16185894167387574, 2.0125368030110917, -0.7317536032752685, 0.5074049121314406], [-0.02815289424043465, -0.1328285260749831, 0.7364974152923421, -0.48894033800497755, -0.1380062660645564, 0.3467285143789984, -0.5226698617329454, -0.728073809102193, -0.3087026377742434, -0.5920453487964461  …  -0.05135275925449768, 2.026369963787886, -1.2397746716354687, -0.5964335020662976, 2.2389617253615226, -1.0298509799095896, -0.16185894167387574, 2.0125368030110917, -0.7317536032752685, 0.5074049121314406], [-0.02815289424043465, -0.1328285260749831, 0.7364974152923421, -0.48894033800497755, -0.1380062660645564, 0.3467285143789984, -0.5226698617329454, -0.728073809102193, -0.3087026377742434, -0.5920453487964461  …  -0.05135275925449768, 2.026369963787886, -1.2397746716354687, -0.5964335020662976, 2.2389617253615226, -1.0298509799095896, -0.16185894167387574, 2.0125368030110917, -0.7317536032752685, 0.5074049121314406], [-0.02815289424043465, -0.1328285260749831, 0.7364974152923421, -0.48894033800497755, -0.1380062660645564, 0.3467285143789984, -0.5226698617329454, -0.728073809102193, -0.3087026377742434, -0.5920453487964461  …  -0.05135275925449768, 2.026369963787886, -1.2397746716354687, -0.5964335020662976, 2.2389617253615226, -1.0298509799095896, -0.16185894167387574, 2.0125368030110917, -0.7317536032752685, 0.5074049121314406], [-0.02815289424043465, -0.1328285260749831, 0.7364974152923421, -0.48894033800497755, -0.1380062660645564, 0.3467285143789984, -0.5226698617329454, -0.728073809102193, -0.3087026377742434, -0.5920453487964461  …  -0.05135275925449768, 2.026369963787886, -1.2397746716354687, -0.5964335020662976, 2.2389617253615226, -1.0298509799095896, -0.16185894167387574, 2.0125368030110917, -0.7317536032752685, 0.5074049121314406]], NamedTuple[(n_steps = 3, is_accept = true, acceptance_rate = 0.6666666666666666, log_density = -1.5958841863018887e6, hamiltonian_energy = 1.7031204748928219e6, hamiltonian_energy_error = -14233.803641736275, max_hamiltonian_energy_error = 1.0696704307082468e6, tree_depth = 1, numerical_error = true, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.5958841863018887e6, hamiltonian_energy = 1.595939171952925e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1.320694570069532e21, tree_depth = 0, numerical_error = true, step_size = 0.012261299907089943, nom_step_size = 0.012261299907089943, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.6666666666666666, log_density = -1.4539535634334409e6, hamiltonian_energy = 1.5951673167865458e6, hamiltonian_energy_error = -763.3306081269402, max_hamiltonian_energy_error = 59080.86511043296, tree_depth = 1, numerical_error = true, step_size = 0.001731493674964374, nom_step_size = 0.001731493674964374, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.6666666666666666, log_density = -1.3996113917379878e6, hamiltonian_energy = 1.4522229245572996e6, hamiltonian_energy_error = -1780.5398681678344, max_hamiltonian_energy_error = -1780.5398681678344, tree_depth = 2, numerical_error = false, step_size = 0.0009107675338697049, nom_step_size = 0.0009107675338697049, is_adapt = true), (n_steps = 10, is_accept = true, acceptance_rate = 0.6, log_density = -584382.6435818592, hamiltonian_energy = 1.391735422177089e6, hamiltonian_energy_error = -7929.81986477063, max_hamiltonian_energy_error = 387127.5417473789, tree_depth = 3, numerical_error = true, step_size = 0.0005067693889811795, nom_step_size = 0.0005067693889811795, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -570367.2638705046, hamiltonian_energy = 584300.1417954785, hamiltonian_energy_error = -130.61888840491883, max_hamiltonian_energy_error = -130.61888840491883, tree_depth = 2, numerical_error = false, step_size = 0.000240479276300656, nom_step_size = 0.000240479276300656, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -538670.342533841, hamiltonian_energy = 569908.2043684985, hamiltonian_energy_error = -510.6840766747482, max_hamiltonian_energy_error = -510.6840766747482, tree_depth = 2, numerical_error = false, step_size = 0.00039638773477065035, nom_step_size = 0.00039638773477065035, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 1.0, log_density = -518860.81418917194, hamiltonian_energy = 538243.0470540873, hamiltonian_energy_error = -485.4034001241671, max_hamiltonian_energy_error = -485.4034001241671, tree_depth = 1, numerical_error = false, step_size = 0.0006950465858734637, nom_step_size = 0.0006950465858734637, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 1.0, log_density = -461786.0167559613, hamiltonian_energy = 514830.92110531504, hamiltonian_energy_error = -4071.8880208648043, max_hamiltonian_energy_error = -4071.8880208648043, tree_depth = 1, numerical_error = false, step_size = 0.0012645480067379445, nom_step_size = 0.0012645480067379445, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -461786.0167559613, hamiltonian_energy = 461832.2788682735, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 104626.82346829993, tree_depth = 0, numerical_error = true, step_size = 0.0023493421516933796, nom_step_size = 0.0023493421516933796, is_adapt = true)  …  (n_steps = 3, is_accept = true, acceptance_rate = 0.3333333333333333, log_density = -263366.5443507032, hamiltonian_energy = 267317.2585847102, hamiltonian_energy_error = -8.498577413207386, max_hamiltonian_energy_error = 4779.398487115803, tree_depth = 1, numerical_error = true, step_size = 0.000702655939571655, nom_step_size = 0.000702655939571655, is_adapt = false), (n_steps = 2, is_accept = true, acceptance_rate = 9.75830700129624e-40, log_density = -263366.5443507032, hamiltonian_energy = 263426.78547723667, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 2124.568795571511, tree_depth = 1, numerical_error = true, step_size = 0.000702655939571655, nom_step_size = 0.000702655939571655, is_adapt = false), (n_steps = 2, is_accept = true, acceptance_rate = 5.0880129361769646e-154, log_density = -263366.5443507032, hamiltonian_energy = 263411.8051209956, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 6098.639912448358, tree_depth = 1, numerical_error = true, step_size = 0.000702655939571655, nom_step_size = 0.000702655939571655, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 8.830620262294994e-65, log_density = -263366.5443507032, hamiltonian_energy = 263430.89318473154, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 5575.955987913127, tree_depth = 1, numerical_error = true, step_size = 0.000702655939571655, nom_step_size = 0.000702655939571655, is_adapt = false), (n_steps = 2, is_accept = true, acceptance_rate = 2.3948022451277644e-79, log_density = -263366.5443507032, hamiltonian_energy = 263424.3489509969, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 3515.727765034593, tree_depth = 1, numerical_error = true, step_size = 0.000702655939571655, nom_step_size = 0.000702655939571655, is_adapt = false), (n_steps = 2, is_accept = true, acceptance_rate = 1.1017338283214963e-71, log_density = -263366.5443507032, hamiltonian_energy = 263422.7596629731, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 3193.3886977696093, tree_depth = 1, numerical_error = true, step_size = 0.000702655939571655, nom_step_size = 0.000702655939571655, is_adapt = false), (n_steps = 2, is_accept = true, acceptance_rate = 2.846905560176491e-109, log_density = -263366.5443507032, hamiltonian_energy = 263425.16720629955, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 4476.704795205616, tree_depth = 1, numerical_error = true, step_size = 0.000702655939571655, nom_step_size = 0.000702655939571655, is_adapt = false), (n_steps = 2, is_accept = true, acceptance_rate = 1.0974179060059846e-56, log_density = -263366.5443507032, hamiltonian_energy = 263413.359433488, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 2742.7873155265697, tree_depth = 1, numerical_error = true, step_size = 0.000702655939571655, nom_step_size = 0.000702655939571655, is_adapt = false), (n_steps = 2, is_accept = true, acceptance_rate = 1.3201949283654775e-99, log_density = -263366.5443507032, hamiltonian_energy = 263423.2134356142, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 4177.846996279783, tree_depth = 1, numerical_error = true, step_size = 0.000702655939571655, nom_step_size = 0.000702655939571655, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 5.405790167382866e-67, log_density = -263366.5443507032, hamiltonian_energy = 263418.8472771559, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 5410.941105293285, tree_depth = 1, numerical_error = true, step_size = 0.000702655939571655, nom_step_size = 0.000702655939571655, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-3.56 ± 0.023, -3.56 ± 0.023, -3.56 ± 0.023, -3.56 ± 0.023, -3.56 ± 0.023, -3.56 ± 0.023, -3.56 ± 0.023, -3.56 ± 0.023, -3.56 ± 0.023, -3.56 ± 0.023  …  -4.0 ± 0.0051, -4.0 ± 0.0051, -4.0 ± 0.0051, -4.0 ± 0.0051, -4.0 ± 0.0051, -4.0 ± 0.0051, -4.0 ± 0.0051, -4.0 ± 0.0051, -4.0 ± 0.0051, -4.0 ± 0.0051]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.0273 ± 0.00054 -0.308 ± 0.00031; -0.132 ± 0.00083 -0.588 ± 0.0024; … ; -0.522 ± 0.00014 -0.137 ± 0.0026; -0.722 ± 0.0037 -0.179 ± 0.0034], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.286 ± 0.00096; 0.234 ± 0.00013; … ; -0.72 ± 0.0011; -0.757 ± 0.00061;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.357 ± 0.00032 0.309 ± 0.00039 … 0.604 ± 9.4e-5 -0.471 ± 0.0005; 0.342 ± 0.00046 0.438 ± 0.0016 … -0.279 ± 3.1e-5 -0.85 ± 0.00059; … ; -0.156 ± 5.6e-5 -0.456 ± 0.00018 … -0.313 ± 0.00042 0.12 ± 0.0012; 0.597 ± 4.5e-5 0.496 ± 0.0016 … -0.271 ± 1.1e-5 -0.618 ± 0.00077], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.154 ± 0.00033; -0.592 ± 0.00039; … ; 0.101 ± 0.0002; -0.381 ± 0.00015;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.0495 ± 0.0012 2.02 ± 0.0046 … -0.162 ± 0.0002 2.01 ± 0.0043], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.738 ± 0.004;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.508 ± 0.00016], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="f80dd57e.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Monday 4 March 2024 21:25">Monday 4 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
