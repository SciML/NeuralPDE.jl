<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -3.8490595163758394
 -3.767217299719136
 -3.720016186186273
 -3.7589058481865614
 -3.984389855707386
 -3.8474863923051443
 -4.098809695293286
 -3.7644009661625843
 -4.013278479077186
 -4.01058828409137
  ⋮
 -3.567526281109504
 -4.127358660947248
 -4.046913935197882
 -3.8472911510502827
 -3.965348134773666
 -4.202861651644268
 -4.316819671010347
 -4.387469672270547
 -4.125622931707828</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="02597c01.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[0.053618399377369175, 0.3211183438486301, -0.10727438609132037, -0.08967099471707865, 0.4959169301452365, 0.454444761977262, -0.686951496999684, 0.7538447767701999, -0.125738654125912, -0.16234827107573382  …  0.3236409068263925, 0.368183101071305, -0.551038174168937, -0.15878573345069702, -0.7337476180656995, 0.04127601457111531, -0.6732187375931276, -0.800650707756702, -0.20397037997763012, 0.5002541297303006], [0.053618399377369175, 0.3211183438486301, -0.10727438609132037, -0.08967099471707865, 0.4959169301452365, 0.454444761977262, -0.686951496999684, 0.7538447767701999, -0.125738654125912, -0.16234827107573382  …  0.3236409068263925, 0.368183101071305, -0.551038174168937, -0.15878573345069702, -0.7337476180656995, 0.04127601457111531, -0.6732187375931276, -0.800650707756702, -0.20397037997763012, 0.5002541297303006], [0.002843298370161916, 0.31680585501486946, -0.15806216880416551, -0.0564331246205565, 0.48437130027510705, 0.4396595998746943, -0.6894671748680129, 0.76109098650735, -0.1300820680024518, -0.18335717735239285  …  0.34664063053901795, 0.34727711583654325, -0.5740381889130363, -0.1752525849904508, -0.721385876496764, 0.017066896163362592, -0.6906320644091845, -0.8027040500686923, -0.2698873763125497, 0.499337208948892], [0.002843298370161916, 0.31680585501486946, -0.15806216880416551, -0.0564331246205565, 0.48437130027510705, 0.4396595998746943, -0.6894671748680129, 0.76109098650735, -0.1300820680024518, -0.18335717735239285  …  0.34664063053901795, 0.34727711583654325, -0.5740381889130363, -0.1752525849904508, -0.721385876496764, 0.017066896163362592, -0.6906320644091845, -0.8027040500686923, -0.2698873763125497, 0.499337208948892], [0.0036808668094423717, 0.31749297141962746, -0.15722435371497548, -0.05883579358372814, 0.48417929946852517, 0.4397352300144878, -0.6897706348893676, 0.7610105783194664, -0.13041260155998563, -0.1842349239482633  …  0.34723484548598554, 0.3479758722762014, -0.5738989895084597, -0.17511822686622552, -0.7213721108631532, 0.01625146603000828, -0.6919585314703878, -0.8043133183265128, -0.2723830546693463, 0.49911680492549426], [0.010206648651321985, 0.3195349609833367, -0.15029035247362052, -0.07831427732900381, 0.4807472515501343, 0.4380444500446881, -0.6889842318703425, 0.7635233003457592, -0.1318447806260905, -0.19053611960446556  …  0.35176781195186474, 0.35520795658468346, -0.5733475628629049, -0.17132528292652777, -0.7198170755347644, 0.009830369670343736, -0.7045401561428903, -0.8166178966425911, -0.2945018243381301, 0.49945895093869264], [0.01024320850219968, 0.31963476940462854, -0.1503668855783447, -0.07900567507143774, 0.48040092352524866, 0.4379553143553437, -0.6889486511304558, 0.7635703926887407, -0.13191000003692963, -0.1908761661749463  …  0.35196310860390906, 0.3554160496589974, -0.5735090331655956, -0.17139424993520258, -0.7197110003470124, 0.00955280331778204, -0.7051402537534791, -0.8172249947284921, -0.29544324296310576, 0.49950895375719556], [0.010242169602311845, 0.3196933518004035, -0.15041108945231488, -0.0790737498000501, 0.4804734119432512, 0.43793269298121934, -0.6889905482213704, 0.7634603413001736, -0.13175866588779692, -0.19098640582039217  …  0.3519779608877515, 0.3553933607437322, -0.573508127116048, -0.17156978911767656, -0.7197246453831294, 0.009561235695518899, -0.7051743419687968, -0.8173046501527812, -0.29566609436364866, 0.4993221913421429], [0.010255250149859474, 0.31953034892872695, -0.15057361544448303, -0.07924272600817496, 0.4804337052592336, 0.4377826423641439, -0.6889367933703949, 0.7634400917792012, -0.13171945795083298, -0.19111002911678546  …  0.352223222936271, 0.35553029195069763, -0.5736349930889912, -0.1714965059453298, -0.719534201386437, 0.009391279147389416, -0.7054769659266455, -0.8175477257416814, -0.2960760388742619, 0.4993895347506238], [0.010120030472062665, 0.3195790249777713, -0.15055249536474072, -0.07969848062172977, 0.4803424330084136, 0.43757230192389074, -0.6890030346387696, 0.763715225074415, -0.1318641660842858, -0.19154578365073696  …  0.35246670303539185, 0.3555264114085488, -0.5738457082989336, -0.1711678408041861, -0.7196347977757076, 0.009044308352308324, -0.7060282270997766, -0.8179069370285469, -0.29664156697495814, 0.4991176691679706]  …  [0.3075060378222148, 0.6358119661062361, -0.165469496273213, -0.5191725047052482, 0.613348470629806, 0.40343557589873114, -0.6194230487402331, 0.40156174794588617, -0.23016607438393882, -0.5403458453249456  …  1.8184193074218526, 1.3735820779079448, -1.841223366305739, -0.9466675860695439, -1.4720670915468526, -0.396139789837438, -2.7069633709929892, -2.0699568741042267, -0.5804737852144106, 0.42976461202911703], [0.3072754838932201, 0.6356264601654792, -0.1655980438969392, -0.5199470557233226, 0.6143038843555043, 0.4029409549700496, -0.6196990067789779, 0.40139829210575206, -0.22995332972440735, -0.5399783874899174  …  1.819769623558577, 1.3746354008910873, -1.8424187379625776, -0.947387519918992, -1.4735019172647474, -0.3967967109955797, -2.7089175806244485, -2.070936556888206, -0.5792506445956409, 0.4289671374094837], [0.308124818734182, 0.6365182824441982, -0.16581954123195372, -0.5198245430398922, 0.6143268015133471, 0.4032965572291339, -0.6197722898181823, 0.40078422091433796, -0.229084571662161, -0.5394957236417925  …  1.8212347886890956, 1.3760868155548005, -1.8438801681575396, -0.9484347260228807, -1.4750902860938446, -0.39814562331297726, -2.7102545097328576, -2.0726742877381903, -0.577187316132836, 0.428092532106745], [0.3085134578492463, 0.6365619576600582, -0.16552368461190306, -0.5200387091312546, 0.6149033708030872, 0.40326603581986015, -0.6200024101345489, 0.4007400631584178, -0.22909411026400933, -0.5398115863588573  …  1.8216710817936654, 1.3765382004987352, -1.8445571890864574, -0.9488230056336586, -1.4754405614810098, -0.3982293303129821, -2.7111315017381927, -2.0728013277389103, -0.5765834062401185, 0.4281051879607425], [0.30856739367663427, 0.6367980063626985, -0.1654213266310115, -0.5203459178420528, 0.6149845056142533, 0.4037403874867406, -0.6200674193868284, 0.40036600583524384, -0.22853804118018686, -0.5394103855089604  …  1.8219696209189096, 1.3770005416046163, -1.8450846427709062, -0.9491084013263598, -1.4759280475958356, -0.3983780144980699, -2.7117937329247104, -2.0732576244815544, -0.5760306013694583, 0.4281207986178598], [0.31033355403613694, 0.6364228969175763, -0.1660678632753237, -0.522000565674422, 0.6155162520011485, 0.40334386442702513, -0.6208308903421703, 0.39925868965014916, -0.22721295455479898, -0.5383602525692279  …  1.825331302969633, 1.3815044910818406, -1.8469217344811202, -0.952284364561245, -1.4792572338206795, -0.40134456986507155, -2.7161916077381094, -2.0762314494715803, -0.572478041649398, 0.4257308771520836], [0.31132041818849476, 0.6365649979159318, -0.1659144581784819, -0.5221418275631692, 0.6163262274159523, 0.4038936924076291, -0.6219751147357697, 0.3977793825576171, -0.2256887408528005, -0.5384624329211171  …  1.8269495577641788, 1.384044270714361, -1.849150191336213, -0.9538264494435112, -1.4813377838360586, -0.4027221559318124, -2.719060121497966, -2.078902440944698, -0.5703206876874861, 0.42468510753723027], [0.31147656080723335, 0.6359629625102786, -0.16632551925221326, -0.5216180965491863, 0.6168036172054223, 0.40369806716644996, -0.6222542584788845, 0.39760603205341694, -0.22594759858180913, -0.5393489885369459  …  1.828523402243918, 1.3854193156550754, -1.851274822709253, -0.9552331167531668, -1.4822312327681424, -0.40344823355622, -2.7207629084411633, -2.079741427684234, -0.5681005828491789, 0.42324920404119265], [0.3120691786402404, 0.6358991892854032, -0.166382227974973, -0.5215003515140303, 0.617463676969915, 0.4037780997276778, -0.622058819053774, 0.39787789569610804, -0.22539568892572143, -0.5393760325779332  …  1.8307399070842945, 1.3871187213360279, -1.8520154430423716, -0.9570919035782322, -1.4842020658638346, -0.4039755489002569, -2.7221534691695206, -2.0814018109247234, -0.5662395310852967, 0.4224111419865394], [0.31361953774519313, 0.6367697945555407, -0.16673703773619453, -0.5220267447869326, 0.6195900771445013, 0.4034727642334246, -0.6231883658541426, 0.39801202483389936, -0.22464681651268284, -0.5395899772344178  …  1.8348265101663466, 1.3913061343177242, -1.8547454144866775, -0.9594877966319965, -1.4870171106476795, -0.40596429606565215, -2.725636855358586, -2.083826625389964, -0.5608735246108103, 0.42070861011906796]], NamedTuple[(n_steps = 2, is_accept = true, acceptance_rate = 0.5, log_density = -1.6658995571568885e6, hamiltonian_energy = 1.7610549661587856e6, hamiltonian_energy_error = -13820.160800662125, max_hamiltonian_energy_error = 41219.454357949086, tree_depth = 1, numerical_error = true, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6658995571568885e6, hamiltonian_energy = 1.6659623628891653e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 8.485528506764717e16, tree_depth = 0, numerical_error = true, step_size = 0.009055910606012648, nom_step_size = 0.009055910606012648, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.6223178085568873e6, hamiltonian_energy = 1.6622280741296287e6, hamiltonian_energy_error = -3727.152170251822, max_hamiltonian_energy_error = -3727.152170251822, tree_depth = 2, numerical_error = false, step_size = 0.0011689984204270615, nom_step_size = 0.0011689984204270615, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6223178085568873e6, hamiltonian_energy = 1.6223729641525664e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 6627.312471305253, tree_depth = 0, numerical_error = true, step_size = 0.0014199874031136505, nom_step_size = 0.0014199874031136505, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.6203301579917045e6, hamiltonian_energy = 1.6223670064289407e6, hamiltonian_energy_error = -2.1649122005328536, max_hamiltonian_energy_error = -2.1649122005328536, tree_depth = 2, numerical_error = false, step_size = 0.00012144780930630508, nom_step_size = 0.00012144780930630508, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.8003566680368076, log_density = -1.6037542874988005e6, hamiltonian_energy = 1.6203564103925042e6, hamiltonian_energy_error = -21.629784444812685, max_hamiltonian_energy_error = 30.599979580612853, tree_depth = 4, numerical_error = false, step_size = 0.00017848267177292086, nom_step_size = 0.00017848267177292086, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.17418388412242602, log_density = -1.603021018602233e6, hamiltonian_energy = 1.6037957723720334e6, hamiltonian_energy_error = 0.2301626589614898, max_hamiltonian_energy_error = 32.85418855515309, tree_depth = 4, numerical_error = false, step_size = 0.0001583687659469172, nom_step_size = 0.0001583687659469172, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9981341312940304, log_density = -1.602883311516624e6, hamiltonian_energy = 1.6030820094483467e6, hamiltonian_energy_error = 0.0016191950999200344, max_hamiltonian_energy_error = 0.00731806643307209, tree_depth = 4, numerical_error = false, step_size = 2.0922373677425846e-5, nom_step_size = 2.0922373677425846e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.993734002597954, log_density = -1.6024887043294557e6, hamiltonian_energy = 1.6029305647039707e6, hamiltonian_energy_error = 0.013217295287176967, max_hamiltonian_energy_error = 0.020357587141916156, tree_depth = 3, numerical_error = false, step_size = 3.658463558720399e-5, nom_step_size = 3.658463558720399e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.9828076540774257, log_density = -1.601968126028956e6, hamiltonian_energy = 1.6025341793851573e6, hamiltonian_energy_error = 0.03869844856671989, max_hamiltonian_energy_error = 0.03869844856671989, tree_depth = 2, numerical_error = false, step_size = 6.550513840205276e-5, nom_step_size = 6.550513840205276e-5, is_adapt = true)  …  (n_steps = 15, is_accept = true, acceptance_rate = 0.25191950233893995, log_density = -124917.75025514828, hamiltonian_energy = 125289.40094232265, hamiltonian_energy_error = 0.8331893446593313, max_hamiltonian_energy_error = 2.5465277481562225, tree_depth = 4, numerical_error = false, step_size = 0.00011597983877060005, nom_step_size = 0.00011597983877060005, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.38238778895268977, log_density = -124628.40381893198, hamiltonian_energy = 124957.99029064913, hamiltonian_energy_error = 1.0697497087530792, max_hamiltonian_energy_error = 1.2461803603800945, tree_depth = 3, numerical_error = false, step_size = 0.00011597983877060005, nom_step_size = 0.00011597983877060005, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.8883235094683288, log_density = -124309.24948945189, hamiltonian_energy = 124672.58104701055, hamiltonian_energy_error = -0.6477056378935231, max_hamiltonian_energy_error = -1.2604559504397912, tree_depth = 3, numerical_error = false, step_size = 0.00011597983877060005, nom_step_size = 0.00011597983877060005, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.634213741030309, log_density = -124216.89433690075, hamiltonian_energy = 124358.79167239176, hamiltonian_energy_error = -0.3726801203156356, max_hamiltonian_energy_error = 1.1096434439969016, tree_depth = 3, numerical_error = false, step_size = 0.00011597983877060005, nom_step_size = 0.00011597983877060005, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.4666252774658634, log_density = -124119.63742084298, hamiltonian_energy = 124270.13858956691, hamiltonian_energy_error = 0.7308852506976109, max_hamiltonian_energy_error = 1.6506325770315016, tree_depth = 4, numerical_error = false, step_size = 0.00011597983877060005, nom_step_size = 0.00011597983877060005, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.8097251627521865, log_density = -123376.58892981031, hamiltonian_energy = 124170.6920711934, hamiltonian_energy_error = -0.07251111598452553, max_hamiltonian_energy_error = 0.7122579818824306, tree_depth = 3, numerical_error = false, step_size = 0.00011597983877060005, nom_step_size = 0.00011597983877060005, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.7149194329357277, log_density = -122852.96030690255, hamiltonian_energy = 123424.9126411201, hamiltonian_energy_error = 0.4184811528248247, max_hamiltonian_energy_error = 0.742058345262194, tree_depth = 3, numerical_error = false, step_size = 0.00011597983877060005, nom_step_size = 0.00011597983877060005, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.7997183966259683, log_density = -122521.89410164526, hamiltonian_energy = 122908.73644568928, hamiltonian_energy_error = 0.9748781220114324, max_hamiltonian_energy_error = 0.9748781220114324, tree_depth = 3, numerical_error = false, step_size = 0.00011597983877060005, nom_step_size = 0.00011597983877060005, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 1.0, log_density = -122178.3129330754, hamiltonian_energy = 122555.4676143888, hamiltonian_energy_error = -1.5235375612101052, max_hamiltonian_energy_error = -1.9795761539426167, tree_depth = 4, numerical_error = false, step_size = 0.00011597983877060005, nom_step_size = 0.00011597983877060005, is_adapt = false), (n_steps = 63, is_accept = true, acceptance_rate = 0.7619201938836755, log_density = -121402.171076673, hamiltonian_energy = 122229.49712812614, hamiltonian_energy_error = -0.1651917017879896, max_hamiltonian_energy_error = 1.2833045027800836, tree_depth = 6, numerical_error = false, step_size = 0.00011597983877060005, nom_step_size = 0.00011597983877060005, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-4.15 ± 0.097, -4.15 ± 0.097, -4.15 ± 0.097, -4.15 ± 0.097, -4.15 ± 0.097, -4.15 ± 0.097, -4.15 ± 0.097, -4.15 ± 0.097, -4.15 ± 0.097, -4.15 ± 0.097  …  -4.1 ± 0.021, -4.1 ± 0.021, -4.1 ± 0.021, -4.1 ± 0.021, -4.1 ± 0.021, -4.1 ± 0.021, -4.1 ± 0.021, -4.1 ± 0.021, -4.1 ± 0.021, -4.1 ± 0.021]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.294 ± 0.016 -0.235 ± 0.0078; 0.628 ± 0.013 -0.548 ± 0.012; … ; -0.603 ± 0.019 0.39 ± 0.15; 0.443 ± 0.061 -0.649 ± 0.12], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.0424 ± 0.015; -0.891 ± 0.02; … ; -0.874 ± 0.059; 0.993 ± 0.0051;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.523 ± 0.0056 -0.434 ± 0.0016 … -0.845 ± 0.0059 0.411 ± 0.0073; -0.649 ± 0.0029 -0.577 ± 0.0013 … 0.237 ± 0.0027 0.337 ± 0.0016; … ; 0.184 ± 0.0069 0.524 ± 0.0053 … 0.858 ± 0.0032 -0.898 ± 0.019; 0.263 ± 0.012 0.191 ± 0.0083 … 0.519 ± 0.021 -0.158 ± 0.016], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.598 ± 0.0022; 0.388 ± 0.0018; … ; 1.0 ± 0.0046; -0.253 ± 0.018;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[1.75 ± 0.096 1.31 ± 0.09 … -2.64 ± 0.095 -2.0 ± 0.09], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.646 ± 0.088;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.455 ± 0.028], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="7a5849a0.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Wednesday 6 March 2024 15:28">Wednesday 6 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
