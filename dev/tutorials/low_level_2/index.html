<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/complex/">Complex Equations with PINNs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+
                        randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                        noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -4.08307180132837
 -4.35953972525253
 -4.077452476694657
 -4.194034969691686
 -3.91463002734417
 -4.165578191821746
 -3.960341570030445
 -4.084800787158287
 -3.794023629875583
 -3.4544068429236323
  ⋮
 -4.216363866754288
 -4.030818102845207
 -3.8843525548495705
 -4.094902452677021
 -3.97820374675417
 -4.076262705253521
 -4.325212381645281
 -4.072715016455459
 -3.7030415642568317</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title = &quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="8c58fdc5.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[-0.4378847453832239, 0.7457392195266559, -0.6123676950509214, -0.4685227924655801, -0.17749576314821536, 0.5438025379223902, 0.16989656426657068, -0.6936203573123693, -0.6151831575056093, 0.41324710174840806  …  0.3042919884131952, 0.2772852938384148, -0.547623982570804, -0.25044560489800827, 0.1382512168826287, 0.11919379846915698, 0.47459122321418146, 0.8255271532516613, -0.17215219631240433, 0.5016940986684677], [-0.4378847453832239, 0.7457392195266559, -0.6123676950509214, -0.4685227924655801, -0.17749576314821536, 0.5438025379223902, 0.16989656426657068, -0.6936203573123693, -0.6151831575056093, 0.41324710174840806  …  0.3042919884131952, 0.2772852938384148, -0.547623982570804, -0.25044560489800827, 0.1382512168826287, 0.11919379846915698, 0.47459122321418146, 0.8255271532516613, -0.17215219631240433, 0.5016940986684677], [-0.4378847453832239, 0.7457392195266559, -0.6123676950509214, -0.4685227924655801, -0.17749576314821536, 0.5438025379223902, 0.16989656426657068, -0.6936203573123693, -0.6151831575056093, 0.41324710174840806  …  0.3042919884131952, 0.2772852938384148, -0.547623982570804, -0.25044560489800827, 0.1382512168826287, 0.11919379846915698, 0.47459122321418146, 0.8255271532516613, -0.17215219631240433, 0.5016940986684677], [-0.4371580392482004, 0.7457683682841314, -0.6036896506149053, -0.4497782078485201, -0.17007089146923826, 0.5160504642799006, 0.1749247154376527, -0.7016097345361189, -0.6047404605945355, 0.3993964935337123  …  0.3708146268662443, 0.3629705749746017, -0.6062695883250816, -0.2772302247980779, 0.14659421666587302, 0.09097497577033849, 0.5407163319996958, 0.7783811149565539, -0.3018566315019451, 0.5018705274387986], [-0.4371580392482004, 0.7457683682841314, -0.6036896506149053, -0.4497782078485201, -0.17007089146923826, 0.5160504642799006, 0.1749247154376527, -0.7016097345361189, -0.6047404605945355, 0.3993964935337123  …  0.3708146268662443, 0.3629705749746017, -0.6062695883250816, -0.2772302247980779, 0.14659421666587302, 0.09097497577033849, 0.5407163319996958, 0.7783811149565539, -0.3018566315019451, 0.5018705274387986], [-0.43709943176300625, 0.7458503036087814, -0.6036059414806814, -0.4499116309023344, -0.17010500923969762, 0.5160223943432127, 0.17485946563651542, -0.701603868877716, -0.6048287949284415, 0.3993057799654695  …  0.371081500869181, 0.3630967458812826, -0.6066507043567518, -0.277280954649341, 0.14674583835583505, 0.09086688927222518, 0.5408771433890796, 0.7783940002673281, -0.30231571517461614, 0.5017414197369507], [-0.43694371703296025, 0.7456522277951275, -0.6030827082693163, -0.4499625395204613, -0.16993397191511236, 0.5152229762537938, 0.1740151758839983, -0.7018193079641923, -0.6052107049544936, 0.39920809343969255  …  0.3731396430552345, 0.36432733068742884, -0.6092992399806055, -0.2765482663665812, 0.14756095679705955, 0.09033018239793388, 0.542008130129569, 0.7783055368452519, -0.3045772229735716, 0.5013853351669688], [-0.436855159872647, 0.7455421193177084, -0.603135857660776, -0.4499869885011976, -0.1699535734344541, 0.5151015551466549, 0.1740314255986617, -0.7018534371055737, -0.6051835335406187, 0.39916575077493177  …  0.3732848872572718, 0.3645401003850066, -0.6096324858858798, -0.2765648943223048, 0.14762468010893864, 0.09038961140228667, 0.5421337333248507, 0.7783180486905312, -0.30494048162770726, 0.5013498717003861], [-0.4220858267100162, 0.7376074327645366, -0.5311901628164168, -0.517510897195694, -0.19681243548275343, 0.4670856983394839, 0.12736192156172102, -0.6855494036656351, -0.6022338316583237, 0.36164653923720247  …  0.8354258150227837, 0.5956702895469094, -1.2019638578762266, -0.2309463712826674, 0.32096824666114376, -0.029556538813533546, 0.8680062635403287, 0.8990830497272396, -0.7994120481825387, 0.5043981987121366], [-0.4222471057772882, 0.737614927780483, -0.5313972927884385, -0.5181883191003123, -0.19691998670296745, 0.46742540984684733, 0.1274622951100621, -0.6856416206450746, -0.6022641323964668, 0.3617587080051406  …  0.8362084115775645, 0.595837070250686, -1.2026764989658303, -0.23107185190625268, 0.32115513314084404, -0.029690955819797832, 0.868503729897411, 0.8993807527844206, -0.7997091707846902, 0.5044379109486177]  …  [-0.6545622606865362, 0.7313019302342193, -0.710574011451996, -0.6854711184434964, -0.46387677478393746, 0.675523827501202, 0.2183208714037284, -0.5448054178902637, -0.43980185581783604, 0.37185783975342146  …  1.8518962547273368, 1.2079685719494149, -2.316556266062412, -0.541507157986368, 0.7484438748937684, -0.32531951254332814, 1.7675464904818265, 1.5857958041756954, -0.6585744934497756, 0.49978502026872373], [-0.6559559574359883, 0.7319398176188626, -0.710902317121008, -0.685402209037524, -0.4645431564486181, 0.676200691865166, 0.2179101974513658, -0.543949853088854, -0.4393491365502939, 0.3718160422372664  …  1.8535065093707392, 1.2088415853691967, -2.3180030210256835, -0.5427395685629085, 0.7492629546879276, -0.32665332430325467, 1.7689050148096854, 1.587548175928534, -0.6576613868659782, 0.4994661125245551], [-0.6575537312643451, 0.7318696725317981, -0.7114050052897086, -0.6850970309350807, -0.46501957192770643, 0.6762423336810726, 0.21749068875710267, -0.5435619932056603, -0.4386602878416473, 0.37182020700658514  …  1.8547965888306948, 1.2099364093155103, -2.319453646098804, -0.5429839744237347, 0.750462323692179, -0.32776343479166464, 1.7706356790045306, 1.5885317823103589, -0.6561400170434437, 0.49885125017368503], [-0.661418196894275, 0.7301281844998548, -0.7128252981288457, -0.6843732071778885, -0.46946677501604395, 0.6777655720565484, 0.21676654331850123, -0.5415984678683444, -0.43445491546765613, 0.3720101521143755  …  1.8595419678127603, 1.2142323140849736, -2.325476626949079, -0.5478040209946655, 0.7540560253871129, -0.330223840523458, 1.7772076214824692, 1.5950084329461591, -0.6509045316833058, 0.4978008757860701], [-0.6615565953961716, 0.7303474919841096, -0.7127355754192398, -0.6842826481261288, -0.4697455770679727, 0.6779218018521576, 0.21671056223325663, -0.5417244525958541, -0.4341393717243693, 0.37209993965384197  …  1.859375309121685, 1.2145385010175496, -2.325896543049639, -0.5482190672533708, 0.7543057940946177, -0.33055822441599514, 1.777551341422599, 1.5951852092508991, -0.6507746920049642, 0.4980898981616252], [-0.663902714820431, 0.731596232516871, -0.7134386463474405, -0.683708881301126, -0.47274824065639554, 0.6793083154496641, 0.2157559132333218, -0.5404464898087799, -0.4324903490387293, 0.3724845911274526  …  1.8630443967100887, 1.2185713211904623, -2.3304391208077067, -0.5503128676974464, 0.7585621589066117, -0.3323543850151087, 1.7817073173374662, 1.5986594000513537, -0.6473784075017482, 0.4977614246070632], [-0.8396430322127764, 0.764260687220976, -0.7349618433193542, -0.6317749460389576, -0.6212318386183341, 0.7733438056603542, 0.2185152998007632, -0.45618558424490196, -0.30071776468762496, 0.3921560074937395  …  2.1074602200241497, 1.4185977169865789, -2.5548400586535425, -0.7149935538277364, 0.9436647397983642, -0.4620032546544912, 1.988909013132159, 1.8259098397883426, -0.46032253025225606, 0.46085493406248823], [-0.838025490260323, 0.7624444660533852, -0.730692440165438, -0.6297175143561548, -0.6168854857540781, 0.7753032130461704, 0.22298247573112057, -0.4581491093213501, -0.2976608879240937, 0.3922814468453166  …  2.1160163788324535, 1.419637044847795, -2.561972150683797, -0.7175067851798798, 0.9491940998138239, -0.4665086455304131, 1.9929148854844638, 1.833733924120235, -0.4548186749084535, 0.45838946130285696], [-0.8379384475023606, 0.762582861026209, -0.7308851518114325, -0.629674056626843, -0.6166060199480758, 0.7755478234225565, 0.22338319576685756, -0.4581479509071421, -0.29733617168449356, 0.39217392539142515  …  2.1165701327538544, 1.4201238551197521, -2.5624366253764532, -0.7178683680831098, 0.9496844927389058, -0.466685123507905, 1.9929499547963003, 1.8342344183985309, -0.45443697160650287, 0.4580317766414667], [-0.8376506575798428, 0.7618872678234452, -0.7300292193177976, -0.6289965707619967, -0.6161001978888714, 0.775968729202625, 0.2257501668439379, -0.45951243453736756, -0.296011744112039, 0.3912250178495221  …  2.117531630925491, 1.4213172069423061, -2.563865168793569, -0.7190624834428958, 0.9520100539946695, -0.4688986133086767, 1.994045160221688, 1.8373015079960962, -0.4521694444888338, 0.4578924889573439]], NamedTuple[(n_steps = 1, is_accept = true, acceptance_rate = 1.0, log_density = -1.6424837739335138e6, hamiltonian_energy = 1.7721766818875938e6, hamiltonian_energy_error = -55692.75896576722, max_hamiltonian_energy_error = -55692.75896576722, tree_depth = 1, numerical_error = false, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6424837739335138e6, hamiltonian_energy = 1.642535619111006e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 7.179555467390256e39, tree_depth = 0, numerical_error = true, step_size = 0.022477359524651217, nom_step_size = 0.022477359524651217, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6424837739335138e6, hamiltonian_energy = 1.642548834855059e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 2.591978832345308e6, tree_depth = 0, numerical_error = true, step_size = 0.003798698975534599, nom_step_size = 0.003798698975534599, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -1.5440815188902572e6, hamiltonian_energy = 1.6423908530975785e6, hamiltonian_energy_error = -147.17654171702452, max_hamiltonian_energy_error = -147.17654171702452, tree_depth = 3, numerical_error = false, step_size = 0.00037467407115379783, nom_step_size = 0.00037467407115379783, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.216294449408765e-47, log_density = -1.5440815188902572e6, hamiltonian_energy = 1.54411734939615e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 415.3132737581618, tree_depth = 2, numerical_error = false, step_size = 0.00050676938898118, nom_step_size = 0.00050676938898118, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9645680859363152, log_density = -1.5437791625405871e6, hamiltonian_energy = 1.5441273344562608e6, hamiltonian_energy_error = 0.01707331370562315, max_hamiltonian_energy_error = 0.10701483837328851, tree_depth = 3, numerical_error = false, step_size = 4.019648422075262e-5, nom_step_size = 4.019648422075262e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9024987723501534, log_density = -1.5415123969265379e6, hamiltonian_energy = 1.5438376240817958e6, hamiltonian_energy_error = 0.26786791370250285, max_hamiltonian_energy_error = 0.26786791370250285, tree_depth = 3, numerical_error = false, step_size = 5.6644104644161366e-5, nom_step_size = 5.6644104644161366e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.9183993499728693, log_density = -1.5412715943237918e6, hamiltonian_energy = 1.5415627795353527e6, hamiltonian_energy_error = 0.0462188976816833, max_hamiltonian_energy_error = 0.1768813335802406, tree_depth = 2, numerical_error = false, step_size = 7.099543328094071e-5, nom_step_size = 7.099543328094071e-5, is_adapt = true), (n_steps = 63, is_accept = true, acceptance_rate = 0.16748188071419118, log_density = -938400.3201118375, hamiltonian_energy = 1.5412688914496303e6, hamiltonian_energy_error = -41.863621989730746, max_hamiltonian_energy_error = -41.863621989730746, tree_depth = 6, numerical_error = false, step_size = 9.777190690291809e-5, nom_step_size = 9.777190690291809e-5, is_adapt = true), (n_steps = 31, is_accept = true, acceptance_rate = 1.0, log_density = -937560.2581980331, hamiltonian_energy = 938445.362305088, hamiltonian_energy_error = -0.008963567204773426, max_hamiltonian_energy_error = -0.04833052458707243, tree_depth = 5, numerical_error = false, step_size = 1.2944539919052275e-5, nom_step_size = 1.2944539919052275e-5, is_adapt = true)  …  (n_steps = 15, is_accept = true, acceptance_rate = 0.9271971718718371, log_density = -204503.8702425602, hamiltonian_energy = 204599.54363814634, hamiltonian_energy_error = 0.24089006835129112, max_hamiltonian_energy_error = 0.5285759015241638, tree_depth = 4, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.9727114847716936, log_density = -203951.63474728458, hamiltonian_energy = 204554.55013007508, hamiltonian_energy_error = -0.666076151363086, max_hamiltonian_energy_error = -0.8065258775895927, tree_depth = 3, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.7863893207343454, log_density = -203389.28496714798, hamiltonian_energy = 204010.73179929043, hamiltonian_energy_error = 0.1821757675788831, max_hamiltonian_energy_error = 0.764484868501313, tree_depth = 3, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.8908339129114776, log_density = -201124.5108201348, hamiltonian_energy = 203441.68380312866, hamiltonian_energy_error = 0.05588755352073349, max_hamiltonian_energy_error = 0.3296852991625201, tree_depth = 4, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9744625202590153, log_density = -200997.8325328577, hamiltonian_energy = 201167.87195100103, hamiltonian_energy_error = 0.10666860354831442, max_hamiltonian_energy_error = -0.6534011978073977, tree_depth = 4, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9790271175118587, log_density = -199328.91622392187, hamiltonian_energy = 201052.07758504237, hamiltonian_energy_error = 0.035665125178638846, max_hamiltonian_energy_error = -0.5243018419132568, tree_depth = 4, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 63, is_accept = true, acceptance_rate = 0.9955014721939761, log_density = -127849.21791052287, hamiltonian_energy = 199371.4986894438, hamiltonian_energy_error = -5.315874192165211, max_hamiltonian_energy_error = -6.736130262899678, tree_depth = 6, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9826053678721068, log_density = -125527.90401114878, hamiltonian_energy = 127899.78494085712, hamiltonian_energy_error = -1.2273491848318372, max_hamiltonian_energy_error = -1.2472983566985931, tree_depth = 4, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.9162172685243062, log_density = -125370.25881721474, hamiltonian_energy = 125581.64983942613, hamiltonian_energy_error = 0.12424397152790334, max_hamiltonian_energy_error = 0.3459302474366268, tree_depth = 3, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.9909157851577672, log_density = -124677.35428396406, hamiltonian_energy = 125416.84156200221, hamiltonian_energy_error = -0.24686784911318682, max_hamiltonian_energy_error = -0.24686784911318682, tree_depth = 3, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-4.04 ± 0.086, -4.04 ± 0.086, -4.04 ± 0.086, -4.04 ± 0.086, -4.04 ± 0.086, -4.04 ± 0.086, -4.04 ± 0.085, -4.04 ± 0.085, -4.04 ± 0.085, -4.04 ± 0.085  …  -3.94 ± 0.068, -3.94 ± 0.068, -3.94 ± 0.068, -3.94 ± 0.068, -3.94 ± 0.068, -3.94 ± 0.068, -3.94 ± 0.068, -3.94 ± 0.068, -3.94 ± 0.068, -3.94 ± 0.068]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.633 ± 0.091 -0.456 ± 0.07; 0.734 ± 0.011 0.371 ± 0.0083; … ; 0.22 ± 0.0033 -0.599 ± 0.11; -0.549 ± 0.038 0.337 ± 0.086], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.0987 ± 0.032; -0.132 ± 0.021; … ; 0.439 ± 0.062; -0.702 ± 0.035;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.547 ± 0.0076 -0.389 ± 0.0042 … 0.555 ± 0.05 -0.645 ± 0.037; -0.445 ± 0.0099 0.452 ± 0.022 … 0.579 ± 0.026 0.0622 ± 0.017; … ; -0.164 ± 0.013 -0.249 ± 0.011 … 0.248 ± 0.037 -0.607 ± 0.022; 0.162 ± 0.02 -0.0265 ± 0.017 … -0.444 ± 0.022 -0.0125 ± 0.03], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.668 ± 0.0055; 0.367 ± 0.017; … ; -0.538 ± 0.005; 0.251 ± 0.019;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[1.81 ± 0.14 1.18 ± 0.11 … 1.74 ± 0.12 1.56 ± 0.13], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.68 ± 0.1;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.498 ± 0.015], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain)
          for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="bab62a1b.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Tuesday 9 July 2024 14:20">Tuesday 9 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
