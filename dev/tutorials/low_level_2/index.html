<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/complex/">Complex Equations with PINNs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+
                        randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                        noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -3.7853423086697666
 -4.296552197635632
 -4.221031724898969
 -4.046989502140983
 -4.123672950648209
 -4.301710999649068
 -3.887800760115984
 -3.7048099227729523
 -3.5569913429218256
 -4.000792994861489
  ⋮
 -4.26328261986815
 -4.19368638288364
 -3.81545094278715
 -3.945281790741379
 -3.9043857710459466
 -3.652933599425841
 -3.8724564327091837
 -3.94928827796464
 -4.06940923631043</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title = &quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="67499616.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Chain(Dense(2, 8, tanh), Dense(8, 8, tanh), Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = 17:24)), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = 65:72)), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = 9:9)))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[0.2994898544029993, 1.1659130167057254, -1.3772064828925359, -1.2174427267777597, -0.6988193487237586, 0.05998191740938428, -0.383321659669497, -0.005119814735704192, 0.1759729849409734, 1.7414886463488857  …  -0.04859142790944726, -0.5110631058687721, 0.47940802441159125, 0.48376813483645464, 0.21743996325036793, 0.3410861647106482, 0.1676326454458114, -0.43975698562230925, -0.17875661302794735, 0.5002287434779229], [0.2994898544029993, 1.1659130167057254, -1.3772064828925359, -1.2174427267777597, -0.6988193487237586, 0.05998191740938428, -0.383321659669497, -0.005119814735704192, 0.1759729849409734, 1.7414886463488857  …  -0.04859142790944726, -0.5110631058687721, 0.47940802441159125, 0.48376813483645464, 0.21743996325036793, 0.3410861647106482, 0.1676326454458114, -0.43975698562230925, -0.17875661302794735, 0.5002287434779229], [0.331779519003933, 1.1650472728762717, -1.373568226422986, -1.2288268916143645, -0.663684784546027, -0.06354335497078728, -0.3859645844754529, -0.1575700429907644, 0.16741845103251884, 1.72321465672003  …  -0.0315832120670744, -0.47875650277096204, 0.47283729713088646, 0.6369961741545612, 0.09016134250037672, 0.3721886157856093, 0.17381750839753743, -0.5117903507245208, -0.3545409244295027, 0.501652226405293], [0.331779519003933, 1.1650472728762717, -1.373568226422986, -1.2288268916143645, -0.663684784546027, -0.06354335497078728, -0.3859645844754529, -0.1575700429907644, 0.16741845103251884, 1.72321465672003  …  -0.0315832120670744, -0.47875650277096204, 0.47283729713088646, 0.6369961741545612, 0.09016134250037672, 0.3721886157856093, 0.17381750839753743, -0.5117903507245208, -0.3545409244295027, 0.501652226405293], [0.3328502681029801, 1.1658253118358242, -1.3733521650876812, -1.2284469152620399, -0.6620073983788587, -0.06410650049200393, -0.3864144346086631, -0.15120848252940944, 0.16710157569609016, 1.722722116957686  …  -0.02979861159549506, -0.47692627005200255, 0.47721149181703354, 0.6431214666685189, 0.0876331726072225, 0.3743209632926562, 0.17625513899352493, -0.5136973292634702, -0.35687529250863725, 0.5011990699119029], [0.3360208707753358, 1.1661345962684864, -1.373741985192471, -1.2274471786521701, -0.6571984920293674, -0.06278753137956178, -0.3876603392555429, -0.1421872723663406, 0.16867694570443414, 1.7212247962489426  …  -0.026783688523826333, -0.4754660627313363, 0.48902799620408255, 0.6578420551633098, 0.08361172938016022, 0.3804047262938429, 0.1826725037084394, -0.516045950314164, -0.3623388250757472, 0.5018838675576555], [0.3384596165639607, 1.1668368772727145, -1.3741293479095462, -1.2263158226202409, -0.6548194203858079, -0.061482504861817326, -0.39002601010289767, -0.14057354412044518, 0.16912289107664713, 1.7206713628407733  …  -0.02534547587198358, -0.4749446323855948, 0.496707359577454, 0.6688970863615197, 0.08059661388086774, 0.3840302855661101, 0.1872022061037534, -0.5187582642134316, -0.3656547241614556, 0.5022089561907043], [0.3384596165639607, 1.1668368772727145, -1.3741293479095462, -1.2263158226202409, -0.6548194203858079, -0.061482504861817326, -0.39002601010289767, -0.14057354412044518, 0.16912289107664713, 1.7206713628407733  …  -0.02534547587198358, -0.4749446323855948, 0.496707359577454, 0.6688970863615197, 0.08059661388086774, 0.3840302855661101, 0.1872022061037534, -0.5187582642134316, -0.3656547241614556, 0.5022089561907043], [0.3388661940005986, 1.1669362351889718, -1.3741983060881977, -1.2261545168240884, -0.6544913585237544, -0.06110984062538248, -0.39034772357658487, -0.14013980722103114, 0.16934444196112963, 1.7207408453746456  …  -0.02501206614952251, -0.475072364883421, 0.4978380173500132, 0.6703438131949523, 0.08053602213148428, 0.38429823436027133, 0.18776176013274876, -0.5192652657221931, -0.36615418973412683, 0.5022767507254433], [0.3390295448018716, 1.166859514634852, -1.3742910378388744, -1.2262227572801039, -0.6543646338937209, -0.060999778214209724, -0.3905616561005462, -0.14017991346575012, 0.16936064856927502, 1.720360905845194  …  -0.024845901485340344, -0.475136919569173, 0.49828942916564045, 0.6711478139952123, 0.08040691990370061, 0.3845472521579965, 0.18787051748379674, -0.5195074967126515, -0.3663955403709444, 0.5024599910279225]  …  [0.5103351440312738, 0.721001987838346, -0.4312264553298419, -0.533641655382541, -0.7815080692999341, -0.007842630744381721, -0.7715975736224263, -0.649676235428746, -1.716468283450229, 1.5025924309051386  …  2.394698939616996, -3.008633077864839, 4.080953104733628, 4.412845341688542, 2.88272005859031, 3.110615512605783, 3.237916060138063, -0.9405541761059386, 1.033960592762139, 0.9806326199538953], [0.5025450560813941, 0.734911014386953, -0.47981091375166857, -0.5383948491481441, -0.7931304436991675, -0.00447792219076355, -0.7849372914077182, -0.6499485022185613, -1.6414591923944288, 1.4879242439260452  …  2.292118483984215, -2.8976311868095967, 4.103970494426186, 4.40680790127743, 2.859157479015123, 2.9264254056514436, 3.270382869529795, -0.8505570293827739, 0.9738728438080336, 0.9669088168171784], [0.48514697040267485, 0.747777215886343, -0.5030336038078083, -0.5287709457607886, -0.7711783129144467, -0.011933148320701671, -0.7957110390408423, -0.6862026846965703, -1.5755365515097772, 1.3823271313858096  …  2.2880752450310133, -2.9474874309129535, 4.054823335633034, 4.449974516788355, 2.800939729606491, 2.9739468258960833, 3.181755883840253, -0.7452311034181398, 1.083034058664182, 1.0129843030983725], [0.47678842270792454, 0.7787811226638801, -0.4337193506511865, -0.5914152135427521, -0.7481920998360454, -0.027648236729304845, -0.7631149091224034, -0.6681349376689726, -1.4836536443696096, 1.4064883232434378  …  2.5172080629165485, -2.9338793824594687, 4.27446947147214, 4.496399590415623, 2.7814254522980923, 2.8587739431180497, 3.295030114047216, -0.7737302327759736, 1.2409541277237481, 1.0508696789392293], [0.4503747659619246, 0.6945732720145599, -0.5051157466517263, -0.5283308829842143, -0.738427688684511, -0.011266610111432061, -0.7963802855539592, -0.6802478163780953, -1.5044222946277561, 1.4076840195343434  …  2.4427491184365278, -2.9655017962005203, 4.314085309144189, 4.566816805187792, 2.7405328683688386, 2.936441486535506, 3.3099807003912427, -0.8295313577092004, 1.2560969961199622, 1.0492110636205978], [0.49380978986402346, 0.7304903604620951, -0.5176147186485945, -0.5348725630595593, -0.7260689820190143, -0.01622810678982436, -0.8076394098655495, -0.6036548276561908, -1.545363775959076, 1.4202796436966998  …  2.3284566742724055, -3.220778824159053, 4.500720073640731, 4.717768072386333, 2.7067175962965098, 2.9139961927287965, 3.200089590604163, -0.5422606691362238, 1.35743344210317, 1.0997022381108685], [0.49315677644200984, 0.719711202952951, -0.5040559438753272, -0.503978600062013, -0.7191120546540964, 0.017583435588295757, -0.8022765537133014, -0.6416383684365419, -1.5495889183107254, 1.5237225311050555  …  2.3426796015373244, -2.985698887056401, 4.3660107722941515, 4.614054381881668, 2.5711034715966665, 3.0661657828771567, 3.1643729631283777, -0.5964791915801477, 1.3782063672976133, 1.0436294067640934], [0.4989981620457204, 0.7357907113971085, -0.5151399760693937, -0.5149432346796158, -0.7086925807426375, 0.03013380552575541, -0.7753947651366979, -0.6507273801182315, -1.504010582839792, 1.4509039337749723  …  2.288764436901028, -2.911628431212173, 4.41320022150625, 4.590497150671134, 2.577464315350807, 3.113178388179035, 3.32393017373106, -0.6875698574213212, 1.3885725247474476, 1.0392615770782658], [0.4987614029055798, 0.695623672484038, -0.4740078299288143, -0.5232193716729481, -0.7028662660274999, 0.0540206640841703, -0.7675190913464877, -0.6065305612693311, -1.4827594795081511, 1.409645532009379  …  2.2742280332568274, -2.9625258290290666, 4.439028061024536, 4.459662865476068, 2.5699256466526244, 3.072809943007786, 3.265979687341874, -0.7113588469288379, 1.3221460577205186, 1.0127776766069987], [0.4923661098827863, 0.681264771507969, -0.4837276811402495, -0.5542245067633788, -0.6876648775062367, 0.04931344843125737, -0.7817313261601158, -0.6821677365083675, -1.5280412599622006, 1.4526989674589728  …  2.3483836141284455, -3.1830141634023668, 4.7644458179734235, 4.670856413890596, 2.6571415433459094, 3.014291721408519, 3.199746422896942, -0.8219289393716862, 1.2415681331338366, 1.017702192309358]], NamedTuple[(n_steps = 3, is_accept = true, acceptance_rate = 0.6666666666666666, log_density = -1.617486310115826e6, hamiltonian_energy = 1.685211357797896e6, hamiltonian_energy_error = -1344.8058736389503, max_hamiltonian_energy_error = 10507.826345679583, tree_depth = 1, numerical_error = true, step_size = 0.00078125, nom_step_size = 0.00078125, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.617486310115826e6, hamiltonian_energy = 1.6175436787940722e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 3.0981328463134258e13, tree_depth = 0, numerical_error = true, step_size = 0.006130649953544971, nom_step_size = 0.006130649953544971, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.480181301730985e6, hamiltonian_energy = 1.6112008336422432e6, hamiltonian_energy_error = -6346.120873085223, max_hamiltonian_energy_error = -6346.120873085223, tree_depth = 2, numerical_error = false, step_size = 0.0008657468374821869, nom_step_size = 0.0008657468374821869, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 1.710715601919729e-286, log_density = -1.480181301730985e6, hamiltonian_energy = 1.4802298314685235e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 658.0024248326663, tree_depth = 1, numerical_error = false, step_size = 0.0011069587737906317, nom_step_size = 0.0011069587737906317, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -1.4731041209021308e6, hamiltonian_energy = 1.4802318449447032e6, hamiltonian_energy_error = -9.578958170255646, max_hamiltonian_energy_error = -9.578958170255646, tree_depth = 3, numerical_error = false, step_size = 9.776121395885786e-5, nom_step_size = 9.776121395885786e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -1.4587190213913433e6, hamiltonian_energy = 1.4731322240434475e6, hamiltonian_energy_error = -27.439860463142395, max_hamiltonian_energy_error = -27.439860463142395, tree_depth = 3, numerical_error = false, step_size = 0.00014667926525853092, nom_step_size = 0.00014667926525853092, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.4497104948938608e6, hamiltonian_energy = 1.4587613529055545e6, hamiltonian_energy_error = -9.658989853225648, max_hamiltonian_energy_error = -9.658989853225648, tree_depth = 2, numerical_error = false, step_size = 0.00024307494832374342, nom_step_size = 0.00024307494832374342, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.564519513730596e-8, log_density = -1.4497104948938608e6, hamiltonian_energy = 1.449761046093109e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 158.78099278663285, tree_depth = 2, numerical_error = false, step_size = 0.0004276656075920357, nom_step_size = 0.0004276656075920357, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9803885804561723, log_density = -1.4486612528905661e6, hamiltonian_energy = 1.4497551962618397e6, hamiltonian_energy_error = -0.013664715224877, max_hamiltonian_energy_error = 0.08343071932904422, tree_depth = 4, numerical_error = false, step_size = 3.3654245483862994e-5, nom_step_size = 3.3654245483862994e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.9799963927327231, log_density = -1.4481443785695517e6, hamiltonian_energy = 1.4487146938400401e6, hamiltonian_energy_error = 0.03204603190533817, max_hamiltonian_energy_error = 0.03204603190533817, tree_depth = 2, numerical_error = false, step_size = 5.794210264552304e-5, nom_step_size = 5.794210264552304e-5, is_adapt = true)  …  (n_steps = 1023, is_accept = true, acceptance_rate = 0.9857525588421671, log_density = -3048.3486980535254, hamiltonian_energy = 3110.523549370123, hamiltonian_energy_error = -0.010133442773621937, max_hamiltonian_energy_error = 0.049051125342884916, tree_depth = 10, numerical_error = false, step_size = 0.00015417484109808292, nom_step_size = 0.00015417484109808292, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9776755357847318, log_density = -3043.9542605894358, hamiltonian_energy = 3094.594387170787, hamiltonian_energy_error = 0.017824797677803872, max_hamiltonian_energy_error = 0.06601808070900006, tree_depth = 10, numerical_error = false, step_size = 0.00015417484109808292, nom_step_size = 0.00015417484109808292, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9573027168573827, log_density = -3051.6448714477515, hamiltonian_energy = 3094.492384464455, hamiltonian_energy_error = 0.08723167714379088, max_hamiltonian_energy_error = 0.1224411585026246, tree_depth = 10, numerical_error = false, step_size = 0.00015417484109808292, nom_step_size = 0.00015417484109808292, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9998705350612114, log_density = -3052.8227797354584, hamiltonian_energy = 3114.8393432342646, hamiltonian_energy_error = -0.04760787421537316, max_hamiltonian_energy_error = -0.11667901542841719, tree_depth = 10, numerical_error = false, step_size = 0.00015417484109808292, nom_step_size = 0.00015417484109808292, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9505866395438936, log_density = -3044.0162918614324, hamiltonian_energy = 3098.071806469376, hamiltonian_energy_error = 0.001770774162196176, max_hamiltonian_energy_error = 0.15847907802026384, tree_depth = 10, numerical_error = false, step_size = 0.00015417484109808292, nom_step_size = 0.00015417484109808292, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9750738208667667, log_density = -3043.1553097370975, hamiltonian_energy = 3099.3297086718662, hamiltonian_energy_error = -0.03585866961066131, max_hamiltonian_energy_error = 0.10185178095207448, tree_depth = 10, numerical_error = false, step_size = 0.00015417484109808292, nom_step_size = 0.00015417484109808292, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9876750977533725, log_density = -3042.101588948829, hamiltonian_energy = 3091.267563313916, hamiltonian_energy_error = -0.007158729102684447, max_hamiltonian_energy_error = 0.058717913397231314, tree_depth = 10, numerical_error = false, step_size = 0.00015417484109808292, nom_step_size = 0.00015417484109808292, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9743194930466336, log_density = -3046.430789179494, hamiltonian_energy = 3090.3086087587485, hamiltonian_energy_error = 0.03941367797096973, max_hamiltonian_energy_error = 0.07329701038042913, tree_depth = 10, numerical_error = false, step_size = 0.00015417484109808292, nom_step_size = 0.00015417484109808292, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.95305184831508, log_density = -3047.513288832817, hamiltonian_energy = 3102.3650390130547, hamiltonian_energy_error = 0.05330549299287668, max_hamiltonian_energy_error = 0.1467498437341419, tree_depth = 10, numerical_error = false, step_size = 0.00015417484109808292, nom_step_size = 0.00015417484109808292, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9992506603143011, log_density = -3046.254408444152, hamiltonian_energy = 3100.73677301188, hamiltonian_energy_error = 0.003563584843504941, max_hamiltonian_energy_error = -0.10221062586833796, tree_depth = 10, numerical_error = false, step_size = 0.00015417484109808292, nom_step_size = 0.00015417484109808292, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-4.09 ± 0.019, -4.09 ± 0.018, -4.09 ± 0.018, -4.09 ± 0.018, -4.09 ± 0.018, -4.09 ± 0.018, -4.09 ± 0.018, -4.09 ± 0.018, -4.09 ± 0.018, -4.09 ± 0.018  …  -3.98 ± 0.008, -3.98 ± 0.008, -3.98 ± 0.008, -3.98 ± 0.008, -3.98 ± 0.008, -3.98 ± 0.008, -3.98 ± 0.008, -3.98 ± 0.008, -3.98 ± 0.008, -3.98 ± 0.008]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = 17:24)), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = 65:72)), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = 9:9)))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.472 ± 0.034 -1.46 ± 0.17; 0.85 ± 0.11 1.8 ± 0.29; … ; -0.771 ± 0.021 1.44 ± 0.044; -0.649 ± 0.026 1.48 ± 0.055], bias = MonteCarloMeasurements.Particles{Float64, 34}[1.47 ± 0.14, 0.409 ± 0.064, -0.0443 ± 0.1, -0.592 ± 0.045, -0.625 ± 0.073, 2.01 ± 0.18, 0.933 ± 0.069, -0.469 ± 0.054]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[1.47 ± 0.1 -0.267 ± 0.25 … -0.41 ± 0.15 1.09 ± 0.3; 0.389 ± 0.2 0.183 ± 0.089 … -0.944 ± 0.2 -0.348 ± 0.13; … ; 1.03 ± 0.15 0.322 ± 0.11 … 0.364 ± 0.22 -0.484 ± 0.16; -1.77 ± 0.093 1.03 ± 0.16 … 0.291 ± 0.11 -1.04 ± 0.35], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.563 ± 0.068, -0.949 ± 0.12, -0.854 ± 0.063, -1.25 ± 0.11, -0.058 ± 0.15, -0.71 ± 0.13, 0.465 ± 0.18, 0.649 ± 0.2]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[2.28 ± 0.093 -2.95 ± 0.095 … 3.12 ± 0.11 -1.07 ± 0.27], bias = MonteCarloMeasurements.Particles{Float64, 34}[1.02 ± 0.19]))], MonteCarloMeasurements.Particles{Float64, 34}[1.01 ± 0.067], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain)
          for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="d1b63938.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Friday 18 October 2024 05:14">Friday 18 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
