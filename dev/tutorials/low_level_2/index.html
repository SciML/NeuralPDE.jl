<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -3.9954459167070424
 -3.7327058717084554
 -4.036957042279052
 -4.107494323508312
 -3.9415559919188534
 -3.653650080423004
 -3.6697689098870634
 -4.009083871520658
 -4.071476961420219
 -3.5065680515304614
  ⋮
 -4.003763841571529
 -3.804500292120481
 -4.002900909210214
 -4.621414910534243
 -3.905157973273189
 -3.9337115007210417
 -4.420326948560041
 -4.103832350845495
 -3.9589953785459744</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="7168433f.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[-0.4153290935662654, 0.47735157563231645, 0.5057999953568537, 0.5556790037234467, 0.17077323225743718, -0.017448595325119443, 0.27306280802128546, 0.22647230574036242, 0.38889141998863724, 0.7565710207095857  …  0.1760278848674498, 0.6179667833354252, 0.4778457885642627, -0.16003401980733928, -0.38846571397325014, 0.026271408174027358, -0.3472631002812705, -0.4107606788613702, -0.151596713598475, 0.5004066323394891], [-0.4153290935662654, 0.47735157563231645, 0.5057999953568537, 0.5556790037234467, 0.17077323225743718, -0.017448595325119443, 0.27306280802128546, 0.22647230574036242, 0.38889141998863724, 0.7565710207095857  …  0.1760278848674498, 0.6179667833354252, 0.4778457885642627, -0.16003401980733928, -0.38846571397325014, 0.026271408174027358, -0.3472631002812705, -0.4107606788613702, -0.151596713598475, 0.5004066323394891], [-0.4153290935662654, 0.47735157563231645, 0.5057999953568537, 0.5556790037234467, 0.17077323225743718, -0.017448595325119443, 0.27306280802128546, 0.22647230574036242, 0.38889141998863724, 0.7565710207095857  …  0.1760278848674498, 0.6179667833354252, 0.4778457885642627, -0.16003401980733928, -0.38846571397325014, 0.026271408174027358, -0.3472631002812705, -0.4107606788613702, -0.151596713598475, 0.5004066323394891], [-0.414220735906147, 0.4764185282817419, 0.5067513412626125, 0.5542946170369333, 0.16381762790165894, -0.027178431830939744, 0.27496337417712274, 0.21938784424779895, 0.3937448165271338, 0.757546902479303  …  0.16831428415805727, 0.6291904882970325, 0.4709385612046919, -0.16565611588275506, -0.3962218985853634, 0.014586245215492366, -0.3439345843286886, -0.4096630714240948, -0.17091946277641928, 0.5006799259232663], [-0.41320713069203346, 0.47716505540337284, 0.5070790469193687, 0.554362351746277, 0.1556669402204045, -0.03269807569897793, 0.27866898900740794, 0.21348910480798702, 0.39848210174912274, 0.758701380208614  …  0.16212222356491743, 0.6397236503652045, 0.46549928474057384, -0.170809349397968, -0.40334875133964954, 0.005295711822930549, -0.34186877034432656, -0.4069650250774555, -0.18822973400897064, 0.5004223722414016], [-0.4133628982583315, 0.47709702122133396, 0.5072908152983302, 0.5544781021761543, 0.1536470094726327, -0.033050481842469774, 0.2798928602713661, 0.21171739530967185, 0.3998844176169072, 0.7589432166267429  …  0.16010198677576035, 0.6420172314079408, 0.4643662235622627, -0.17214437894059778, -0.4053211148054812, 0.003200779574704748, -0.34190872638162534, -0.40653812929482736, -0.19247973379473604, 0.5006943288603889], [-0.4133857373928157, 0.4772005563898744, 0.5075150035308467, 0.5543992692119748, 0.15289427216264043, -0.03325601344752685, 0.2802052943263239, 0.21097983930097394, 0.40027099583023634, 0.7591609045810402  …  0.15957597376890692, 0.6427272888797259, 0.46404995809755173, -0.17274426220834907, -0.4059632885036575, 0.002091245148806699, -0.34166648111247067, -0.4067485610973347, -0.1942883937062054, 0.500569415842481], [-0.4133810929140515, 0.47731362266780253, 0.5074969635417615, 0.5542821586283706, 0.15278621690279576, -0.03331174052285153, 0.28023926441680463, 0.21079353192258526, 0.400331750039357, 0.7591772200002622  …  0.15950551851576458, 0.6428636690118751, 0.46388582355369395, -0.1729475664665942, -0.40617710610416774, 0.001972086327926301, -0.3414853359728653, -0.4066612795485187, -0.19466440364447204, 0.500365451889318], [-0.4130243955693931, 0.47726094021295734, 0.507634403400805, 0.5542108037091947, 0.151296710604536, -0.033818790918947204, 0.28096121156234266, 0.20942793165769155, 0.40157128893779903, 0.759230979612208  …  0.1583787798541198, 0.6446021613560825, 0.4633914331748849, -0.1738946714534243, -0.4080465666113391, 0.00029358401721436074, -0.340650108849162, -0.406412194824835, -0.1981002321348618, 0.5002745533510538], [-0.4130454688670939, 0.47735445739865295, 0.5077298150843699, 0.5540973296076606, 0.1510777246015299, -0.03379117103647037, 0.2810461684360109, 0.20920472330158213, 0.40177528285769115, 0.7592897269574931  …  0.1581838769829487, 0.6449311491248104, 0.4632010598079272, -0.1740190876023655, -0.4083732001570283, 2.1042737568578674e-5, -0.3406146681138543, -0.40633483487845784, -0.19865228479629454, 0.5001995279862698]  …  [-0.7999447529800987, 0.4252379411067219, 0.42441200092997533, 0.26786018161645975, 0.5007458456831302, 0.22799322788408252, 0.6891341485719177, 0.4727968338586305, 2.0680013995049245, -0.3294027680523921  …  -2.180830800553996, 6.593351772090997, 3.2253952957152343, -2.980278498851132, -4.966052893725419, -3.813681840740948, -3.736894403606665, -3.246732522130093, 0.7883473611625863, 0.9055541094911028], [-0.7768342753957604, 0.428277633462092, 0.4117943116028931, 0.21743757833807664, 0.5307215248511508, 0.18206471464553534, 0.6797171052731031, 0.4645070876163489, 2.0390446208835344, -0.3139167433227463  …  -2.236423898582901, 6.575727137382542, 3.13807753744974, -2.9821103797351554, -4.98839805063778, -3.82563970033756, -3.683530144190037, -3.1206810743073388, 0.6490394503106589, 1.0189086013381987], [-0.7993564079849468, 0.42481022756453174, 0.3921701894439823, 0.21994536913127252, 0.5400376580133569, 0.18446431189643692, 0.6833824580608931, 0.4607768652626297, 2.0619203026366595, -0.3071791666173703  …  -2.2564612659927517, 6.63070420514344, 3.0915379232180413, -2.972181164482201, -4.943097460026573, -3.81506133717435, -3.6576238746633734, -3.145015597939041, 0.6915112809305419, 1.0368475967901878], [-0.751398445559296, 0.42315559297476696, 0.3768959555081032, 0.20785713218928215, 0.54276784204591, 0.16530816892987085, 0.6584099021080851, 0.45487489659780306, 1.969200988510455, -0.3393152852573287  …  -2.1936480521315844, 6.5617441688844815, 3.0019453011262, -2.998635488953422, -4.917446871712326, -3.7829920864231594, -3.638076903876079, -3.0114356598213705, 0.6682059291691465, 1.0413162811032686], [-0.6981211555981431, 0.4003718356978268, 0.3643462981231118, 0.16501210019422116, 0.45457169766643457, 0.1294956336686239, 0.6580134183836438, 0.4915536501190992, 1.8787236066175383, -0.23272246684505785  …  -2.3331259466324754, 6.661329489391394, 3.0041744976128, -2.8906587658495093, -4.8686431743373815, -3.81251548708737, -3.6298547479050502, -3.235303710228387, 0.7797197706180925, 0.9835038506842414], [-0.7350206692261084, 0.40263659063793295, 0.38834445872543105, 0.16499254887347214, 0.5533336114877103, 0.12467911999272568, 0.6479068044421008, 0.47803951358504515, 1.9301047336626143, -0.3086241724295743  …  -2.3961428548436183, 6.589335854543248, 3.0491391536424137, -2.7598673530554363, -4.758115925912599, -3.8270040515495167, -3.5166697990277087, -3.2184070450205797, 0.7992441181041062, 0.8947154784854828], [-0.7230554536677063, 0.3950459308548548, 0.38622268162999035, 0.16746408888779182, 0.5354001285571958, 0.12836154070509684, 0.6502404908727695, 0.49421199774359986, 1.9369857465972666, -0.27909407594031127  …  -2.417574291672304, 6.6052514843588535, 3.0401902117508905, -2.7458937633002707, -4.722979978490853, -3.8116039043594605, -3.503203732456693, -3.1940568760552006, 0.8335563145401769, 0.8883851541205318], [-0.7315223642344184, 0.3965150741550391, 0.40107388376442493, 0.1666151006060467, 0.5678976291938086, 0.13157723496829685, 0.6333010852231571, 0.47783480852977556, 1.9319311406231856, -0.257469107571608  …  -2.370198491133192, 6.586120281983001, 3.027725429744437, -2.757843954590649, -4.754165097978458, -3.8155217613510146, -3.4992249698092404, -3.241831626698388, 0.8101092201212633, 0.906625418360468], [-0.7139193433104933, 0.41990020180247994, 0.3924210321175192, 0.15376615508561692, 0.5550699586529999, 0.11513882050231078, 0.6469373990283982, 0.4880210019189817, 1.9010487211599338, -0.31191885150204157  …  -2.346516500022896, 6.632766033398962, 3.0013131296933024, -2.7397828983807977, -4.767766126358522, -3.7156683048099204, -3.409561745422, -3.325761340547705, 0.8141917955420783, 0.9085111686756515], [-0.6849205811746308, 0.42625384959164386, 0.39028321398292287, 0.15579376480416948, 0.5265853326648706, 0.1166635853987466, 0.6495113621512348, 0.4823927234428915, 1.8129192421287907, -0.29840664588590976  …  -2.2939315886766556, 6.743893861296434, 2.9032916096551378, -2.78112194131294, -4.736123400609432, -3.647465220506168, -3.419239394422164, -3.31605144444226, 0.8323496154392577, 0.9135951811190464]], NamedTuple[(n_steps = 3, is_accept = true, acceptance_rate = 0.6666666666666666, log_density = -1.6695046767651597e6, hamiltonian_energy = 1.7371083771757754e6, hamiltonian_energy_error = -17259.481023763306, max_hamiltonian_energy_error = -17259.481023763306, tree_depth = 1, numerical_error = true, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6695046767651597e6, hamiltonian_energy = 1.6695471867615902e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 8.463288915512129e30, tree_depth = 0, numerical_error = true, step_size = 0.012261299907089943, nom_step_size = 0.012261299907089943, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6695046767651597e6, hamiltonian_energy = 1.6695580476864201e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 10125.028542188462, tree_depth = 0, numerical_error = true, step_size = 0.001731493674964374, nom_step_size = 0.001731493674964374, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -1.6584101680489238e6, hamiltonian_energy = 1.6695437215945197e6, hamiltonian_energy_error = -14.029815458925441, max_hamiltonian_energy_error = -14.029815458925441, tree_depth = 3, numerical_error = false, step_size = 0.00015413445733897217, nom_step_size = 0.00015413445733897217, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.648890341285568e6, hamiltonian_energy = 1.6584441560617734e6, hamiltonian_energy_error = -6.621974818408489, max_hamiltonian_energy_error = -6.621974818408489, tree_depth = 2, numerical_error = false, step_size = 0.0001955224279177154, nom_step_size = 0.0001955224279177154, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.24806462642174593, log_density = -1.6464888071110395e6, hamiltonian_energy = 1.6489559516715752e6, hamiltonian_energy_error = 0.4142088848166168, max_hamiltonian_energy_error = 52.707343749236315, tree_depth = 3, numerical_error = false, step_size = 0.00029335853051706134, nom_step_size = 0.00029335853051706134, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9992811405413686, log_density = -1.6455336683284836e6, hamiltonian_energy = 1.6465459935276762e6, hamiltonian_energy_error = -0.008216690504923463, max_hamiltonian_energy_error = -0.00825308496132493, tree_depth = 3, numerical_error = false, step_size = 4.862775821968103e-5, nom_step_size = 4.862775821968103e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9590629032139958, log_density = -1.6453357023098234e6, hamiltonian_energy = 1.6455805008395822e6, hamiltonian_energy_error = -0.0003896190319210291, max_hamiltonian_energy_error = 0.10005838121287525, tree_depth = 3, numerical_error = false, step_size = 8.216592138540386e-5, nom_step_size = 8.216592138540386e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.3967272162792253, log_density = -1.6434996166944054e6, hamiltonian_energy = 1.6453875681972874e6, hamiltonian_energy_error = 0.10136154131032526, max_hamiltonian_energy_error = 8.194714330136776, tree_depth = 4, numerical_error = false, step_size = 0.00012876206112668738, nom_step_size = 0.00012876206112668738, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9918787852222363, log_density = -1.6431660186906098e6, hamiltonian_energy = 1.643544291560039e6, hamiltonian_energy_error = 0.006652336334809661, max_hamiltonian_energy_error = 0.020190321374684572, tree_depth = 3, numerical_error = false, step_size = 3.5207781237069804e-5, nom_step_size = 3.5207781237069804e-5, is_adapt = true)  …  (n_steps = 1023, is_accept = true, acceptance_rate = 0.972921809833702, log_density = -3567.7054012420713, hamiltonian_energy = 3622.6945871789167, hamiltonian_energy_error = 0.04662793680336108, max_hamiltonian_energy_error = 0.08816456305248721, tree_depth = 10, numerical_error = false, step_size = 0.0001147812750797723, nom_step_size = 0.0001147812750797723, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9851747984251628, log_density = -3552.547155519815, hamiltonian_energy = 3623.2248440751964, hamiltonian_energy_error = 0.0739700047693077, max_hamiltonian_energy_error = -0.12754977608165063, tree_depth = 10, numerical_error = false, step_size = 0.0001147812750797723, nom_step_size = 0.0001147812750797723, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9925247487753392, log_density = -3548.9372539713772, hamiltonian_energy = 3614.9993208099263, hamiltonian_energy_error = -0.014006431733378122, max_hamiltonian_energy_error = -0.17964871467711419, tree_depth = 10, numerical_error = false, step_size = 0.0001147812750797723, nom_step_size = 0.0001147812750797723, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9997287068540147, log_density = -3541.720584137967, hamiltonian_energy = 3605.5538923672243, hamiltonian_energy_error = -0.02769224528765335, max_hamiltonian_energy_error = -0.1785839879598825, tree_depth = 10, numerical_error = false, step_size = 0.0001147812750797723, nom_step_size = 0.0001147812750797723, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9942708685587585, log_density = -3522.783287527586, hamiltonian_energy = 3596.7105067716107, hamiltonian_energy_error = -0.07461202068270723, max_hamiltonian_energy_error = -0.1677978699462983, tree_depth = 10, numerical_error = false, step_size = 0.0001147812750797723, nom_step_size = 0.0001147812750797723, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9970950634919684, log_density = -3514.098251893576, hamiltonian_energy = 3581.1618420842065, hamiltonian_energy_error = -0.06621378404406641, max_hamiltonian_energy_error = -0.12179296792874084, tree_depth = 10, numerical_error = false, step_size = 0.0001147812750797723, nom_step_size = 0.0001147812750797723, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9981491031051406, log_density = -3512.1339239320437, hamiltonian_energy = 3561.205017371383, hamiltonian_energy_error = -0.008006530101738463, max_hamiltonian_energy_error = -0.05304947300101048, tree_depth = 10, numerical_error = false, step_size = 0.0001147812750797723, nom_step_size = 0.0001147812750797723, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.8977107694405418, log_density = -3518.2473702971347, hamiltonian_energy = 3570.6245284929587, hamiltonian_energy_error = 0.013454133218601783, max_hamiltonian_energy_error = 0.289037590307089, tree_depth = 10, numerical_error = false, step_size = 0.0001147812750797723, nom_step_size = 0.0001147812750797723, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9585400912884056, log_density = -3514.9125398430797, hamiltonian_energy = 3573.4967969522886, hamiltonian_energy_error = 0.11561267711431356, max_hamiltonian_energy_error = 0.12057495763338011, tree_depth = 10, numerical_error = false, step_size = 0.0001147812750797723, nom_step_size = 0.0001147812750797723, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9811421493370175, log_density = -3512.6902253566495, hamiltonian_energy = 3565.654059755205, hamiltonian_energy_error = -0.06244466358793943, max_hamiltonian_energy_error = -0.17902994417363516, tree_depth = 10, numerical_error = false, step_size = 0.0001147812750797723, nom_step_size = 0.0001147812750797723, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-3.98 ± 0.017, -3.98 ± 0.017, -3.98 ± 0.017, -3.98 ± 0.017, -3.98 ± 0.017, -3.98 ± 0.017, -3.98 ± 0.017, -3.98 ± 0.017, -3.98 ± 0.017, -3.98 ± 0.017  …  -4.0 ± 0.031, -4.0 ± 0.031, -4.0 ± 0.031, -4.0 ± 0.031, -4.0 ± 0.031, -4.0 ± 0.031, -4.0 ± 0.031, -4.0 ± 0.031, -4.0 ± 0.031, -4.0 ± 0.031]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.742 ± 0.045 1.85 ± 0.16; 0.436 ± 0.038 -0.251 ± 0.078; … ; 0.679 ± 0.028 -1.15 ± 0.089; 0.472 ± 0.015 -1.13 ± 0.067], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.0391 ± 0.072; -0.333 ± 0.065; … ; -0.893 ± 0.15; 0.817 ± 0.037;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.902 ± 0.11 0.478 ± 0.19 … 0.0526 ± 0.13 -1.37 ± 0.17; 0.646 ± 0.19 -1.57 ± 0.15 … -1.26 ± 0.16 1.72 ± 0.26; … ; -0.778 ± 0.16 -0.235 ± 0.12 … 0.184 ± 0.15 -0.519 ± 0.083; 0.533 ± 0.1 -0.867 ± 0.16 … -0.355 ± 0.12 -0.887 ± 0.053], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.262 ± 0.084; -2.07 ± 0.13; … ; 0.0309 ± 0.21; -0.722 ± 0.099;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-2.29 ± 0.097 6.67 ± 0.076 … -3.7 ± 0.14 -3.22 ± 0.097], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.855 ± 0.13;;]))], MonteCarloMeasurements.Particles{Float64, 34}[1.0 ± 0.078], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="ed0eae22.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Friday 15 March 2024 02:39">Friday 15 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
