<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/complex/">Complex Equations with PINNs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+
                        randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                        noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -4.08307180132837
 -4.35953972525253
 -4.077452476694657
 -4.194034969691686
 -3.91463002734417
 -4.165578191821746
 -3.960341570030445
 -4.084800787158287
 -3.794023629875583
 -3.4544068429236323
  ⋮
 -4.216363866754288
 -4.030818102845207
 -3.8843525548495705
 -4.094902452677021
 -3.97820374675417
 -4.076262705253521
 -4.325212381645281
 -4.072715016455459
 -3.7030415642568317</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title = &quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="8f1eb578.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[-0.4378847453832239, 0.7457392195266559, -0.6123676950509214, -0.4685227924655801, -0.17749576314821536, 0.5438025379223902, 0.16989656426657068, -0.6936203573123693, -0.6151831575056093, 0.41324710174840806  …  0.3042919884131952, 0.2772852938384148, -0.547623982570804, -0.25044560489800827, 0.1382512168826287, 0.11919379846915698, 0.47459122321418146, 0.8255271532516613, -0.17215219631240433, 0.5016940986684677], [-0.4378847453832239, 0.7457392195266559, -0.6123676950509214, -0.4685227924655801, -0.17749576314821536, 0.5438025379223902, 0.16989656426657068, -0.6936203573123693, -0.6151831575056093, 0.41324710174840806  …  0.3042919884131952, 0.2772852938384148, -0.547623982570804, -0.25044560489800827, 0.1382512168826287, 0.11919379846915698, 0.47459122321418146, 0.8255271532516613, -0.17215219631240433, 0.5016940986684677], [-0.4378847453832239, 0.7457392195266559, -0.6123676950509214, -0.4685227924655801, -0.17749576314821536, 0.5438025379223902, 0.16989656426657068, -0.6936203573123693, -0.6151831575056093, 0.41324710174840806  …  0.3042919884131952, 0.2772852938384148, -0.547623982570804, -0.25044560489800827, 0.1382512168826287, 0.11919379846915698, 0.47459122321418146, 0.8255271532516613, -0.17215219631240433, 0.5016940986684677], [-0.4371580392482004, 0.7457683682841314, -0.6036896506149053, -0.4497782078485201, -0.17007089146923826, 0.5160504642799006, 0.1749247154376527, -0.7016097345361189, -0.6047404605945355, 0.3993964935337123  …  0.3708146268662443, 0.3629705749746017, -0.6062695883250816, -0.2772302247980779, 0.14659421666587302, 0.09097497577033849, 0.5407163319996958, 0.7783811149565539, -0.3018566315019451, 0.5018705274387986], [-0.4371580392482004, 0.7457683682841314, -0.6036896506149053, -0.4497782078485201, -0.17007089146923826, 0.5160504642799006, 0.1749247154376527, -0.7016097345361189, -0.6047404605945355, 0.3993964935337123  …  0.3708146268662443, 0.3629705749746017, -0.6062695883250816, -0.2772302247980779, 0.14659421666587302, 0.09097497577033849, 0.5407163319996958, 0.7783811149565539, -0.3018566315019451, 0.5018705274387986], [-0.43709943176300625, 0.7458503036087814, -0.6036059414806814, -0.4499116309023344, -0.17010500923969762, 0.5160223943432127, 0.17485946563651542, -0.701603868877716, -0.6048287949284415, 0.3993057799654695  …  0.371081500869181, 0.3630967458812826, -0.6066507043567518, -0.277280954649341, 0.14674583835583505, 0.09086688927222518, 0.5408771433890796, 0.7783940002673281, -0.30231571517461614, 0.5017414197369507], [-0.43694371703296025, 0.7456522277951275, -0.6030827082693163, -0.4499625395204613, -0.16993397191511236, 0.5152229762537938, 0.1740151758839983, -0.7018193079641923, -0.6052107049544936, 0.39920809343969255  …  0.3731396430552345, 0.36432733068742884, -0.6092992399806055, -0.2765482663665812, 0.14756095679705955, 0.09033018239793388, 0.542008130129569, 0.7783055368452519, -0.3045772229735716, 0.5013853351669688], [-0.436855159872647, 0.7455421193177084, -0.603135857660776, -0.4499869885011976, -0.1699535734344541, 0.5151015551466549, 0.1740314255986617, -0.7018534371055737, -0.6051835335406187, 0.39916575077493177  …  0.3732848872572718, 0.3645401003850066, -0.6096324858858798, -0.2765648943223048, 0.14762468010893864, 0.09038961140228667, 0.5421337333248507, 0.7783180486905312, -0.30494048162770726, 0.5013498717003861], [-0.4220858267100162, 0.7376074327645366, -0.5311901628164168, -0.517510897195694, -0.19681243548275343, 0.4670856983394839, 0.12736192156172102, -0.6855494036656351, -0.6022338316583237, 0.36164653923720247  …  0.8354258150227837, 0.5956702895469094, -1.2019638578762266, -0.2309463712826674, 0.32096824666114376, -0.029556538813533546, 0.8680062635403287, 0.8990830497272396, -0.7994120481825387, 0.5043981987121366], [-0.4222471057772882, 0.737614927780483, -0.5313972927884385, -0.5181883191003123, -0.19691998670296745, 0.46742540984684733, 0.1274622951100621, -0.6856416206450746, -0.6022641323964668, 0.3617587080051406  …  0.8362084115775645, 0.595837070250686, -1.2026764989658303, -0.23107185190625268, 0.32115513314084404, -0.029690955819797832, 0.868503729897411, 0.8993807527844206, -0.7997091707846902, 0.5044379109486177]  …  [-0.6564544277159695, 0.7316154795051503, -0.7101381881617604, -0.6864270253060959, -0.4656755783107859, 0.6740930613556638, 0.21737515786466227, -0.5440843537302298, -0.43934441375879807, 0.3722529046835453  …  1.8526721804296673, 1.2084741292453494, -2.317033131388049, -0.5417573529487512, 0.7493118428822075, -0.3254197849284128, 1.7670710180274922, 1.587551588648541, -0.6584555000434844, 0.5007047476314443], [-0.6578559817839581, 0.732250502499535, -0.7105035295116726, -0.68625061881306, -0.46635185950270885, 0.6746389905385591, 0.21712589278394545, -0.5432620749243372, -0.43889527573216647, 0.37221066756471144  …  1.854282791672201, 1.209383422387516, -2.3184744228376846, -0.5430290922777248, 0.7501129554299141, -0.32675267019344295, 1.768423734385665, 1.5892663869194734, -0.65753537727844, 0.5003829588082287], [-0.6594530529463613, 0.7321795324728654, -0.7110247623603897, -0.6859224671567732, -0.46682750084006147, 0.674620575509567, 0.21679664733813742, -0.5428906298006662, -0.43821027974965143, 0.3722143709113775  …  1.855572102077139, 1.2104984005164379, -2.319921346952637, -0.5432957842289721, 0.7513017685359373, -0.32786112259894534, 1.7701504426486134, 1.5902292931440283, -0.6560086218915233, 0.4997667211729686], [-0.6608030499114909, 0.7309834836964367, -0.711773364368915, -0.6856655007447462, -0.46865895015502235, 0.6752126629283495, 0.2166493203952362, -0.5421423920026449, -0.4363342655305142, 0.3722287444598046  …  1.8571799538525162, 1.2121007138400308, -2.322443451779992, -0.5454192203391636, 0.7525442693677769, -0.3286129140885702, 1.773068871820744, 1.593002404105219, -0.6537581946520253, 0.4992816856437064], [-0.66094310177134, 0.7312012890326158, -0.7116880207706052, -0.685588895321877, -0.4689392585086048, 0.6753664875797303, 0.21660614417045884, -0.5422719056980315, -0.43601799925463325, 0.3723187399353451  …  1.8570149444935886, 1.212412211448516, -2.3228644924163584, -0.5458391669808692, 0.7527930535774734, -0.3289476036772264, 1.7734135700866764, 1.593177601895105, -0.6536264344264311, 0.4995710329057344], [-0.6633072767703195, 0.7324321751997236, -0.7124329454847859, -0.6851954097331293, -0.4719567747111247, 0.6767272081769826, 0.21576914676115264, -0.5410273232974337, -0.43436037222698265, 0.3727058949223265  …  1.860703031431484, 1.2165011857612138, -2.3274209487144164, -0.5479840033277624, 0.7570425983312487, -0.33074795772828863, 1.7775821563166234, 1.596641827086289, -0.6502049628476663, 0.4992466681808235], [-0.8399817168615867, 0.7644901089267426, -0.7339271742756209, -0.6363356549413486, -0.6210924303478683, 0.7642175239161871, 0.21921449182018504, -0.4564751718209526, -0.3020469317251079, 0.39244823721235605  …  2.1057179356628746, 1.4171906705041444, -2.5522776844570907, -0.7131969198460235, 0.9428503169953316, -0.4605999303444338, 1.9854443393345673, 1.8253972381035684, -0.4622440905060797, 0.46248580341753665], [-0.8382111579138029, 0.7626466568756071, -0.7295731833479737, -0.6330494526281873, -0.6165747742344253, 0.7671471419271049, 0.22363700281785182, -0.45812748373358586, -0.29901952028176393, 0.3926190425343807  …  2.1142555747245506, 1.4181734164278506, -2.5593849300076217, -0.7156569810178279, 0.9483958573000927, -0.4650861021589688, 1.9894436379047111, 1.8333047946750105, -0.45678303412797006, 0.4600318816788711], [-0.8381208341571272, 0.7627861641852126, -0.729770674655184, -0.6329141495721599, -0.6162905812941257, 0.7674706918519882, 0.22404169938263707, -0.4581132399107821, -0.29869718246024307, 0.392516146977549  …  2.114810001181346, 1.4186605055429244, -2.5598497018540494, -0.716018751074094, 0.9488859660620971, -0.4652603355650665, 1.9894789559799666, 1.833808024953344, -0.45640928453387614, 0.459673899694919], [-0.8378216636311964, 0.762095615150298, -0.728934044660853, -0.6318846044122897, -0.6157671043621467, 0.7682039374238232, 0.2264139366645764, -0.459425453385265, -0.29738226288310154, 0.39158570609443777  …  2.115774728704863, 1.4198546782666361, -2.5612804737336545, -0.7172132827893801, 0.9512113312908231, -0.4674650849745905, 1.9905759226923352, 1.8368866631760403, -0.45417357130607133, 0.45953316246548326]], NamedTuple[(n_steps = 1, is_accept = true, acceptance_rate = 1.0, log_density = -1.6424837739335138e6, hamiltonian_energy = 1.7721766818875938e6, hamiltonian_energy_error = -55692.75896576722, max_hamiltonian_energy_error = -55692.75896576722, tree_depth = 1, numerical_error = false, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6424837739335138e6, hamiltonian_energy = 1.642535619111006e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 7.179555467390256e39, tree_depth = 0, numerical_error = true, step_size = 0.022477359524651217, nom_step_size = 0.022477359524651217, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6424837739335138e6, hamiltonian_energy = 1.642548834855059e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 2.591978832345308e6, tree_depth = 0, numerical_error = true, step_size = 0.003798698975534599, nom_step_size = 0.003798698975534599, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -1.5440815188902572e6, hamiltonian_energy = 1.6423908530975785e6, hamiltonian_energy_error = -147.17654171702452, max_hamiltonian_energy_error = -147.17654171702452, tree_depth = 3, numerical_error = false, step_size = 0.00037467407115379783, nom_step_size = 0.00037467407115379783, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.216294449408765e-47, log_density = -1.5440815188902572e6, hamiltonian_energy = 1.54411734939615e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 415.3132737581618, tree_depth = 2, numerical_error = false, step_size = 0.00050676938898118, nom_step_size = 0.00050676938898118, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9645680859363152, log_density = -1.5437791625405871e6, hamiltonian_energy = 1.5441273344562608e6, hamiltonian_energy_error = 0.01707331370562315, max_hamiltonian_energy_error = 0.10701483837328851, tree_depth = 3, numerical_error = false, step_size = 4.019648422075262e-5, nom_step_size = 4.019648422075262e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9024987723501534, log_density = -1.5415123969265379e6, hamiltonian_energy = 1.5438376240817958e6, hamiltonian_energy_error = 0.26786791370250285, max_hamiltonian_energy_error = 0.26786791370250285, tree_depth = 3, numerical_error = false, step_size = 5.6644104644161366e-5, nom_step_size = 5.6644104644161366e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.9183993499728693, log_density = -1.5412715943237918e6, hamiltonian_energy = 1.5415627795353527e6, hamiltonian_energy_error = 0.0462188976816833, max_hamiltonian_energy_error = 0.1768813335802406, tree_depth = 2, numerical_error = false, step_size = 7.099543328094071e-5, nom_step_size = 7.099543328094071e-5, is_adapt = true), (n_steps = 63, is_accept = true, acceptance_rate = 0.16748188071419118, log_density = -938400.3201118375, hamiltonian_energy = 1.5412688914496303e6, hamiltonian_energy_error = -41.863621989730746, max_hamiltonian_energy_error = -41.863621989730746, tree_depth = 6, numerical_error = false, step_size = 9.777190690291809e-5, nom_step_size = 9.777190690291809e-5, is_adapt = true), (n_steps = 31, is_accept = true, acceptance_rate = 1.0, log_density = -937560.2581980331, hamiltonian_energy = 938445.362305088, hamiltonian_energy_error = -0.008963567204773426, max_hamiltonian_energy_error = -0.04833052458707243, tree_depth = 5, numerical_error = false, step_size = 1.2944539919052275e-5, nom_step_size = 1.2944539919052275e-5, is_adapt = true)  …  (n_steps = 15, is_accept = true, acceptance_rate = 0.838748891390117, log_density = -204181.4379529604, hamiltonian_energy = 204277.19143273763, hamiltonian_energy_error = 0.1954395097855013, max_hamiltonian_energy_error = 0.5259666106139775, tree_depth = 4, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.9207260287489755, log_density = -203631.28571085012, hamiltonian_energy = 204232.30293584007, hamiltonian_energy_error = -0.4809807865822222, max_hamiltonian_energy_error = -0.5438216406619176, tree_depth = 3, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.8458977576986505, log_density = -203071.71668310187, hamiltonian_energy = 203690.60282045702, hamiltonian_energy_error = 0.4022333686298225, max_hamiltonian_energy_error = 0.42712655683862977, tree_depth = 3, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9197056333655931, log_density = -202164.78682722573, hamiltonian_energy = 203124.01331043872, hamiltonian_energy_error = -0.046321090310811996, max_hamiltonian_energy_error = 0.5241831802704837, tree_depth = 4, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9218225968073989, log_density = -202037.2182132957, hamiltonian_energy = 202208.2237588292, hamiltonian_energy_error = 0.18246934079797938, max_hamiltonian_energy_error = -0.6637601282272954, tree_depth = 4, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9770736604333592, log_density = -200357.97837295404, hamiltonian_energy = 202091.4908178566, hamiltonian_energy_error = 0.06321750138886273, max_hamiltonian_energy_error = -0.8963747110101394, tree_depth = 4, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 63, is_accept = true, acceptance_rate = 1.0, log_density = -128396.25398018688, hamiltonian_energy = 200400.4467952803, hamiltonian_energy_error = -5.429917387838941, max_hamiltonian_energy_error = -6.621029666537652, tree_depth = 6, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9951245435169617, log_density = -126021.16921917131, hamiltonian_energy = 128447.03329263636, hamiltonian_energy_error = -1.0150670696020825, max_hamiltonian_energy_error = -1.3569294027984142, tree_depth = 4, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.9963806301292786, log_density = -125861.33260148198, hamiltonian_energy = 126074.61347401442, hamiltonian_energy_error = -0.1773294627055293, max_hamiltonian_energy_error = -0.5731893818738172, tree_depth = 3, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -125163.61118642264, hamiltonian_energy = 125907.85021050632, hamiltonian_energy_error = -0.31200361224182416, max_hamiltonian_energy_error = -0.31200361224182416, tree_depth = 3, numerical_error = false, step_size = 7.910028957075038e-5, nom_step_size = 7.910028957075038e-5, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-4.04 ± 0.085, -4.04 ± 0.085, -4.04 ± 0.085, -4.04 ± 0.085, -4.04 ± 0.085, -4.04 ± 0.085, -4.04 ± 0.085, -4.04 ± 0.084, -4.04 ± 0.084, -4.04 ± 0.084  …  -3.94 ± 0.068, -3.94 ± 0.068, -3.94 ± 0.068, -3.94 ± 0.068, -3.94 ± 0.068, -3.94 ± 0.068, -3.94 ± 0.067, -3.94 ± 0.067, -3.94 ± 0.067, -3.94 ± 0.067]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.634 ± 0.091 -0.456 ± 0.07; 0.734 ± 0.011 0.371 ± 0.0085; … ; 0.22 ± 0.0035 -0.599 ± 0.1; -0.549 ± 0.038 0.337 ± 0.086], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.099 ± 0.031; -0.132 ± 0.021; … ; 0.439 ± 0.062; -0.702 ± 0.035;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.547 ± 0.0075 -0.389 ± 0.0039 … 0.555 ± 0.05 -0.645 ± 0.037; -0.445 ± 0.0098 0.451 ± 0.022 … 0.578 ± 0.026 0.0623 ± 0.017; … ; -0.164 ± 0.013 -0.25 ± 0.011 … 0.248 ± 0.037 -0.607 ± 0.022; 0.162 ± 0.02 -0.0271 ± 0.018 … -0.444 ± 0.022 -0.0124 ± 0.03], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.668 ± 0.0057; 0.368 ± 0.016; … ; -0.538 ± 0.0049; 0.251 ± 0.019;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[1.81 ± 0.14 1.18 ± 0.11 … 1.73 ± 0.12 1.56 ± 0.13], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.68 ± 0.099;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.498 ± 0.014], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain)
          for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="b552a28d.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Friday 7 June 2024 23:33">Friday 7 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
