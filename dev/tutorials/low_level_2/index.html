<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -3.8411140576536753
 -3.9712152830979024
 -3.8572032220230614
 -3.9332346203111723
 -3.977424328145942
 -4.176105287633848
 -3.774509652532853
 -4.0615108967211135
 -3.9041401237690105
 -3.7691800695186113
  ⋮
 -3.9561326588950774
 -4.330418697126365
 -4.312344987204305
 -4.026915751036384
 -4.218176455744372
 -4.182000947285719
 -3.6717527530455856
 -3.829808173639445
 -3.8675876106468974</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="fd4d7db4.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[-0.2316300158419662, 0.07980656797218448, -0.5111571050527034, -0.7333296863417631, 0.1992014346679571, -0.6246255467509967, 0.09284629446534362, -0.2620393811152684, 0.337319505891296, -0.42167100752748615  …  -0.2036462782232067, 0.30589906716673443, -0.24475604916337845, -0.6138768595890199, -0.034760167525199615, 0.6582879242845248, -0.17184997535701674, 0.28259298901532465, -0.17886118993319222, 0.5005731889488259], [-0.2316300158419662, 0.07980656797218448, -0.5111571050527034, -0.7333296863417631, 0.1992014346679571, -0.6246255467509967, 0.09284629446534362, -0.2620393811152684, 0.337319505891296, -0.42167100752748615  …  -0.2036462782232067, 0.30589906716673443, -0.24475604916337845, -0.6138768595890199, -0.034760167525199615, 0.6582879242845248, -0.17184997535701674, 0.28259298901532465, -0.17886118993319222, 0.5005731889488259], [-0.2316300158419662, 0.07980656797218448, -0.5111571050527034, -0.7333296863417631, 0.1992014346679571, -0.6246255467509967, 0.09284629446534362, -0.2620393811152684, 0.337319505891296, -0.42167100752748615  …  -0.2036462782232067, 0.30589906716673443, -0.24475604916337845, -0.6138768595890199, -0.034760167525199615, 0.6582879242845248, -0.17184997535701674, 0.28259298901532465, -0.17886118993319222, 0.5005731889488259], [-0.23373485042699926, 0.07860093025225472, -0.5107327870489595, -0.7336743156374518, 0.1990835801153142, -0.6250391728766833, 0.09327032794145262, -0.2643222871805278, 0.3411815399244357, -0.4204936221395804  …  -0.19634637102001362, 0.2989185609956656, -0.23749100225473424, -0.6227847701325933, -0.030267149060479785, 0.6589248856644849, -0.17818098137535274, 0.28078727183422014, -0.21062730194212734, 0.5013141787727493], [-0.24139318244320768, 0.07663662286052225, -0.5119828364888431, -0.7327650389456029, 0.19999476652391124, -0.6270938716771121, 0.09397914733519128, -0.26913709791540635, 0.349463706892726, -0.42206189228637964  …  -0.18182757525225846, 0.2865679018252006, -0.22297870247740745, -0.6426778508000787, -0.01869373126907752, 0.6599457999109712, -0.19217340825553808, 0.2784940908472915, -0.2652530833809977, 0.5004611781484738], [-0.24139318244320768, 0.07663662286052225, -0.5119828364888431, -0.7327650389456029, 0.19999476652391124, -0.6270938716771121, 0.09397914733519128, -0.26913709791540635, 0.349463706892726, -0.42206189228637964  …  -0.18182757525225846, 0.2865679018252006, -0.22297870247740745, -0.6426778508000787, -0.01869373126907752, 0.6599457999109712, -0.19217340825553808, 0.2784940908472915, -0.2652530833809977, 0.5004611781484738], [-0.24136330487272586, 0.07660993442890403, -0.5119120429220887, -0.7328325423966346, 0.20012646788691674, -0.6270462473499311, 0.09395924313643707, -0.26915316411125795, 0.3494257303220121, -0.42204960157926474  …  -0.1817403397264348, 0.28653888766277663, -0.22289214042596864, -0.6427052866039767, -0.018633504096025013, 0.6598644501992706, -0.19221023668216464, 0.2785417578019451, -0.26550690419587725, 0.5005233536936435], [-0.24348029808100302, 0.07290876351365745, -0.5121344747542962, -0.7322725230758026, 0.20461678280092352, -0.6279418814796787, 0.09450502580060079, -0.273057904597107, 0.35636320370295566, -0.4211094078965737  …  -0.1734997568319638, 0.28021453473889474, -0.2114677309393752, -0.6566550941676602, -0.011081592960394633, 0.661902927924607, -0.20211290785313268, 0.2789378136192893, -0.3009408074439564, 0.5007613710923565], [-1.3556641881090052, -0.2820549816118268, -0.46724101013542807, -0.4885269321556273, 0.6388493929939504, -0.7043801827896375, 0.43111541009222004, -1.2336770251154818, 0.9975054073890119, -0.4585224161441952  …  0.476420036159129, 0.03961336456617123, 1.4585165721820614, -4.219810413219426, 0.8098274564709618, 2.467547529182425, -2.264980425887107, 0.7344996781008868, -2.5098884708541123, 0.5287456638029686], [-1.354236655489586, -0.28274473737403244, -0.4674473075970911, -0.4895151196462077, 0.636525025039201, -0.704270927542479, 0.4313185381261809, -1.2329314396285669, 0.9974926974520901, -0.45866419161181393  …  0.4768426504682979, 0.038888118712607264, 1.458329639719064, -4.2186791080080805, 0.8096378541137216, 2.467544362273637, -2.2641354463274626, 0.7339587984335482, -2.509480947956598, 0.528601019841174]  …  [-1.2893730939553798, -0.5508013096493997, -0.5779874904387937, -0.6395766521974084, 0.6299127145748948, -0.8988366232714265, 0.570656229182931, -1.3019307894605, 1.301060215755923, -1.0108122389606249  …  1.0859883334507037, 0.10284592612729779, 1.845712455963553, -4.366131879439443, 1.1219501144119919, 2.8332975229521757, -2.481029863788813, 1.078795591396271, -2.0924261825027064, 0.5207289323037705], [-1.2893730939553798, -0.5508013096493997, -0.5779874904387937, -0.6395766521974084, 0.6299127145748948, -0.8988366232714265, 0.570656229182931, -1.3019307894605, 1.301060215755923, -1.0108122389606249  …  1.0859883334507037, 0.10284592612729779, 1.845712455963553, -4.366131879439443, 1.1219501144119919, 2.8332975229521757, -2.481029863788813, 1.078795591396271, -2.0924261825027064, 0.5207289323037705], [-1.2894189833854968, -0.5508912215638948, -0.5779217251872054, -0.6396496140941511, 0.6297031760169796, -0.898587213583786, 0.5705986671649144, -1.3016138359145712, 1.3012336391532957, -1.011082902039459  …  1.0860839501023745, 0.10265724157182621, 1.8453861523640391, -4.366372129704252, 1.1219221731151494, 2.8333328714590897, -2.4814271358841715, 1.0789143814401219, -2.091943338068624, 0.5207210899195094], [-1.2894821490649961, -0.550802659755623, -0.5778575200066525, -0.6397691462553718, 0.6297908054438872, -0.8985164763132255, 0.570588031994478, -1.3012135388942303, 1.301128136019053, -1.0112640907968633  …  1.0860142503943155, 0.10290244978733275, 1.8455639335673288, -4.366535193970461, 1.1224327258516849, 2.833341760865312, -2.4812629821535466, 1.0787887027114924, -2.0917962433103536, 0.5205928328868042], [-1.2894821490649961, -0.550802659755623, -0.5778575200066525, -0.6397691462553718, 0.6297908054438872, -0.8985164763132255, 0.570588031994478, -1.3012135388942303, 1.301128136019053, -1.0112640907968633  …  1.0860142503943155, 0.10290244978733275, 1.8455639335673288, -4.366535193970461, 1.1224327258516849, 2.833341760865312, -2.4812629821535466, 1.0787887027114924, -2.0917962433103536, 0.5205928328868042], [-1.2894821490649961, -0.550802659755623, -0.5778575200066525, -0.6397691462553718, 0.6297908054438872, -0.8985164763132255, 0.570588031994478, -1.3012135388942303, 1.301128136019053, -1.0112640907968633  …  1.0860142503943155, 0.10290244978733275, 1.8455639335673288, -4.366535193970461, 1.1224327258516849, 2.833341760865312, -2.4812629821535466, 1.0787887027114924, -2.0917962433103536, 0.5205928328868042], [-1.2894821490649961, -0.550802659755623, -0.5778575200066525, -0.6397691462553718, 0.6297908054438872, -0.8985164763132255, 0.570588031994478, -1.3012135388942303, 1.301128136019053, -1.0112640907968633  …  1.0860142503943155, 0.10290244978733275, 1.8455639335673288, -4.366535193970461, 1.1224327258516849, 2.833341760865312, -2.4812629821535466, 1.0787887027114924, -2.0917962433103536, 0.5205928328868042], [-1.289756866972888, -0.5509891658250575, -0.5779011854234272, -0.6399394334433681, 0.6298507852534804, -0.8983892975429246, 0.5706517532859591, -1.3009126320292117, 1.3012743451172801, -1.0115788306916853  …  1.0863837416738555, 0.10295358280049112, 1.8455985619275679, -4.366530748146666, 1.122887745056511, 2.8337161035086242, -2.4811904119531176, 1.0787989355371317, -2.091591988836892, 0.5203857903170767], [-1.289756866972888, -0.5509891658250575, -0.5779011854234272, -0.6399394334433681, 0.6298507852534804, -0.8983892975429246, 0.5706517532859591, -1.3009126320292117, 1.3012743451172801, -1.0115788306916853  …  1.0863837416738555, 0.10295358280049112, 1.8455985619275679, -4.366530748146666, 1.122887745056511, 2.8337161035086242, -2.4811904119531176, 1.0787989355371317, -2.091591988836892, 0.5203857903170767], [-1.289756866972888, -0.5509891658250575, -0.5779011854234272, -0.6399394334433681, 0.6298507852534804, -0.8983892975429246, 0.5706517532859591, -1.3009126320292117, 1.3012743451172801, -1.0115788306916853  …  1.0863837416738555, 0.10295358280049112, 1.8455985619275679, -4.366530748146666, 1.122887745056511, 2.8337161035086242, -2.4811904119531176, 1.0787989355371317, -2.091591988836892, 0.5203857903170767]], NamedTuple[(n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.686481161905702e6, hamiltonian_energy = 1.7697297709238282e6, hamiltonian_energy_error = -36104.65981845837, max_hamiltonian_energy_error = -36104.65981845837, tree_depth = 2, numerical_error = false, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.686481161905702e6, hamiltonian_energy = 1.6865342130817655e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 5.523422059425726e39, tree_depth = 0, numerical_error = true, step_size = 0.022477359524651217, nom_step_size = 0.022477359524651217, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.686481161905702e6, hamiltonian_energy = 1.6865350170554474e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 84074.27620246937, tree_depth = 0, numerical_error = true, step_size = 0.003798698975534599, nom_step_size = 0.003798698975534599, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.6772955050696337e6, hamiltonian_energy = 1.6865073883156667e6, hamiltonian_energy_error = -19.556153731420636, max_hamiltonian_energy_error = -19.556153731420636, tree_depth = 2, numerical_error = false, step_size = 0.00037467407115379783, nom_step_size = 0.00037467407115379783, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.66109287859384e6, hamiltonian_energy = 1.6773227112669447e6, hamiltonian_energy_error = -32.69239188218489, max_hamiltonian_energy_error = -32.69239188218489, tree_depth = 2, numerical_error = false, step_size = 0.00050676938898118, nom_step_size = 0.00050676938898118, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 8.554238471137565e-5, log_density = -1.66109287859384e6, hamiltonian_energy = 1.6611500013815302e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 159.12181169283576, tree_depth = 2, numerical_error = false, step_size = 0.0007925087166392931, nom_step_size = 0.0007925087166392931, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9943842941907213, log_density = -1.6610294825400393e6, hamiltonian_energy = 1.6611531731729775e6, hamiltonian_energy_error = 0.0014247139915823936, max_hamiltonian_energy_error = 0.025760491844266653, tree_depth = 4, numerical_error = false, step_size = 6.315155499559192e-5, nom_step_size = 6.315155499559192e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9280840335230558, log_density = -1.650250558693752e6, hamiltonian_energy = 1.661099086881102e6, hamiltonian_energy_error = 0.36369391926564276, max_hamiltonian_energy_error = 0.36369391926564276, tree_depth = 4, numerical_error = false, step_size = 0.00010554910101950707, nom_step_size = 0.00010554910101950707, is_adapt = true), (n_steps = 122, is_accept = true, acceptance_rate = 0.45967909901627546, log_density = -683768.2001373981, hamiltonian_energy = 1.6473472694125227e6, hamiltonian_energy_error = -2961.9166381026153, max_hamiltonian_energy_error = 7406.071406694828, tree_depth = 6, numerical_error = true, step_size = 0.0001504246421533316, nom_step_size = 0.0001504246421533316, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -672761.1244709846, hamiltonian_energy = 683669.2298208454, hamiltonian_energy_error = -163.14919965493027, max_hamiltonian_energy_error = -163.14919965493027, tree_depth = 2, numerical_error = false, step_size = 5.021483670719728e-5, nom_step_size = 5.021483670719728e-5, is_adapt = true)  …  (n_steps = 7, is_accept = true, acceptance_rate = 0.2488493159279721, log_density = -93717.18436412538, hamiltonian_energy = 93807.37877286515, hamiltonian_energy_error = -0.1285977665829705, max_hamiltonian_energy_error = 149.83466223831056, tree_depth = 3, numerical_error = false, step_size = 0.00018342021517129127, nom_step_size = 0.00018342021517129127, is_adapt = false), (n_steps = 6, is_accept = true, acceptance_rate = 0.008504744522074028, log_density = -93717.18436412538, hamiltonian_energy = 93766.74445652433, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 2.315606915783344e6, tree_depth = 2, numerical_error = true, step_size = 0.00018342021517129127, nom_step_size = 0.00018342021517129127, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.06193657594292782, log_density = -93686.22941730934, hamiltonian_energy = 93773.61104059561, hamiltonian_energy_error = 1.0520214771822793, max_hamiltonian_energy_error = 357.50516860843345, tree_depth = 3, numerical_error = false, step_size = 0.00018342021517129127, nom_step_size = 0.00018342021517129127, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.24747905164892955, log_density = -93645.5942816799, hamiltonian_energy = 93730.4858528269, hamiltonian_energy_error = -1.3357822617981583, max_hamiltonian_energy_error = 312.66614442435093, tree_depth = 3, numerical_error = false, step_size = 0.00018342021517129127, nom_step_size = 0.00018342021517129127, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.10063115774385424, log_density = -93645.5942816799, hamiltonian_energy = 93690.72182247923, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 75.26106396679825, tree_depth = 3, numerical_error = false, step_size = 0.00018342021517129127, nom_step_size = 0.00018342021517129127, is_adapt = false), (n_steps = 6, is_accept = true, acceptance_rate = 0.011430971968830674, log_density = -93645.5942816799, hamiltonian_energy = 93698.17772638492, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1253.9987265973032, tree_depth = 2, numerical_error = true, step_size = 0.00018342021517129127, nom_step_size = 0.00018342021517129127, is_adapt = false), (n_steps = 5, is_accept = true, acceptance_rate = 0.055154948035577, log_density = -93645.5942816799, hamiltonian_energy = 93696.53475056279, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1674.4790561199334, tree_depth = 2, numerical_error = true, step_size = 0.00018342021517129127, nom_step_size = 0.00018342021517129127, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.3727018900523439, log_density = -93604.5299427576, hamiltonian_energy = 93706.86407150727, hamiltonian_energy_error = 0.19011290682828985, max_hamiltonian_energy_error = 82.63602745745447, tree_depth = 3, numerical_error = false, step_size = 0.00018342021517129127, nom_step_size = 0.00018342021517129127, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.23976443776159675, log_density = -93604.5299427576, hamiltonian_energy = 93651.12207439274, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 38.05425827697036, tree_depth = 3, numerical_error = false, step_size = 0.00018342021517129127, nom_step_size = 0.00018342021517129127, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.16077295430059552, log_density = -93604.5299427576, hamiltonian_energy = 93658.23098551371, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1012.4034739680064, tree_depth = 2, numerical_error = true, step_size = 0.00018342021517129127, nom_step_size = 0.00018342021517129127, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-3.91 ± 0.021, -3.91 ± 0.021, -3.91 ± 0.021, -3.91 ± 0.021, -3.91 ± 0.021, -3.91 ± 0.021, -3.91 ± 0.021, -3.91 ± 0.021, -3.91 ± 0.021, -3.91 ± 0.021  …  -4.11 ± 0.0055, -4.11 ± 0.0055, -4.11 ± 0.0055, -4.11 ± 0.0055, -4.11 ± 0.0055, -4.11 ± 0.0055, -4.11 ± 0.0055, -4.11 ± 0.0055, -4.11 ± 0.0055, -4.11 ± 0.0055]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-1.29 ± 0.0057 1.29 ± 0.02; -0.544 ± 0.015 -1.0 ± 0.021; … ; 0.571 ± 0.0014 -0.211 ± 0.0036; -1.31 ± 0.022 0.234 ± 0.024], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.686 ± 0.034; -0.203 ± 0.014; … ; 0.19 ± 0.0026; -0.832 ± 0.0019;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.702 ± 0.00088 -0.0625 ± 0.0039 … 0.64 ± 0.0017 -0.56 ± 0.0039; -0.223 ± 0.002 0.275 ± 0.00049 … -0.133 ± 0.002 -0.202 ± 0.0014; … ; -0.823 ± 0.0023 -0.578 ± 0.011 … 0.0895 ± 0.0044 0.849 ± 0.00056; 0.763 ± 0.008 0.364 ± 0.0047 … -0.496 ± 0.0027 -0.477 ± 0.01], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.0391 ± 0.0011; -0.726 ± 0.0025; … ; 0.967 ± 0.0081; -0.749 ± 0.0082;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[1.08 ± 0.006 0.0997 ± 0.0067 … -2.47 ± 0.017 1.07 ± 0.022], bias = MonteCarloMeasurements.Particles{Float64, 34}[-2.1 ± 0.016;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.52 ± 0.00072], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="3cb4270d.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 29 February 2024 12:18">Thursday 29 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
