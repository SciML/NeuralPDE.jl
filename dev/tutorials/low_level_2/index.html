<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -3.995661394426066
 -4.154213882056582
 -3.846795991316263
 -4.269657485045163
 -3.8792229580823694
 -3.8685022000297993
 -3.808687949200167
 -3.520336929548453
 -3.7578409964470016
 -3.7696624266668035
  ⋮
 -4.0726768116213945
 -4.176555545626587
 -3.8323388430095244
 -3.635955375313817
 -3.8840381471604033
 -4.040387858528275
 -3.902896307898779
 -3.659489700122173
 -3.8435699802318855</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="f37e966a.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2), NamedTuple())), bias = ViewAxis(17:24, ShapedAxis((8, 1), NamedTuple())))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8), NamedTuple())), bias = ViewAxis(65:72, ShapedAxis((8, 1), NamedTuple())))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8), NamedTuple())), bias = ViewAxis(9:9, ShapedAxis((1, 1), NamedTuple())))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[0.29323796778186634, 0.4885984040422475, 0.3692099819199632, 0.10921026188686168, -0.150961550200428, 0.49571531223471127, 0.6453285206048147, -0.18398350361463273, -0.3730694473202686, -0.3790784779703529  …  0.5348623042505322, 0.7550025128627595, 0.4379210069274517, -0.0013264551426695626, 0.09691353594359375, 0.05941984214370935, 0.6785448942269825, -0.37910042856551923, -0.04208428388313282, 0.5005790413670729], [0.29323796778186634, 0.4885984040422475, 0.3692099819199632, 0.10921026188686168, -0.150961550200428, 0.49571531223471127, 0.6453285206048147, -0.18398350361463273, -0.3730694473202686, -0.3790784779703529  …  0.5348623042505322, 0.7550025128627595, 0.4379210069274517, -0.0013264551426695626, 0.09691353594359375, 0.05941984214370935, 0.6785448942269825, -0.37910042856551923, -0.04208428388313282, 0.5005790413670729], [0.29323796778186634, 0.4885984040422475, 0.3692099819199632, 0.10921026188686168, -0.150961550200428, 0.49571531223471127, 0.6453285206048147, -0.18398350361463273, -0.3730694473202686, -0.3790784779703529  …  0.5348623042505322, 0.7550025128627595, 0.4379210069274517, -0.0013264551426695626, 0.09691353594359375, 0.05941984214370935, 0.6785448942269825, -0.37910042856551923, -0.04208428388313282, 0.5005790413670729], [0.37716612491426654, 0.5384290689466382, 0.583075458522431, -0.34102258224392495, -0.8001430597151935, 0.46771473589415724, 0.5127622869185187, -0.6962088770932611, -0.4751590553616727, 0.0010631710608762397  …  1.6908093575401837, 1.5542167909019242, 0.5312929603440674, 0.5130037012123013, 0.53909194328532, -0.1953016319364745, 2.004228794613141, -0.1618217185041407, -1.22435365907923, 0.49513105460609136], [0.3647481368352178, 0.5431440463358339, 0.6169166801140046, -0.34432001215176644, -0.8063817025729972, 0.4879363005470836, 0.542476601407514, -0.6649010436629703, -0.47472880052173766, -0.0018852004524545223  …  1.6914768157580193, 1.5529538874117006, 0.5348827893511868, 0.5188596740262963, 0.5481932569044721, -0.20941356949948037, 2.002130365184661, -0.17858339484989372, -1.208449688528873, 0.4958179447983687], [0.36524733189248865, 0.544777147229505, 0.6232918837256048, -0.34410478077315015, -0.8179498067092758, 0.49338967736163447, 0.5467980902278547, -0.6621136033944697, -0.4744262749259559, -0.002422161286621811  …  1.6925144462496735, 1.5535980247908054, 0.5366199156727935, 0.5234126926997126, 0.5510355704016567, -0.21199969729756177, 2.0024964226785524, -0.18195871405191402, -1.202159473403859, 0.4960406588387245], [0.36784255412725536, 0.5516821897319943, 0.6594525537687006, -0.34393910919369675, -0.8889851836377287, 0.5239089446568317, 0.5694319192677824, -0.6384004383951938, -0.4735416746323921, -0.006748726369830177  …  1.6984831840941992, 1.557877683991335, 0.5468562102056554, 0.5544060023860803, 0.5691965564092605, -0.23021139449696437, 2.0071122980115046, -0.20825598175191615, -1.1614455850976149, 0.4978279918426102], [0.37113037723716585, 0.5580071024022704, 0.6987909838953857, -0.3460994902189072, -0.9644971144515048, 0.5633592514856898, 0.5924369175307532, -0.6105010067003223, -0.473590210173252, -0.015823868197181325  …  1.7185959104849278, 1.575860143600127, 0.5689513558136743, 0.6005584173239734, 0.602861159913543, -0.26475663886094924, 2.026294293844072, -0.25387094525083276, -1.0972133697449415, 0.4999577848597669], [0.3928542708732195, 0.5761145570194489, 0.759741553246126, -0.34194058020252116, -1.0154151018776716, 0.6658587647920272, 0.6298699499650692, -0.6346168053232759, -0.4896862844360667, -0.043407373345059355  …  1.802273769101096, 1.66489874947973, 0.657351130169215, 0.7214264020738598, 0.7202701512773374, -0.39307815847756805, 2.1262961077626157, -0.4054676790559891, -0.931270888461149, 0.5058315600807932], [0.3928542708732195, 0.5761145570194489, 0.759741553246126, -0.34194058020252116, -1.0154151018776716, 0.6658587647920272, 0.6298699499650692, -0.6346168053232759, -0.4896862844360667, -0.043407373345059355  …  1.802273769101096, 1.66489874947973, 0.657351130169215, 0.7214264020738598, 0.7202701512773374, -0.39307815847756805, 2.1262961077626157, -0.4054676790559891, -0.931270888461149, 0.5058315600807932]  …  [0.4556166603753078, 0.6184357308165895, 0.7290326568123374, -0.41493801500899596, -1.0327835112051387, 0.8785122564459863, 0.6575868977963037, -0.7231183219230354, -0.5337582817083419, -0.1587575674634934  …  1.9869861056754128, 1.8617620120725793, 0.8491213402700634, 0.9436210072273101, 0.9222136503850421, -0.6206570054444349, 2.330364431396204, -0.6967629937069928, -0.7041072468592499, 0.5009688520926494], [0.4556166603753078, 0.6184357308165895, 0.7290326568123374, -0.41493801500899596, -1.0327835112051387, 0.8785122564459863, 0.6575868977963037, -0.7231183219230354, -0.5337582817083419, -0.1587575674634934  …  1.9869861056754128, 1.8617620120725793, 0.8491213402700634, 0.9436210072273101, 0.9222136503850421, -0.6206570054444349, 2.330364431396204, -0.6967629937069928, -0.7041072468592499, 0.5009688520926494], [0.45767715729963043, 0.6178949115442747, 0.7275262429542675, -0.41607379264670885, -1.0332232949262043, 0.8844840182366014, 0.6588060738857326, -0.7242063588077295, -0.5354658741443439, -0.16316913023631877  …  1.9909878866474462, 1.8665514895424158, 0.8535127337317187, 0.9486915237997905, 0.9267641703072591, -0.6270064368276796, 2.336105346760694, -0.7036313205253797, -0.6986095917141357, 0.500874135074686], [0.45767715729963043, 0.6178949115442747, 0.7275262429542675, -0.41607379264670885, -1.0332232949262043, 0.8844840182366014, 0.6588060738857326, -0.7242063588077295, -0.5354658741443439, -0.16316913023631877  …  1.9909878866474462, 1.8665514895424158, 0.8535127337317187, 0.9486915237997905, 0.9267641703072591, -0.6270064368276796, 2.336105346760694, -0.7036313205253797, -0.6986095917141357, 0.500874135074686], [0.45767715729963043, 0.6178949115442747, 0.7275262429542675, -0.41607379264670885, -1.0332232949262043, 0.8844840182366014, 0.6588060738857326, -0.7242063588077295, -0.5354658741443439, -0.16316913023631877  …  1.9909878866474462, 1.8665514895424158, 0.8535127337317187, 0.9486915237997905, 0.9267641703072591, -0.6270064368276796, 2.336105346760694, -0.7036313205253797, -0.6986095917141357, 0.500874135074686], [0.45792248262903346, 0.617686447830364, 0.7273104322637076, -0.41633205731477446, -1.0335732824722554, 0.8861063226008775, 0.6588524100535493, -0.7244960709905824, -0.5363946515835921, -0.163584576554974  …  1.991805234912547, 1.8669492774658318, 0.8544193563113757, 0.9498910481807872, 0.9285482791603781, -0.628173651250659, 2.337709735445046, -0.7056307148746443, -0.6975885540777957, 0.5008352503202617], [0.45792248262903346, 0.617686447830364, 0.7273104322637076, -0.41633205731477446, -1.0335732824722554, 0.8861063226008775, 0.6588524100535493, -0.7244960709905824, -0.5363946515835921, -0.163584576554974  …  1.991805234912547, 1.8669492774658318, 0.8544193563113757, 0.9498910481807872, 0.9285482791603781, -0.628173651250659, 2.337709735445046, -0.7056307148746443, -0.6975885540777957, 0.5008352503202617], [0.45857941463984875, 0.6172368751766746, 0.7273383563111652, -0.41634853451611753, -1.0333813055478935, 0.8876041374873967, 0.658804910808706, -0.72503899620377, -0.5362697712602823, -0.16495035706330619  …  1.993032913595704, 1.8682721240818867, 0.8552518756736525, 0.9516575700593385, 0.9289635106154776, -0.6293017787005155, 2.339102400799863, -0.7072734764484943, -0.696143098479788, 0.5009311426728474], [0.4592635460284334, 0.6173643978007954, 0.7269524868066437, -0.4163162366395761, -1.0330936446409005, 0.8888020818508822, 0.6590094555539479, -0.7251562896561234, -0.5362879776973597, -0.1661380282986299  …  1.9944407143916913, 1.8690966482707674, 0.8566432587635406, 0.9533323756590222, 0.9295308929616624, -0.6303273084148486, 2.3399115269572777, -0.7096892525971888, -0.6951522504130907, 0.5010497097270676], [0.4592635460284334, 0.6173643978007954, 0.7269524868066437, -0.4163162366395761, -1.0330936446409005, 0.8888020818508822, 0.6590094555539479, -0.7251562896561234, -0.5362879776973597, -0.1661380282986299  …  1.9944407143916913, 1.8690966482707674, 0.8566432587635406, 0.9533323756590222, 0.9295308929616624, -0.6303273084148486, 2.3399115269572777, -0.7096892525971888, -0.6951522504130907, 0.5010497097270676]], NamedTuple[(n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -1.7109385962326063e6, hamiltonian_energy = 1.7975661355639787e6, hamiltonian_energy_error = -37146.565283971606, max_hamiltonian_energy_error = -37146.565283971606, tree_depth = 3, numerical_error = false, step_size = 0.00078125, nom_step_size = 0.00078125, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.7109385962326063e6, hamiltonian_energy = 1.7109874367048994e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1.8430894015530497e31, tree_depth = 0, numerical_error = true, step_size = 0.011238679762325607, nom_step_size = 0.011238679762325607, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.7109385962326063e6, hamiltonian_energy = 1.7110058075325121e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 22144.89539424423, tree_depth = 0, numerical_error = true, step_size = 0.0018993494877672993, nom_step_size = 0.0018993494877672993, is_adapt = true), (n_steps = 63, is_accept = true, acceptance_rate = 0.7777948213480266, log_density = -528456.9618245984, hamiltonian_energy = 1.707468721094336e6, hamiltonian_energy_error = -3515.375462104799, max_hamiltonian_energy_error = -3515.375462104799, tree_depth = 6, numerical_error = false, step_size = 0.00018733703557689892, nom_step_size = 0.00018733703557689892, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 1.0, log_density = -498407.61664928484, hamiltonian_energy = 528223.6689759238, hamiltonian_energy_error = -296.0570809894707, max_hamiltonian_energy_error = -296.0616827904014, tree_depth = 4, numerical_error = false, step_size = 0.0001342947386236901, nom_step_size = 0.0001342947386236901, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -491694.02814921504, hamiltonian_energy = 498454.6569139489, hamiltonian_energy_error = -7.509737829619553, max_hamiltonian_energy_error = -7.509737829619553, tree_depth = 2, numerical_error = false, step_size = 0.000204295704909429, nom_step_size = 0.000204295704909429, is_adapt = true), (n_steps = 5, is_accept = true, acceptance_rate = 0.8, log_density = -452195.4761551079, hamiltonian_energy = 491234.9539919901, hamiltonian_energy_error = -510.47994045284577, max_hamiltonian_energy_error = 1798.3232842244324, tree_depth = 2, numerical_error = true, step_size = 0.00034159605692385447, nom_step_size = 0.00034159605692385447, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -412046.0759983499, hamiltonian_energy = 451689.5798146221, hamiltonian_energy_error = -573.0920321273734, max_hamiltonian_energy_error = -573.0920321273734, tree_depth = 3, numerical_error = false, step_size = 0.00032431484069908877, nom_step_size = 0.00032431484069908877, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -336859.482553704, hamiltonian_energy = 411551.5510807687, hamiltonian_energy_error = -557.6021272623329, max_hamiltonian_energy_error = -557.6021272623329, tree_depth = 3, numerical_error = false, step_size = 0.0005896556401941838, nom_step_size = 0.0005896556401941838, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -336859.482553704, hamiltonian_energy = 336914.7945441871, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 27949.84951340896, tree_depth = 0, numerical_error = true, step_size = 0.0010951228581097046, nom_step_size = 0.0010951228581097046, is_adapt = true)  …  (n_steps = 3, is_accept = true, acceptance_rate = 3.3062059498836945e-5, log_density = -227475.31993187446, hamiltonian_energy = 227527.0743845619, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 6592.313175402203, tree_depth = 1, numerical_error = true, step_size = 0.00035741721862144854, nom_step_size = 0.00035741721862144854, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 3.739390931299023e-27, log_density = -227475.31993187446, hamiltonian_energy = 227520.19845864445, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 14289.626467461756, tree_depth = 1, numerical_error = true, step_size = 0.00035741721862144854, nom_step_size = 0.00035741721862144854, is_adapt = false), (n_steps = 4, is_accept = true, acceptance_rate = 0.4896288490706623, log_density = -225273.2764147024, hamiltonian_energy = 227521.89423504105, hamiltonian_energy_error = 0.0423696537327487, max_hamiltonian_energy_error = 2371.235260465037, tree_depth = 2, numerical_error = true, step_size = 0.00035741721862144854, nom_step_size = 0.00035741721862144854, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 0.0005839564850201711, log_density = -225273.2764147024, hamiltonian_energy = 225339.78618815032, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 302.0681442821806, tree_depth = 2, numerical_error = false, step_size = 0.00035741721862144854, nom_step_size = 0.00035741721862144854, is_adapt = false), (n_steps = 2, is_accept = true, acceptance_rate = 3.619208421235438e-30, log_density = -225273.2764147024, hamiltonian_energy = 225323.93191327498, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1517.6863159889763, tree_depth = 1, numerical_error = true, step_size = 0.00035741721862144854, nom_step_size = 0.00035741721862144854, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 0.3333333333333333, log_density = -224707.67746187924, hamiltonian_energy = 225316.9705560547, hamiltonian_energy_error = -2.944071123871254, max_hamiltonian_energy_error = 2173.7655505716684, tree_depth = 1, numerical_error = true, step_size = 0.00035741721862144854, nom_step_size = 0.00035741721862144854, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 9.025604202399337e-5, log_density = -224707.67746187924, hamiltonian_energy = 224759.7513220996, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 566243.9482335086, tree_depth = 1, numerical_error = true, step_size = 0.00035741721862144854, nom_step_size = 0.00035741721862144854, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 0.36126577756929185, log_density = -224164.05668803054, hamiltonian_energy = 224747.5654771892, hamiltonian_energy_error = -0.6946031239058357, max_hamiltonian_energy_error = 150.34434010717086, tree_depth = 2, numerical_error = false, step_size = 0.00035741721862144854, nom_step_size = 0.00035741721862144854, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 0.3807205930002424, log_density = -223634.80839919706, hamiltonian_energy = 224221.11667090587, hamiltonian_energy_error = -0.1251655132509768, max_hamiltonian_energy_error = 102.88699138557422, tree_depth = 2, numerical_error = false, step_size = 0.00035741721862144854, nom_step_size = 0.00035741721862144854, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 3.867932481494537e-8, log_density = -223634.80839919706, hamiltonian_energy = 223689.65209786055, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 4419.86834606374, tree_depth = 1, numerical_error = true, step_size = 0.00035741721862144854, nom_step_size = 0.00035741721862144854, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-3.91 ± 0.0032, -3.91 ± 0.0032, -3.91 ± 0.0032, -3.91 ± 0.0032, -3.91 ± 0.0032, -3.91 ± 0.0032, -3.91 ± 0.0032, -3.91 ± 0.0032, -3.91 ± 0.0032, -3.91 ± 0.0032  …  -4.19 ± 0.0056, -4.19 ± 0.0056, -4.19 ± 0.0056, -4.19 ± 0.0056, -4.19 ± 0.0056, -4.19 ± 0.0056, -4.19 ± 0.0056, -4.19 ± 0.0056, -4.19 ± 0.0056, -4.19 ± 0.0056]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2), NamedTuple())), bias = ViewAxis(17:24, ShapedAxis((8, 1), NamedTuple())))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8), NamedTuple())), bias = ViewAxis(65:72, ShapedAxis((8, 1), NamedTuple())))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8), NamedTuple())), bias = ViewAxis(9:9, ShapedAxis((1, 1), NamedTuple())))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.451 ± 0.006 -0.531 ± 0.004; 0.617 ± 0.00097 -0.151 ± 0.011; … ; 0.657 ± 0.0017 0.276 ± 0.023; -0.72 ± 0.0035 0.752 ± 0.011], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.241 ± 0.00067; 0.878 ± 0.0015; … ; 0.91 ± 0.0022; 1.39 ± 0.0008;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.18 ± 0.00064 0.0105 ± 0.0007 … 0.477 ± 0.0024 0.521 ± 0.0019; -0.348 ± 0.0028 0.0291 ± 0.00099 … 0.194 ± 0.0069 0.771 ± 0.00073; … ; -0.503 ± 0.00052 0.268 ± 0.0027 … 0.952 ± 0.00049 0.648 ± 0.0042; -0.261 ± 0.0035 -0.513 ± 0.00051 … -0.569 ± 0.0018 -0.101 ± 0.0032], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.592 ± 0.0022; -0.803 ± 0.0028; … ; -0.502 ± 0.0043; -0.375 ± 0.004;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[1.98 ± 0.012 1.85 ± 0.014 … 2.32 ± 0.014 -0.684 ± 0.019], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.713 ± 0.013;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.502 ± 0.00088], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="ab6dc673.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Sunday 18 February 2024 18:39">Sunday 18 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
