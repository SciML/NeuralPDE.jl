<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/complex/">Complex Equations with PINNs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -4.211207193185619
 -4.29888033032953
 -4.094012770055007
 -4.069119427750097
 -4.087312576743112
 -3.6798253733626956
 -3.7395008807332952
 -3.7445641281748903
 -3.898252429866313
 -3.7444542459676375
  ⋮
 -3.952790119435675
 -3.7021066607632336
 -4.091509191942176
 -3.7876162525286854
 -4.159521606485818
 -4.102661438370732
 -4.000827946347246
 -4.355289253626608
 -4.058269384931942</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="1ce4a109.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[0.07046940972220658, 0.5594207743279725, -0.7471955667001161, -0.5860697644165077, -0.012658273937132675, 0.1852744659538511, -0.4217178829597412, 0.4486892276422829, -0.4264057410127534, -0.359176116819955  …  -0.21859136340929752, -0.7462819442531666, 0.38775976554635416, -0.8007672903941848, 0.5135411121491024, 0.024801642566275796, -0.3959081932849637, -0.03655789001382095, -0.20560182863029464, 0.4998938494547587], [0.07046940972220658, 0.5594207743279725, -0.7471955667001161, -0.5860697644165077, -0.012658273937132675, 0.1852744659538511, -0.4217178829597412, 0.4486892276422829, -0.4264057410127534, -0.359176116819955  …  -0.21859136340929752, -0.7462819442531666, 0.38775976554635416, -0.8007672903941848, 0.5135411121491024, 0.024801642566275796, -0.3959081932849637, -0.03655789001382095, -0.20560182863029464, 0.4998938494547587], [0.07046940972220658, 0.5594207743279725, -0.7471955667001161, -0.5860697644165077, -0.012658273937132675, 0.1852744659538511, -0.4217178829597412, 0.4486892276422829, -0.4264057410127534, -0.359176116819955  …  -0.21859136340929752, -0.7462819442531666, 0.38775976554635416, -0.8007672903941848, 0.5135411121491024, 0.024801642566275796, -0.3959081932849637, -0.03655789001382095, -0.20560182863029464, 0.4998938494547587], [0.06301576988861293, 0.5575171716442235, -0.7466982154395226, -0.5860157678533763, -0.008222974492591894, 0.18367776672631267, -0.4230790795653338, 0.446193778767213, -0.42654757145676936, -0.36230355590273944  …  -0.21412007647677492, -0.7517413108252704, 0.39325151630427624, -0.8052864438475213, 0.5178078333583261, 0.026995266859673895, -0.39725278791099694, -0.032055726066063224, -0.21273813848985498, 0.5000064981780348], [0.06260493267831907, 0.5574345829157223, -0.7465836071060122, -0.5860429963704701, -0.00784676809724139, 0.18353768391711367, -0.4230791377139253, 0.44594580359623465, -0.42661494172836634, -0.36244010762922824  …  -0.21388283957284124, -0.7518696376432652, 0.39364126516737663, -0.8054623862160207, 0.5181002205133499, 0.027013886913882935, -0.39755706433557253, -0.03162924570644137, -0.21314742499555817, 0.49999861690833963], [0.061202564095066726, 0.5568721422397964, -0.7464782041612231, -0.5859435117607562, -0.007005892917442433, 0.1833603355319137, -0.42346319071109445, 0.4451985773202868, -0.4264679237786888, -0.3629692205382792  …  -0.2132325844722475, -0.7526416544245468, 0.394270207480176, -0.8059992116660277, 0.5184434576124916, 0.027371847735414036, -0.39763474065767856, -0.030728476651539913, -0.2140956230474842, 0.500046474847136], [0.06084626698884772, 0.5567834632566477, -0.7466738397519241, -0.5858220160779596, -0.006822028155910767, 0.18329027642085402, -0.4235503396096061, 0.44496562373437276, -0.4264729810678872, -0.3629434046474139  …  -0.2127494318965196, -0.7530536792134309, 0.3946995157485582, -0.8062627555880001, 0.5184584742474899, 0.027467526033178473, -0.3975955916867139, -0.030411372528644287, -0.2146601246023041, 0.49993451865088895], [0.05965884704577941, 0.5562607636540122, -0.7464764167550598, -0.5857505425875571, -0.005960265863664429, 0.183019471265008, -0.42384469241941736, 0.44463287278447056, -0.42642497635298576, -0.36327827387433  …  -0.2121001104673824, -0.7540254925450656, 0.3953603102050966, -0.8068793815422891, 0.5190808475918991, 0.02765057868811442, -0.39807484830016737, -0.02979859853888701, -0.21613045770384695, 0.4996505394528056], [0.05919841891689398, 0.5560949496012496, -0.7464692578595141, -0.5857451683342662, -0.005724155584146173, 0.18284625387634507, -0.42383316032145246, 0.4445029775986085, -0.42638755020486013, -0.3635081429633951  …  -0.2118148799751316, -0.7543934647461789, 0.39565133890697707, -0.8071934383896758, 0.5192180240787875, 0.02768769038819274, -0.39806966017302214, -0.02953254074668852, -0.21653741314103078, 0.4997181519493865], [0.05858909164135176, 0.5560007208598672, -0.7463559843123121, -0.5857356792232162, -0.0055398659661407895, 0.18274893707927048, -0.42408605645850256, 0.44437138446298585, -0.42615403490466736, -0.3638987705555865  …  -0.21158361791402877, -0.7548388911169266, 0.3958491348257127, -0.8075907652826476, 0.5194376506421787, 0.027819526738736625, -0.3982547328221693, -0.029159576190084267, -0.21695135112140077, 0.4999400861767749]  …  [-0.21920410149512004, 0.848767327724936, -1.3199958389994286, -1.093116916708174, 0.3027564744475469, 0.5489372120878309, -0.6685712613600284, 1.1715524735291478, -1.0745061551660235, -1.7741440378981106  …  1.9525017432255487, -3.2396920505671396, 2.6621544531200945, -3.2587174209098317, 2.4272503086233908, 1.4310246510970184, -2.392263905299315, 1.9666913053091906, 0.9694874586821276, 0.41954230121359565], [-0.22247664689772417, 0.8474917343185482, -1.3182032716614955, -1.0903284535073554, 0.3014527599766778, 0.5544770241905166, -0.6645011529352005, 1.1705760086955423, -1.0745652264539942, -1.7729234739220243  …  1.952639387081596, -3.240129538690475, 2.662219042774035, -3.259032673114743, 2.4273342009503667, 1.4329392173804762, -2.3914504916227086, 1.966885571614568, 0.9681426300238484, 0.4203219029721478], [-0.22947290331647918, 0.8481520457322044, -1.3159822744535976, -1.0886594069329198, 0.30100864819358975, 0.561136347894497, -0.6597728725172193, 1.1685533248328994, -1.0736542604974941, -1.769658521744963  …  1.9536452361376235, -3.2397442941070103, 2.6612063757456723, -3.2596259604405353, 2.426738454445597, 1.43317789929094, -2.390837869547833, 1.9677447110423827, 0.9677416247433888, 0.42086030533411195], [-0.23189649960315595, 0.8486382895858757, -1.3157655780170967, -1.0878350759131246, 0.29976472610875077, 0.5634438885232209, -0.6578667772861995, 1.168891058328512, -1.074097643586958, -1.7686056841306268  …  1.9531791304047226, -3.2395687402134334, 2.6608836458831213, -3.2594025156019395, 2.4268569664264614, 1.4332981184411635, -2.3907814923223114, 1.967859835508927, 0.9668075006054021, 0.4218141023456577], [-0.23855933453434597, 0.8491076723240921, -1.3139976381503646, -1.0862154571108917, 0.2988246395427255, 0.5689067024499064, -0.6558529821108416, 1.1662554012268789, -1.0724171243423328, -1.7662568318799836  …  1.9538764995756397, -3.239196701339134, 2.6607127999843874, -3.2593049586388187, 2.427234257112917, 1.4332501228235615, -2.3913909864564857, 1.9680289992865923, 0.9661681798762622, 0.42116261627162377], [-0.24139934907975977, 0.8492738191075105, -1.3140162473769008, -1.085424177705839, 0.2980126287907585, 0.5713847110783449, -0.6537211907509848, 1.1656308546015104, -1.0718383511711604, -1.764688055838054  …  1.9549596366322837, -3.240019593477843, 2.660982133890308, -3.2599405983353917, 2.4279681289791935, 1.4331122735289774, -2.391009814042147, 1.969166263458091, 0.9669802281108864, 0.4219076105879468], [-0.24420510004832846, 0.849556279025735, -1.313564615888333, -1.08392987821447, 0.29754351602452567, 0.5726420264514501, -0.6533226425161833, 1.1653072018503208, -1.0723364605757133, -1.7633081715865833  …  1.9551950814739347, -3.2407037372444387, 2.6611544049367817, -3.2597445365261897, 2.4276435212948764, 1.4339803690967419, -2.3914337853052094, 1.9690737112905137, 0.9674616943637722, 0.42138905031368484], [-0.24521998022878516, 0.8494665165303377, -1.3135704596347226, -1.0836730068737295, 0.2973420011006418, 0.5733906292049479, -0.6529276481977796, 1.1649012762264868, -1.0727324802726195, -1.7631231921176442  …  1.9557308154288868, -3.2406318018708493, 2.661552026038319, -3.25995626856152, 2.427665397421558, 1.4336119845584674, -2.3910949278295615, 1.9692992934748588, 0.9676581443444793, 0.4209852004876198], [-0.2475315629338009, 0.8502860505805458, -1.3139729350539413, -1.0832591239159834, 0.29688180146996657, 0.5752594136095945, -0.6518938285620971, 1.1648541995694728, -1.0733827589115343, -1.7616176199712517  …  1.9556827663652945, -3.240474790368232, 2.661048019278987, -3.260659391298263, 2.4278624907933435, 1.4326192151492132, -2.390383360901131, 1.970204722010456, 0.968360413330219, 0.4216158008045638], [-0.2488447003673358, 0.8505761269500115, -1.313797970074403, -1.0830953754179018, 0.29677565697775926, 0.5764060754364773, -0.6516969770191666, 1.1642805703122496, -1.073505161447043, -1.7613944103241674  …  1.9561433025494688, -3.240390578273333, 2.66178596923695, -3.260328688420654, 2.4274118708835886, 1.4336482627783753, -2.3906288469348356, 1.969523779022899, 0.9686291439853532, 0.4221381572188279]], NamedTuple[(n_steps = 2, is_accept = true, acceptance_rate = 0.5, log_density = -1.5505475948674707e6, hamiltonian_energy = 1.692457014228906e6, hamiltonian_energy_error = -8545.269378206925, max_hamiltonian_energy_error = 43895.468121649, tree_depth = 1, numerical_error = true, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.5505475948674707e6, hamiltonian_energy = 1.5506170597588702e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1.4281216517312609e20, tree_depth = 0, numerical_error = true, step_size = 0.009055910606012648, nom_step_size = 0.009055910606012648, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 1.1717183247452767e-113, log_density = -1.5505475948674707e6, hamiltonian_energy = 1.550598973471191e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 260.033644183306, tree_depth = 1, numerical_error = false, step_size = 0.0011689984204270615, nom_step_size = 0.0011689984204270615, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.30459140309177374, log_density = -1.5409651588110959e6, hamiltonian_energy = 1.5505887156494549e6, hamiltonian_energy_error = 2.0805955375544727, max_hamiltonian_energy_error = 3.313648457173258, tree_depth = 4, numerical_error = false, step_size = 9.886049642915416e-5, nom_step_size = 9.886049642915416e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9946292633711098, log_density = -1.5403671594556163e6, hamiltonian_energy = 1.5410188356954907e6, hamiltonian_energy_error = 0.0046881267335265875, max_hamiltonian_energy_error = 0.016601765528321266, tree_depth = 4, numerical_error = false, step_size = 1.665320869060089e-5, nom_step_size = 1.665320869060089e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9929126468726908, log_density = -1.538873849931476e6, hamiltonian_energy = 1.5404350273601757e6, hamiltonian_energy_error = 0.005289879394695163, max_hamiltonian_energy_error = 0.027067493414506316, tree_depth = 4, numerical_error = false, step_size = 2.2091020570198572e-5, nom_step_size = 2.2091020570198572e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9903093963077482, log_density = -1.538290887064772e6, hamiltonian_energy = 1.5389419129324357e6, hamiltonian_energy_error = 0.008620845852419734, max_hamiltonian_energy_error = 0.02339177136309445, tree_depth = 3, numerical_error = false, step_size = 3.340870207712292e-5, nom_step_size = 3.340870207712292e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.6264240083104318, log_density = -1.5366906345505458e6, hamiltonian_energy = 1.5383397736372948e6, hamiltonian_energy_error = 0.10846204776316881, max_hamiltonian_energy_error = 0.8796909069642425, tree_depth = 4, numerical_error = false, step_size = 5.4555051825780696e-5, nom_step_size = 5.4555051825780696e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9886825548554798, log_density = -1.5362108252976e6, hamiltonian_energy = 1.5367403622800445e6, hamiltonian_energy_error = 0.006696677068248391, max_hamiltonian_energy_error = 0.03331064572557807, tree_depth = 3, numerical_error = false, step_size = 2.9937122642373323e-5, nom_step_size = 2.9937122642373323e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.9744500339363075, log_density = -1.5354987641165964e6, hamiltonian_energy = 1.5362522188603256e6, hamiltonian_energy_error = 0.05595078831538558, max_hamiltonian_energy_error = 0.05595078831538558, tree_depth = 2, numerical_error = false, step_size = 5.2703286171129e-5, nom_step_size = 5.2703286171129e-5, is_adapt = true)  …  (n_steps = 15, is_accept = true, acceptance_rate = 0.9873963640253078, log_density = -28402.654905599393, hamiltonian_energy = 29165.67481441815, hamiltonian_energy_error = -0.3872530815497157, max_hamiltonian_energy_error = -0.734454278866906, tree_depth = 4, numerical_error = false, step_size = 6.1007112910138034e-5, nom_step_size = 6.1007112910138034e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 1.0, log_density = -27170.32418277798, hamiltonian_energy = 28470.162773755597, hamiltonian_energy_error = -0.4596074456349015, max_hamiltonian_energy_error = -0.8010931252720184, tree_depth = 5, numerical_error = false, step_size = 6.1007112910138034e-5, nom_step_size = 6.1007112910138034e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.998742363928181, log_density = -25654.244891698796, hamiltonian_energy = 27226.93579499307, hamiltonian_energy_error = -0.40802038574474864, max_hamiltonian_energy_error = -0.43656620690671843, tree_depth = 4, numerical_error = false, step_size = 6.1007112910138034e-5, nom_step_size = 6.1007112910138034e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9958288256599388, log_density = -25201.614534456436, hamiltonian_energy = 25717.382545842138, hamiltonian_energy_error = -0.08687376510715694, max_hamiltonian_energy_error = -0.15431417193030939, tree_depth = 4, numerical_error = false, step_size = 6.1007112910138034e-5, nom_step_size = 6.1007112910138034e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9973886025695999, log_density = -24183.586351647013, hamiltonian_energy = 25274.8028586209, hamiltonian_energy_error = -0.08050810307031497, max_hamiltonian_energy_error = -0.42876882238851977, tree_depth = 5, numerical_error = false, step_size = 6.1007112910138034e-5, nom_step_size = 6.1007112910138034e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 1.0, log_density = -23696.540223915046, hamiltonian_energy = 24226.706866739, hamiltonian_energy_error = -0.1414496502984548, max_hamiltonian_energy_error = -0.21633440697769402, tree_depth = 4, numerical_error = false, step_size = 6.1007112910138034e-5, nom_step_size = 6.1007112910138034e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.999682014350502, log_density = -23271.347073903442, hamiltonian_energy = 23755.61823598022, hamiltonian_energy_error = -0.10387968490977073, max_hamiltonian_energy_error = -0.1399143915186869, tree_depth = 4, numerical_error = false, step_size = 6.1007112910138034e-5, nom_step_size = 6.1007112910138034e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.991942542973027, log_density = -23114.4554583935, hamiltonian_energy = 23314.75161354323, hamiltonian_energy_error = 0.0031978186780179385, max_hamiltonian_energy_error = -0.21338359807850793, tree_depth = 5, numerical_error = false, step_size = 6.1007112910138034e-5, nom_step_size = 6.1007112910138034e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9976958489656342, log_density = -22811.154222763944, hamiltonian_energy = 23185.059522358715, hamiltonian_energy_error = -0.10238937315807561, max_hamiltonian_energy_error = -0.1288164906363818, tree_depth = 4, numerical_error = false, step_size = 6.1007112910138034e-5, nom_step_size = 6.1007112910138034e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9391725033308045, log_density = -22584.474273120257, hamiltonian_energy = 22864.40839234674, hamiltonian_energy_error = 0.0133997203920444, max_hamiltonian_energy_error = 0.19109915040826309, tree_depth = 4, numerical_error = false, step_size = 6.1007112910138034e-5, nom_step_size = 6.1007112910138034e-5, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-3.5 ± 0.078, -3.5 ± 0.078, -3.5 ± 0.078, -3.5 ± 0.078, -3.5 ± 0.078, -3.5 ± 0.078, -3.5 ± 0.078, -3.5 ± 0.079, -3.5 ± 0.079, -3.5 ± 0.079  …  -4.19 ± 0.48, -4.19 ± 0.48, -4.19 ± 0.48, -4.19 ± 0.48, -4.19 ± 0.48, -4.19 ± 0.48, -4.19 ± 0.48, -4.18 ± 0.48, -4.18 ± 0.48, -4.18 ± 0.48]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.117 ± 0.11 -0.886 ± 0.19; 0.697 ± 0.16 -1.34 ± 0.43; … ; -0.652 ± 0.016 0.0996 ± 0.39; 1.03 ± 0.14 -1.59 ± 0.42], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.0897 ± 0.046; -0.917 ± 0.043; … ; -1.16 ± 0.078; -0.476 ± 0.32;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.63 ± 0.06 -0.18 ± 0.088 … -0.739 ± 0.1 -0.46 ± 0.079; -0.468 ± 0.055 0.925 ± 0.14 … 0.846 ± 0.085 0.95 ± 0.13; … ; 0.121 ± 0.26 0.744 ± 0.084 … 0.414 ± 0.022 0.712 ± 0.016; -0.304 ± 0.11 -0.37 ± 0.16 … -0.493 ± 0.13 -0.613 ± 0.19], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.174 ± 0.1; 0.536 ± 0.028; … ; -0.199 ± 0.0056; 0.154 ± 0.12;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[1.32 ± 0.64 -2.66 ± 0.59 … -1.84 ± 0.56 1.42 ± 0.56], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.303 ± 0.68;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.467 ± 0.048], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="03817358.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Friday 29 March 2024 22:58">Friday 29 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
