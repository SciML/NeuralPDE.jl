<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -4.312188328788705
 -3.757298707049656
 -3.8855110993768576
 -3.9393915237635024
 -4.026610988136447
 -4.008276548232367
 -4.042207468908559
 -3.9649277049226086
 -3.568325612708653
 -3.6129987852221603
  ⋮
 -3.7059485145597306
 -4.343889702957537
 -4.086114710367381
 -3.8176897909228327
 -4.038973691068287
 -3.9951065502011365
 -3.953471573757916
 -3.4985930790540642
 -3.674934149101367</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="7742a7d4.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[0.13409861662484313, -0.44772892573008166, 0.25308323581156467, 0.41532742745660156, 0.360597876553312, -0.28922506327892955, 0.5468483158255188, -0.14700183159833177, -0.4817347562686558, -0.39334135662236397  …  -0.232767443487129, -0.5460861902991424, -0.7263269077177003, 0.2897136134439906, 0.7222129115630816, -0.7180766196167332, 0.7542425123389254, -0.43023763445148855, -0.046073227496361654, 0.49902484484802334], [0.13409861662484313, -0.44772892573008166, 0.25308323581156467, 0.41532742745660156, 0.360597876553312, -0.28922506327892955, 0.5468483158255188, -0.14700183159833177, -0.4817347562686558, -0.39334135662236397  …  -0.232767443487129, -0.5460861902991424, -0.7263269077177003, 0.2897136134439906, 0.7222129115630816, -0.7180766196167332, 0.7542425123389254, -0.43023763445148855, -0.046073227496361654, 0.49902484484802334], [0.13409861662484313, -0.44772892573008166, 0.25308323581156467, 0.41532742745660156, 0.360597876553312, -0.28922506327892955, 0.5468483158255188, -0.14700183159833177, -0.4817347562686558, -0.39334135662236397  …  -0.232767443487129, -0.5460861902991424, -0.7263269077177003, 0.2897136134439906, 0.7222129115630816, -0.7180766196167332, 0.7542425123389254, -0.43023763445148855, -0.046073227496361654, 0.49902484484802334], [0.09691981976947987, -0.4475756498525307, 0.2565449770534926, 0.4150324219386342, 0.36113730436284935, -0.29789164809498536, 0.5463876412608072, -0.1607714473334381, -0.4803771822728029, -0.3962234766090642  …  -0.2360644997065485, -0.5479697018492784, -0.7292827359064382, 0.29014649150948285, 0.725797144335093, -0.716580702191576, 0.7508050037608408, -0.430454130368608, -0.055539146499141975, 0.49941347435529393], [0.08505607018317884, -0.4475688195079263, 0.2579136343782079, 0.41497319018698137, 0.36178669019784804, -0.29982414989291317, 0.5463070137237328, -0.16400683190831347, -0.48057316704186537, -0.3970074283545238  …  -0.23698442736207498, -0.5487918467435872, -0.7307520101348153, 0.2901463174206208, 0.7264947943288502, -0.7168810248641787, 0.7501366618614197, -0.43080922800467325, -0.05825135616247686, 0.4992213089565197], [0.05953540408420732, -0.44733690666871345, 0.26023010013409176, 0.41448047070471483, 0.36216973777879685, -0.30395468540181386, 0.5456171209711308, -0.17063491507876216, -0.4811791304381389, -0.3983607039993147  …  -0.23927361628106353, -0.5506790616610915, -0.7338454571136722, 0.2906327856531332, 0.7279878401293017, -0.7177325878996528, 0.7490905057936076, -0.43095853872562656, -0.06416857876370456, 0.49939547721233446], [0.006329211424575071, -0.4478813154500041, 0.26925723249659483, 0.4135180471267515, 0.363804030690162, -0.31373575843903, 0.5430963751466564, -0.18526490081085847, -0.4848349587586822, -0.4037152115404695  …  -0.2451748466241082, -0.5560677622755549, -0.7412638441218853, 0.2924715295333739, 0.7308998210384823, -0.7215222547707473, 0.7485428378681096, -0.43134062566610143, -0.07944393142280554, 0.4986901920202011], [0.015677655466485196, -0.4494170858614458, 0.27724354388772693, 0.4139329246515958, 0.3652654014955516, -0.31896274810559205, 0.5413577322628963, -0.19326911151514722, -0.4887171021983311, -0.4076531241581505  …  -0.2500797103885031, -0.5605289591518164, -0.7501540350606801, 0.29344677552072, 0.7315892639604701, -0.7262353124040772, 0.7498479302663814, -0.42857648132231224, -0.0911454027127189, 0.49913986067447863], [0.015677655466485196, -0.4494170858614458, 0.27724354388772693, 0.4139329246515958, 0.3652654014955516, -0.31896274810559205, 0.5413577322628963, -0.19326911151514722, -0.4887171021983311, -0.4076531241581505  …  -0.2500797103885031, -0.5605289591518164, -0.7501540350606801, 0.29344677552072, 0.7315892639604701, -0.7262353124040772, 0.7498479302663814, -0.42857648132231224, -0.0911454027127189, 0.49913986067447863], [0.015032434259059244, -0.4494067286487686, 0.27835338591761694, 0.4138770682236784, 0.3657763004782627, -0.3203028204763284, 0.5408605639915464, -0.19445374168289759, -0.48952107830489994, -0.4081455844306686  …  -0.2509625153428978, -0.5613162276272284, -0.7516769223250079, 0.2936238768975618, 0.7316187526551857, -0.7270479393897221, 0.7500411926779258, -0.42853448250900844, -0.09324214607496914, 0.49932710429183247]  …  [0.21951390088639272, -0.5863450328514425, 1.0929852869723926, 0.42504659127453903, 1.0685307816568974, -0.6972596764041877, 0.613408165840305, -0.8420022437329402, -0.5438580765247479, 0.6899805748731584  …  -1.5228550197500195, -1.7040565159837984, -2.3283478111807487, 1.3862610901855454, 1.8045503310540196, -2.1020801117394634, 1.7270682692061152, -0.9576410944476277, 0.04731268683058794, 0.41933048231742387], [0.23024545227616558, -0.5801276957413231, 1.0806616172521728, 0.42461555424102404, 1.080862443575871, -0.6986767621531457, 0.6177519199378821, -0.8496464094790168, -0.553083519392487, 0.7257911396620734  …  -1.5350268256713187, -1.717208026997986, -2.338810140583838, 1.398688437200009, 1.8154658445479295, -2.1144362491836057, 1.7401876546034494, -0.9690051591313161, 0.05608973441858139, 0.4159288861876437], [0.23154516756368737, -0.5800081887941245, 1.0795476847252596, 0.42476076873690694, 1.0819751252145635, -0.6988539257990031, 0.6185574848455345, -0.8501148692358343, -0.5542622441053319, 0.7293648811704482  …  -1.5369495067559007, -1.7183801799229825, -2.340807082260007, 1.4001307966520746, 1.816517344935095, -2.116236099565711, 1.7413940912892953, -0.9700631785999684, 0.056695322998823156, 0.41636244222557967], [0.23272908655436741, -0.5792853976262813, 1.0789678400954108, 0.42466668751998166, 1.0836675235330064, -0.699471985372275, 0.619155661480336, -0.850938862506423, -0.5550799439730345, 0.7332888056796325  …  -1.5378480405127133, -1.7199015841057643, -2.3424236152914277, 1.4011664045152263, 1.8180085659796428, -2.117094924329644, 1.743680508917393, -0.9714311969596487, 0.05790155455949758, 0.4164721385894615], [0.2878991470887518, -0.5375977137727357, 1.0069835783613539, 0.43593536869100263, 1.149361568303152, -0.7091511967638789, 0.6463295953810503, -0.8738517740781667, -0.6102543337439679, 0.9454433126373206  …  -1.606781078321722, -1.7878212493216121, -2.4228962422363662, 1.4768407361756997, 1.8914009046923363, -2.1979259986493833, 1.8293158841972945, -1.0405729106267483, 0.11460191262429271, 0.40314093995509576], [0.28956012699943856, -0.5353337219851377, 1.0010721767489872, 0.4377959923314164, 1.1523335007597335, -0.7071658342562388, 0.6493702722107954, -0.875979033777198, -0.6140200923225863, 0.9653587580290673  …  -1.6135565862509613, -1.793768208369927, -2.430715025627028, 1.4848295441015684, 1.9001832628568263, -2.206014431993715, 1.8362287848142698, -1.0454370799676003, 0.12058181709073744, 0.4035057426493354], [0.2928723701654046, -0.5314144203387619, 0.9961599285775609, 0.4392930368481635, 1.1558120185075549, -0.7099289591984509, 0.6520156736909075, -0.8762564728936402, -0.617041314619024, 0.9826294659497966  …  -1.6202071660650945, -1.7996447073771256, -2.437079432214692, 1.491807540240629, 1.9071128784800304, -2.2116776032670087, 1.8419940391268352, -1.0499790374796505, 0.12784998103489564, 0.40264075552238665], [0.294767087162912, -0.5280974454352204, 0.99323822631709, 0.43961253786314275, 1.1587507459646624, -0.7062523461986973, 0.6536015784237919, -0.8764041999242511, -0.6230681119289896, 0.9983822431340786  …  -1.6289809025039577, -1.8070156742573407, -2.4457949893171143, 1.498176438696003, 1.9139070921293881, -2.2181480512689205, 1.8504350824165106, -1.0556298559068074, 0.13490634113550254, 0.40277264350757014], [0.29615422300101224, -0.526849141215052, 0.988540281616047, 0.4407342350045243, 1.1610652069264487, -0.7073271395080214, 0.6552958643533496, -0.8795216932749532, -0.6274322944669517, 1.0106254274841706  …  -1.635166413472806, -1.8135881771010662, -2.45284035195496, 1.5041390024598231, 1.9203384873915985, -2.226737967099089, 1.8581320385372544, -1.0587953525462577, 0.14216195969828824, 0.4023271739069745], [0.2991857583243655, -0.5260796082964294, 0.9848979225648224, 0.441827103862546, 1.1619717869686605, -0.7070285550954439, 0.6559909228855748, -0.8799367767569005, -0.6281298885288925, 1.0195239303494799  …  -1.639633986340689, -1.818671594291785, -2.455600002076275, 1.5086626932623939, 1.9241223952544426, -2.230332423040944, 1.8625103552029114, -1.061377342794324, 0.1441006584717983, 0.401696007737411]], NamedTuple[(n_steps = 1, is_accept = true, acceptance_rate = 1.0, log_density = -1.6642160076065266e6, hamiltonian_energy = 1.7233977542424598e6, hamiltonian_energy_error = -77080.7231695319, max_hamiltonian_energy_error = -77080.7231695319, tree_depth = 1, numerical_error = false, step_size = 0.00078125, nom_step_size = 0.00078125, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6642160076065266e6, hamiltonian_energy = 1.6642648302468676e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1.6026672701473508e45, tree_depth = 0, numerical_error = true, step_size = 0.011238679762325607, nom_step_size = 0.011238679762325607, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6642160076065266e6, hamiltonian_energy = 1.6642741054116783e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 897863.1298625187, tree_depth = 0, numerical_error = true, step_size = 0.0018993494877672993, nom_step_size = 0.0018993494877672993, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.6863424189189472, log_density = -1.6298381483466446e6, hamiltonian_energy = 1.6639765556047114e6, hamiltonian_energy_error = -292.72161570494063, max_hamiltonian_energy_error = -292.72161570494063, tree_depth = 2, numerical_error = false, step_size = 0.00018733703557689892, nom_step_size = 0.00018733703557689892, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.6198803410367179e6, hamiltonian_energy = 1.6298568653616628e6, hamiltonian_energy_error = -41.77995769074187, max_hamiltonian_energy_error = -41.77995769074187, tree_depth = 2, numerical_error = false, step_size = 0.00010341441351942775, nom_step_size = 0.00010341441351942775, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.6002901798522014e6, hamiltonian_energy = 1.619486382902148e6, hamiltonian_energy_error = -447.5733345593326, max_hamiltonian_energy_error = -447.5733345593326, tree_depth = 2, numerical_error = false, step_size = 0.00015554111369697808, nom_step_size = 0.00015554111369697808, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.5724703574241728e6, hamiltonian_energy = 1.5979695059564463e6, hamiltonian_energy_error = -2374.443125616992, max_hamiltonian_energy_error = -2374.443125616992, tree_depth = 2, numerical_error = false, step_size = 0.00025816896321586175, nom_step_size = 0.00025816896321586175, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -1.5591824035086855e6, hamiltonian_energy = 1.5722678117655301e6, hamiltonian_energy_error = -251.4605810160283, max_hamiltonian_energy_error = -251.4605810160283, tree_depth = 2, numerical_error = false, step_size = 0.0004546761022499016, nom_step_size = 0.0004546761022499016, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.5591824035086855e6, hamiltonian_energy = 1.5592372646152985e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 2027.216259965906, tree_depth = 0, numerical_error = true, step_size = 0.0008293737466789014, nom_step_size = 0.0008293737466789014, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -1.5568017611849324e6, hamiltonian_energy = 1.5592317362559827e6, hamiltonian_energy_error = -0.24179985979571939, max_hamiltonian_energy_error = -0.3623581547290087, tree_depth = 3, numerical_error = false, step_size = 6.559562393176147e-5, nom_step_size = 6.559562393176147e-5, is_adapt = true)  …  (n_steps = 7, is_accept = true, acceptance_rate = 0.5405847004881911, log_density = -69411.76653286075, hamiltonian_energy = 71668.49641591043, hamiltonian_energy_error = -0.8441960681811906, max_hamiltonian_energy_error = 1.888309110843693, tree_depth = 3, numerical_error = false, step_size = 0.0002472432403812455, nom_step_size = 0.0002472432403812455, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 1.0, log_density = -64680.22777084069, hamiltonian_energy = 69466.61622917019, hamiltonian_energy_error = -2.441504173053545, max_hamiltonian_energy_error = -4.624801959420438, tree_depth = 4, numerical_error = false, step_size = 0.0002472432403812455, nom_step_size = 0.0002472432403812455, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -64178.116680606974, hamiltonian_energy = 64724.127852834514, hamiltonian_energy_error = -0.3475230994008598, max_hamiltonian_energy_error = -1.221429558667296, tree_depth = 3, numerical_error = false, step_size = 0.0002472432403812455, nom_step_size = 0.0002472432403812455, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 0.8794442806959513, log_density = -63687.13022453992, hamiltonian_energy = 64224.29907235807, hamiltonian_energy_error = -0.11341051360068377, max_hamiltonian_energy_error = 0.3016538939482416, tree_depth = 2, numerical_error = false, step_size = 0.0002472432403812455, nom_step_size = 0.0002472432403812455, is_adapt = false), (n_steps = 23, is_accept = true, acceptance_rate = 0.8865630143507066, log_density = -39545.25516076894, hamiltonian_energy = 63722.074793832726, hamiltonian_energy_error = -15.49761654395843, max_hamiltonian_energy_error = 1.984667581953106e6, tree_depth = 4, numerical_error = true, step_size = 0.0002472432403812455, nom_step_size = 0.0002472432403812455, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.5466796473352441, log_density = -37707.185010387795, hamiltonian_energy = 39601.965592084336, hamiltonian_energy_error = -5.118744198269269, max_hamiltonian_energy_error = -5.118744198269269, tree_depth = 3, numerical_error = false, step_size = 0.0002472432403812455, nom_step_size = 0.0002472432403812455, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -36169.02996520049, hamiltonian_energy = 37757.42043993957, hamiltonian_energy_error = -0.835309512236563, max_hamiltonian_energy_error = -1.6628074159598327, tree_depth = 3, numerical_error = false, step_size = 0.0002472432403812455, nom_step_size = 0.0002472432403812455, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.7497765787019767, log_density = -34633.875376167874, hamiltonian_energy = 36229.79253425521, hamiltonian_energy_error = -0.46589991748624016, max_hamiltonian_energy_error = 1.0021612747514155, tree_depth = 3, numerical_error = false, step_size = 0.0002472432403812455, nom_step_size = 0.0002472432403812455, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -33257.73352535549, hamiltonian_energy = 34684.931441680244, hamiltonian_energy_error = -1.2439973944128724, max_hamiltonian_energy_error = -1.5380688884251867, tree_depth = 3, numerical_error = false, step_size = 0.0002472432403812455, nom_step_size = 0.0002472432403812455, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -32399.148783746303, hamiltonian_energy = 33301.125530038466, hamiltonian_energy_error = -1.2439593374729156, max_hamiltonian_energy_error = -1.2439593374729156, tree_depth = 3, numerical_error = false, step_size = 0.0002472432403812455, nom_step_size = 0.0002472432403812455, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-4.14 ± 0.029, -4.14 ± 0.029, -4.14 ± 0.029, -4.14 ± 0.03, -4.14 ± 0.03, -4.14 ± 0.03, -4.14 ± 0.03, -4.14 ± 0.031, -4.13 ± 0.031, -4.13 ± 0.031  …  -3.79 ± 0.13, -3.79 ± 0.13, -3.79 ± 0.13, -3.79 ± 0.13, -3.79 ± 0.13, -3.79 ± 0.13, -3.78 ± 0.13, -3.78 ± 0.13, -3.78 ± 0.13, -3.78 ± 0.13]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.193 ± 0.067 -0.546 ± 0.037; -0.582 ± 0.025 0.645 ± 0.2; … ; 0.614 ± 0.02 -0.863 ± 0.023; -0.84 ± 0.021 1.17 ± 0.051], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.0622 ± 0.062; -0.967 ± 0.0087; … ; -0.565 ± 0.005; 0.475 ± 0.017;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.0615 ± 0.0094 0.479 ± 0.022 … 0.237 ± 0.016 -0.535 ± 0.025; -0.587 ± 0.0057 0.173 ± 0.024 … -0.268 ± 0.021 -0.0123 ± 0.027; … ; 0.582 ± 0.0078 -0.871 ± 0.022 … -0.385 ± 0.0079 0.198 ± 0.0078; -0.408 ± 0.0098 0.0479 ± 0.028 … 0.599 ± 0.0052 -0.208 ± 0.0075], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.28 ± 0.009; 0.242 ± 0.0058; … ; -0.368 ± 0.036; 0.0111 ± 0.0012;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-1.5 ± 0.074 -1.69 ± 0.069 … 1.7 ± 0.088 -0.94 ± 0.068], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.0336 ± 0.059;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.427 ± 0.018], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="72ef1540.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Tuesday 5 March 2024 12:18">Tuesday 5 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
