<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -4.099200574847801
 -4.336384559280316
 -3.985409172243366
 -4.010856748496057
 -3.9476440371890256
 -3.6143210986669487
 -3.861888598115047
 -3.808440078904369
 -3.9000113121206366
 -3.4652611413166414
  ⋮
 -3.8327223125655134
 -4.47193122077726
 -3.789124179906164
 -3.987796695225034
 -3.7877654817446405
 -3.6702067004185714
 -3.895427178457749
 -3.9602786661623246
 -4.224198645601705</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="0465225c.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[0.527190832693091, -0.046452557070367356, 0.5584049413872164, -0.06583610958148725, 0.534211141487644, 0.7375058093707846, -0.56380869694925, 0.6105537120866149, 0.09238770456623617, -0.04904939181359193  …  -0.05127639254574259, -0.02042848179812468, -0.08715819306696497, -0.6800349073334339, 0.32369346905019303, 0.06769315040620927, 0.4027717302308621, 0.6028043902752472, -0.16885246958193112, 0.4993238639685041], [0.527190832693091, -0.046452557070367356, 0.5584049413872164, -0.06583610958148725, 0.534211141487644, 0.7375058093707846, -0.56380869694925, 0.6105537120866149, 0.09238770456623617, -0.04904939181359193  …  -0.05127639254574259, -0.02042848179812468, -0.08715819306696497, -0.6800349073334339, 0.32369346905019303, 0.06769315040620927, 0.4027717302308621, 0.6028043902752472, -0.16885246958193112, 0.4993238639685041], [0.5280616738320074, -0.06246357069852337, 0.5556844277097477, -0.055965132954242394, 0.5351738373543854, 0.7404950720421714, -0.5622928201158203, 0.6040555918388263, 0.09389507438482568, -0.05436531141284911  …  -0.06077718301180541, -0.028819844571292306, -0.08167190713385739, -0.7068101127330071, 0.3386638183366751, 0.02959795320828311, 0.40428675541016773, 0.6096328722112225, -0.23855013050215546, 0.5006687949258826], [0.5280616738320074, -0.06246357069852337, 0.5556844277097477, -0.055965132954242394, 0.5351738373543854, 0.7404950720421714, -0.5622928201158203, 0.6040555918388263, 0.09389507438482568, -0.05436531141284911  …  -0.06077718301180541, -0.028819844571292306, -0.08167190713385739, -0.7068101127330071, 0.3386638183366751, 0.02959795320828311, 0.40428675541016773, 0.6096328722112225, -0.23855013050215546, 0.5006687949258826], [0.5278776074655446, -0.0629345400155903, 0.5554274214232561, -0.055544469649192366, 0.5350438264661865, 0.7402188970647824, -0.56205249575638, 0.6039277394999585, 0.09396431644690766, -0.05476403306941644  …  -0.06131271397939278, -0.028894849621888014, -0.08158741233362492, -0.7076871414889032, 0.3392466827032822, 0.028449142553388502, 0.40433098861981964, 0.6103510100811268, -0.24036908241404276, 0.500683752793822], [0.5283951851160301, -0.06658994155015868, 0.5550438488199605, -0.051310333139600116, 0.5347429185345755, 0.7398648474859673, -0.5592577168673558, 0.6030199535850802, 0.09378029293852791, -0.055865135489012084  …  -0.06371360788965265, -0.03218204854634096, -0.0801683233498516, -0.7178727378175259, 0.344122304679646, 0.01770269547727574, 0.4059341261423078, 0.6144807128954622, -0.2556489041053203, 0.5010478116357502], [0.5283041444384575, -0.06791670534667339, 0.5547484617748882, -0.05061858748748465, 0.5350991123411151, 0.7397548308894843, -0.5590354407644867, 0.6025618261282529, 0.09344554499283968, -0.056087649746535455  …  -0.06441982094962335, -0.033059089938937754, -0.07983785975072939, -0.7213145850480955, 0.34567367795466797, 0.01418691162771135, 0.4064008251729716, 0.6159557333333354, -0.2607028745033068, 0.5008995671196449], [0.5282635459943568, -0.06795684829723492, 0.5545568446238158, -0.050404769764313385, 0.5351360588757014, 0.7396391320120694, -0.559055868921697, 0.6024294784581032, 0.09356224967895359, -0.056309774554944625  …  -0.06471552746836559, -0.03318853905142208, -0.08014900835947326, -0.7219698121755709, 0.3459113868486332, 0.01353743762416946, 0.4064862892136047, 0.6164644821951585, -0.2614193318214129, 0.5009613437996556], [0.5283331643060123, -0.06833837582339186, 0.554403379352057, -0.05007911492747305, 0.5351239300037298, 0.7393797186126678, -0.5591642123259144, 0.6021199777618348, 0.09372484301012252, -0.05627127794901734  …  -0.06472967713279006, -0.033316203894785346, -0.08044286291266678, -0.7225284297770315, 0.3463823307223896, 0.012704758234050905, 0.4064752545683349, 0.6166748908067538, -0.26263466949520436, 0.5011736396245848], [0.5285108824397268, -0.06875153925714746, 0.5541773037940637, -0.049977921968899316, 0.5353262648156886, 0.7394944234995611, -0.5589600115929442, 0.6019717633997212, 0.09402853236272804, -0.056423491262775724  …  -0.06497110630411229, -0.033977545749243034, -0.0803194126827788, -0.7234783807510357, 0.3467679891465904, 0.011764658631982864, 0.4068527015533735, 0.6168206777057635, -0.26401765533729177, 0.5009869225834819]  …  [0.5322751609126188, -0.09443329688254672, 0.5450072226822299, -0.029279424082469644, 0.5346766809995489, 0.7393263612957355, -0.5381141552300843, 0.587281361424572, 0.09103540914848761, -0.06290460056345344  …  -0.07987152707668366, -0.06058509079293492, -0.07879502515015475, -0.8068282332591837, 0.3911767984915894, -0.06956613295513116, 0.42362982113517317, 0.6539913896959896, -0.35500750898461597, 0.5016351389392456], [0.5321147411846171, -0.09472453356928327, 0.5451231805485949, -0.02929648640451517, 0.5346676333951718, 0.73955948155012, -0.5378218546063318, 0.5869205791726888, 0.09098379627819611, -0.06309498753432911  …  -0.08019648959433677, -0.060880991662779535, -0.07906972393028922, -0.8077942070519619, 0.39185095681217963, -0.07022518914119356, 0.4239958377254148, 0.6546462543640058, -0.3557177020244635, 0.5017250818894362], [0.5318269835958465, -0.09577990965659726, 0.544551161505498, -0.0286341873895947, 0.534533223964812, 0.7394602418549447, -0.5378958484128769, 0.5864424640963621, 0.09086732629462752, -0.06337586600023787  …  -0.0804781045187918, -0.06216304548122442, -0.07883613404726512, -0.811107536895149, 0.393687495866452, -0.07292271591919337, 0.42481359303331434, 0.6563125679742654, -0.3588556510864129, 0.5018036494455439], [0.5318223268523208, -0.09594464847999344, 0.5441092559153363, -0.028097313323181113, 0.5346482760417781, 0.7393037269979182, -0.5370652654715702, 0.5855444663511448, 0.09123814959004396, -0.06322324822734432  …  -0.08067147615961515, -0.06353556019041792, -0.07903741400946152, -0.8151810222177114, 0.3954561570469244, -0.07570967475269696, 0.4262336551531283, 0.6585513590022296, -0.36180836973349856, 0.5013639291745392], [0.5320287809452054, -0.0962993453644245, 0.5440181416738604, -0.028092013380140498, 0.5347186213488512, 0.7393643959037558, -0.5368091103319359, 0.5854868879184872, 0.09130203724146013, -0.06323315146245725  …  -0.08079682691926592, -0.06396989164617133, -0.0788839941732206, -0.8160643310350628, 0.3960131343730821, -0.07630437887350688, 0.426448245496664, 0.6588885025953423, -0.36253143428173484, 0.5014600132230316], [0.5328827780312689, -0.09839733702977789, 0.5429724406606941, -0.025917143987397685, 0.5343201699122324, 0.7403226387264249, -0.5338741779961774, 0.5832656466562521, 0.09094267793784032, -0.06369676179335719  …  -0.08239004104415901, -0.06763007988584649, -0.0790917580111276, -0.8271164458540996, 0.4015096528804892, -0.08608014256919978, 0.43040638202947135, 0.6652531946889509, -0.37158409306251267, 0.5008944535675407], [0.5331118534504662, -0.09837957996617706, 0.5428569155035935, -0.025809228154076012, 0.5343586615290888, 0.7402769424710127, -0.5338258742916974, 0.5832723000087582, 0.09105244053583979, -0.06383548083727766  …  -0.08244857462556407, -0.06778305827728727, -0.0789607543729471, -0.8274691136978881, 0.4017148619634089, -0.08618191999108549, 0.4304869188456925, 0.6654084933296809, -0.37175850922972403, 0.5007602963794577], [0.5329185642585346, -0.09844761057092374, 0.5427546209141088, -0.02563441868622476, 0.5347807984353838, 0.740363184817317, -0.5336765431123077, 0.5829376192129976, 0.0911502295523063, -0.0638090458410359  …  -0.0826480932752915, -0.06790343378254622, -0.07890030853538012, -0.8282517867213778, 0.4022309340476698, -0.08706030925086218, 0.4306919757194611, 0.6659723417492612, -0.3722500691820003, 0.5007173313481472], [0.5330630321503206, -0.0988167928532428, 0.5425430485011655, -0.02541956901855724, 0.5344678567314893, 0.740429784741887, -0.5335280754731817, 0.582710983915642, 0.09135600686679521, -0.06374843362806952  …  -0.08285334361377648, -0.06839843286646663, -0.07923426818848182, -0.8290714914702234, 0.4028244911715492, -0.08782448592962051, 0.4312026356337668, 0.6661310280646086, -0.3729178953563373, 0.5007845561070057], [0.533007102800863, -0.09894200377390995, 0.5426136652763036, -0.02531152353831963, 0.5344343005566387, 0.7403547049491433, -0.5333936236769181, 0.5825764459868529, 0.09127974945406866, -0.06375264185221435  …  -0.082848098965, -0.06850434130732717, -0.07933181036481529, -0.8292243105991569, 0.40305567310418094, -0.08817695281516512, 0.4313377983270028, 0.6662288585980767, -0.3732061998350945, 0.5007384988605952]], NamedTuple[(n_steps = 2, is_accept = true, acceptance_rate = 0.5, log_density = -1.6752864596478932e6, hamiltonian_energy = 1.7300635470260982e6, hamiltonian_energy_error = -4753.764364385745, max_hamiltonian_energy_error = -4753.764364385745, tree_depth = 1, numerical_error = true, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6752864596478932e6, hamiltonian_energy = 1.6753465491430617e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 6.513028721289722e7, tree_depth = 0, numerical_error = true, step_size = 0.009055910606012648, nom_step_size = 0.009055910606012648, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.23521440516628345, log_density = -1.6483454185269654e6, hamiltonian_energy = 1.675349148036487e6, hamiltonian_energy_error = 0.3486455297097564, max_hamiltonian_energy_error = 1743.3691333809402, tree_depth = 1, numerical_error = true, step_size = 0.0011689984204270615, nom_step_size = 0.0011689984204270615, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.3818569940807299, log_density = -1.6483454185269654e6, hamiltonian_energy = 1.6483976434903801e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 2.7637295396998525, tree_depth = 2, numerical_error = false, step_size = 0.00018502372086338212, nom_step_size = 0.00018502372086338212, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9896200145783182, log_density = -1.6475405707986916e6, hamiltonian_energy = 1.6483996822059806e6, hamiltonian_energy_error = 0.019813027000054717, max_hamiltonian_energy_error = 0.028234211495146155, tree_depth = 3, numerical_error = false, step_size = 4.06664285623831e-5, nom_step_size = 4.06664285623831e-5, is_adapt = true), (n_steps = 63, is_accept = true, acceptance_rate = 0.49249832994428394, log_density = -1.6402783538347306e6, hamiltonian_energy = 1.6476125904738372e6, hamiltonian_energy_error = 0.34786421130411327, max_hamiltonian_energy_error = 4.06290312227793, tree_depth = 6, numerical_error = false, step_size = 5.5250195186401304e-5, nom_step_size = 5.5250195186401304e-5, is_adapt = true), (n_steps = 31, is_accept = true, acceptance_rate = 0.9859575938157186, log_density = -1.6378558014151878e6, hamiltonian_energy = 1.6403247100282253e6, hamiltonian_energy_error = 0.015189454657956958, max_hamiltonian_energy_error = 0.04106877441518009, tree_depth = 5, numerical_error = false, step_size = 1.8505163274148284e-5, nom_step_size = 1.8505163274148284e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9967559017894182, log_density = -1.637373295814649e6, hamiltonian_energy = 1.6379075444510623e6, hamiltonian_energy_error = 0.00942719541490078, max_hamiltonian_energy_error = 0.00942719541490078, tree_depth = 3, numerical_error = false, step_size = 2.952091966498187e-5, nom_step_size = 2.952091966498187e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9837925190523189, log_density = -1.636829113910126e6, hamiltonian_energy = 1.6374246987431424e6, hamiltonian_energy_error = 0.021142298821359873, max_hamiltonian_energy_error = 0.03911071177572012, tree_depth = 3, numerical_error = false, step_size = 5.15679622644271e-5, nom_step_size = 5.15679622644271e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.8590302699732479, log_density = -1.636167366431187e6, hamiltonian_energy = 1.6368907415082215e6, hamiltonian_energy_error = 0.1047419982496649, max_hamiltonian_energy_error = 0.41532604419626296, tree_depth = 3, numerical_error = false, step_size = 8.962790504633575e-5, nom_step_size = 8.962790504633575e-5, is_adapt = true)  …  (n_steps = 3, is_accept = true, acceptance_rate = 0.9181639941467599, log_density = -1.5756623533849863e6, hamiltonian_energy = 1.5758989917974807e6, hamiltonian_energy_error = 0.05236431839875877, max_hamiltonian_energy_error = 0.18407932599075139, tree_depth = 2, numerical_error = false, step_size = 7.733668982546683e-5, nom_step_size = 7.733668982546683e-5, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 0.924898840029939, log_density = -1.5750050902486327e6, hamiltonian_energy = 1.5757141379023765e6, hamiltonian_energy_error = 0.1597044924274087, max_hamiltonian_energy_error = 0.1597044924274087, tree_depth = 2, numerical_error = false, step_size = 7.733668982546683e-5, nom_step_size = 7.733668982546683e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.7993085040127819, log_density = -1.5724762764472275e6, hamiltonian_energy = 1.575059052280942e6, hamiltonian_energy_error = 0.5635897638276219, max_hamiltonian_energy_error = 0.5635897638276219, tree_depth = 3, numerical_error = false, step_size = 7.733668982546683e-5, nom_step_size = 7.733668982546683e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.2486168844215635, log_density = -1.569686801633001e6, hamiltonian_energy = 1.5725233575643979e6, hamiltonian_energy_error = 0.6955169113352895, max_hamiltonian_energy_error = 11.443575498880818, tree_depth = 5, numerical_error = false, step_size = 7.733668982546683e-5, nom_step_size = 7.733668982546683e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.7873178852178639, log_density = -1.5690437145672552e6, hamiltonian_energy = 1.569740734958689e6, hamiltonian_energy_error = 0.14440498291514814, max_hamiltonian_energy_error = 0.6282924429979175, tree_depth = 3, numerical_error = false, step_size = 7.733668982546683e-5, nom_step_size = 7.733668982546683e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.4937506040286702, log_density = -1.5604309607569512e6, hamiltonian_energy = 1.5690928602222656e6, hamiltonian_energy_error = 2.1043341832701117, max_hamiltonian_energy_error = 2.762188910273835, tree_depth = 4, numerical_error = false, step_size = 7.733668982546683e-5, nom_step_size = 7.733668982546683e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.7712452879446248, log_density = -1.5602732524539444e6, hamiltonian_energy = 1.5605048639791415e6, hamiltonian_energy_error = 0.03865254786796868, max_hamiltonian_energy_error = 0.7044084018561989, tree_depth = 3, numerical_error = false, step_size = 7.733668982546683e-5, nom_step_size = 7.733668982546683e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.24311207639949656, log_density = -1.5595789679432807e6, hamiltonian_energy = 1.5603205664927154e6, hamiltonian_energy_error = 0.179750558687374, max_hamiltonian_energy_error = 10.69589313515462, tree_depth = 4, numerical_error = false, step_size = 7.733668982546683e-5, nom_step_size = 7.733668982546683e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 0.7681645900093955, log_density = -1.5588311639426246e6, hamiltonian_energy = 1.5596461370647363e6, hamiltonian_energy_error = 0.18488665740005672, max_hamiltonian_energy_error = 0.7344464792404324, tree_depth = 3, numerical_error = false, step_size = 7.733668982546683e-5, nom_step_size = 7.733668982546683e-5, is_adapt = false), (n_steps = 3, is_accept = true, acceptance_rate = 0.909177743617018, log_density = -1.5586015381866838e6, hamiltonian_energy = 1.5588789100498888e6, hamiltonian_energy_error = 0.054489843314513564, max_hamiltonian_energy_error = 0.20139431627467275, tree_depth = 2, numerical_error = false, step_size = 7.733668982546683e-5, nom_step_size = 7.733668982546683e-5, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-0.817 ± 0.025, -0.817 ± 0.025, -0.818 ± 0.025, -0.818 ± 0.025, -0.818 ± 0.025, -0.818 ± 0.025, -0.818 ± 0.025, -0.818 ± 0.025, -0.818 ± 0.025, -0.818 ± 0.025  …  -0.537 ± 0.031, -0.537 ± 0.031, -0.537 ± 0.031, -0.537 ± 0.031, -0.537 ± 0.031, -0.537 ± 0.031, -0.537 ± 0.031, -0.537 ± 0.031, -0.537 ± 0.031, -0.538 ± 0.031]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.532 ± 0.0005 0.0914 ± 0.00027; -0.093 ± 0.0032 -0.0627 ± 0.00061; … ; -0.54 ± 0.0032 0.755 ± 0.0068; 0.588 ± 0.0026 0.742 ± 0.0039], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.0185 ± 0.00045; -0.0364 ± 0.0022; … ; 0.0949 ± 0.014; 0.179 ± 0.013;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.517 ± 0.00035 -0.0916 ± 0.00081 … -0.196 ± 0.00098 0.183 ± 0.00059; -0.205 ± 0.00045 0.51 ± 0.00033 … -0.16 ± 0.00071 -0.429 ± 0.001; … ; -0.383 ± 0.0011 -0.259 ± 0.00064 … 0.108 ± 0.0053 0.588 ± 0.0051; -0.209 ± 0.00027 0.291 ± 0.00073 … -0.137 ± 0.011 0.153 ± 0.0063], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.00161 ± 0.00046; 0.00476 ± 0.00047; … ; -0.0701 ± 0.0022; -0.204 ± 0.0071;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.0791 ± 0.0019 -0.059 ± 0.0049 … 0.423 ± 0.0041 0.652 ± 0.007], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.35 ± 0.012;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.502 ± 0.00071], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="492d1fba.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Friday 15 March 2024 00:58">Friday 15 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
