<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li><li><a class="tocitem" href="../dgm/">Deep Galerkin Method</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -3.8445849091861732
 -3.840544755967435
 -3.8657390815246937
 -3.8556551847823672
 -3.9578641511451345
 -4.300994387237016
 -4.2265270906309365
 -4.183162460853436
 -4.00441306573493
 -3.71557803818024
  ⋮
 -3.788451545514364
 -3.9639057597109777
 -3.9926752235262004
 -3.9429020454013703
 -4.3496849936275845
 -3.699735847083607
 -4.128415727127127
 -3.85851440600894
 -3.9989327572734923</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="9b3f12d1.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[-0.07606450160797888, -0.21524783876455628, -0.556695181660547, -0.6319089146777417, -0.4172510594660174, 0.22237885364456234, 0.24417812164623498, 0.23326149808552923, -0.6164142614750561, 0.15108284884919926  …  -0.4022022263064294, -0.23593526300460516, -0.6632078108982294, -0.4712089760149241, -0.19995616006553626, 0.2551905168594825, 0.7069534497596268, 0.02677420549656745, -0.1719359226434854, 0.5004486311133277], [-0.07606450160797888, -0.21524783876455628, -0.556695181660547, -0.6319089146777417, -0.4172510594660174, 0.22237885364456234, 0.24417812164623498, 0.23326149808552923, -0.6164142614750561, 0.15108284884919926  …  -0.4022022263064294, -0.23593526300460516, -0.6632078108982294, -0.4712089760149241, -0.19995616006553626, 0.2551905168594825, 0.7069534497596268, 0.02677420549656745, -0.1719359226434854, 0.5004486311133277], [-0.07606450160797888, -0.21524783876455628, -0.556695181660547, -0.6319089146777417, -0.4172510594660174, 0.22237885364456234, 0.24417812164623498, 0.23326149808552923, -0.6164142614750561, 0.15108284884919926  …  -0.4022022263064294, -0.23593526300460516, -0.6632078108982294, -0.4712089760149241, -0.19995616006553626, 0.2551905168594825, 0.7069534497596268, 0.02677420549656745, -0.1719359226434854, 0.5004486311133277], [-0.07597399810219069, -0.2156884103021012, -0.5566987773412054, -0.631766335673954, -0.41739082432014923, 0.2225311117295493, 0.24441893590052677, 0.23355991794849537, -0.6163077933595011, 0.15065028899278218  …  -0.4024198808096845, -0.23656299298570543, -0.6635390618396524, -0.47190058545965957, -0.20011920518538753, 0.25521637151200466, 0.7072054894413087, 0.02652857201402815, -0.17331543692023907, 0.5005859331449718], [-0.07585329722820049, -0.21614046819102953, -0.5566860375259469, -0.6319064696511861, -0.4174473484473386, 0.2226445105783016, 0.24449960005751695, 0.2333578312176297, -0.6163588736210995, 0.15070487282799022  …  -0.4028826239592159, -0.23679164080210355, -0.6639128033913001, -0.4723522770563677, -0.20041943450434035, 0.2550511052613007, 0.7075455557046338, 0.026345755248597346, -0.17408298968671504, 0.5005831416475343], [-0.07467481281942291, -0.21810156085318516, -0.5565129316174919, -0.6320050223056621, -0.41712955147900566, 0.22256394575538746, 0.2449725526990454, 0.2338171922997365, -0.6165820436500999, 0.14891892322390526  …  -0.40373040096504736, -0.23833982539279297, -0.6651955554202598, -0.47453296975003634, -0.2008777066811637, 0.25519283432418804, 0.7091542485569963, 0.025822499537647134, -0.17828999252859354, 0.5005086900300432], [-0.07218987747852418, -0.22068387874198897, -0.5561525861415322, -0.6324585284480929, -0.4168786569056771, 0.22203938030863665, 0.24597084287492862, 0.23382790613540042, -0.6172720611954011, 0.14624776542194667  …  -0.4048499274769974, -0.2397185422613578, -0.667596453992138, -0.4774500585152463, -0.2018474925743387, 0.2552862031473604, 0.7112624802795403, 0.025319012639960396, -0.1848293145670371, 0.5002319147827976], [-0.0719751373328721, -0.22091227491672596, -0.5561172967966885, -0.6322842426406531, -0.4171109713458879, 0.22196480020737244, 0.24638644046114064, 0.23375393664620847, -0.6175005336000825, 0.14572373107354314  …  -0.40518081128349354, -0.23978104417649432, -0.6680316763912137, -0.47786468417734085, -0.20195676561020076, 0.25517132309452056, 0.711341870733319, 0.025339086729022162, -0.18596849205948954, 0.5001832001274106], [-0.07191933092308486, -0.2209841420839221, -0.5562637330633706, -0.6323392110104721, -0.41710108979072513, 0.22201852939453418, 0.2464170090063605, 0.23377269647178572, -0.6173861113856375, 0.14557087818180917  …  -0.40525082289684355, -0.2398696552608744, -0.6681020593325548, -0.4779613652637282, -0.20199174027536634, 0.25523804043344617, 0.7113467399343548, 0.025267183670050927, -0.18624463088065454, 0.5000500834073822], [-0.07172792717066175, -0.22116956319601888, -0.5563991581401443, -0.6322782382614703, -0.41697318088816365, 0.22208264256727367, 0.24666876104857036, 0.23379853437259993, -0.6175631188527924, 0.14543008116756387  …  -0.40537262832070053, -0.24001900106563967, -0.6683463778280987, -0.47831801631393567, -0.20218804027568413, 0.25524237770324276, 0.7113692704235137, 0.02520121735997248, -0.18672888441438062, 0.4999690746152473]  …  [0.05192482640917975, -0.6576627863822595, -0.9976982170678724, -1.1211919110222328, -0.6925027512678488, 0.46574077047947765, 0.7157286615337464, 0.7454821564310153, -0.8959309691787409, 0.5223689281147091  …  -2.0204492251305246, -0.8071387145014709, -2.803161847182738, -2.703693671538234, -1.623284586096523, 0.9534243505932417, 2.718945140920446, 0.9417133508107329, 0.35635472396417484, 0.45337866014993483], [0.05140682413443981, -0.6577518337764018, -0.9984844986127318, -1.1195234131824288, -0.6926934967720314, 0.4647782551237003, 0.7156749783520819, 0.745289336081285, -0.8972741613672893, 0.5238977447057054  …  -2.021468159141406, -0.8077723406807894, -2.8040097628150806, -2.705424053247531, -1.6245337031379536, 0.9531299073987082, 2.720338239450469, 0.9435286626251055, 0.3564864843400447, 0.4519935141079997], [0.05153124071970048, -0.6566926706518106, -1.0013700353099535, -1.1120265304111365, -0.6923451972064674, 0.46221002978191184, 0.7133045107608096, 0.7459951495514217, -0.9006313051847882, 0.525203673698933  …  -2.024883672792162, -0.8092375822662576, -2.807474844270182, -2.71077470919993, -1.6294152575764722, 0.9535234043815649, 2.724279557528823, 0.9471411960948998, 0.3588755690476697, 0.4497449343364013], [0.0506970216745139, -0.6560510437276966, -1.0044070661831004, -1.109189701359006, -0.6927784097231365, 0.4606492348878669, 0.713929877580009, 0.7460281115655282, -0.900819673268035, 0.5240195107465997  …  -2.027730785883944, -0.8106178456865852, -2.808973861754137, -2.7133260111508894, -1.631266638227813, 0.9556920719878126, 2.7270638779613603, 0.9489350995844483, 0.36043122575628583, 0.4498123984459345], [0.05325773924084501, -0.6560168052900709, -1.0099173842661715, -1.0952969859910073, -0.6912964227382139, 0.45187604046703, 0.710087890672849, 0.7495620375003362, -0.9026430237986087, 0.5241994531324567  …  -2.0383970952347332, -0.8139325969417944, -2.8130018301632123, -2.7236034951878785, -1.6397691529491871, 0.9576593341725672, 2.7345283002108403, 0.9581535224346951, 0.3680049810483619, 0.4505342842619644], [0.05347955765970396, -0.6559148863959342, -1.0094486475505322, -1.0948715299728675, -0.6911734523282937, 0.45144958109662703, 0.7101796668831746, 0.7496012418046706, -0.9029268874035451, 0.5245528789915814  …  -2.0388027754018667, -0.8137296117653386, -2.813309383919474, -2.7240554372212284, -1.6402106108879897, 0.9579223138159751, 2.735014907617874, 0.9587756215236513, 0.36860888198877056, 0.45080792347089554], [0.057762787952844716, -0.634415033941898, -1.1016962763079208, -0.9094879853520662, -0.7132607830773923, 0.3687474028393977, 0.6556808098894146, 0.820962894648275, -0.9600625119406557, 0.473508369788173  …  -2.1945266817300544, -0.8960703997376429, -2.922845315595981, -2.8543368153735322, -1.7986164688299404, 1.0389948446280506, 2.8736713694118667, 1.1025091595554641, 0.4923039344697277, 0.4426316602829487], [0.057163989971841696, -0.6345821702742463, -1.1016107141354115, -0.9112866578047992, -0.7131403918729976, 0.369693332809125, 0.6558709432826402, 0.8213195121908482, -0.9601175074474159, 0.4727639459989914  …  -2.194614040372922, -0.896063970422569, -2.9227354638101777, -2.8545066122751264, -1.7983444861127642, 1.0389906261786346, 2.873933930683494, 1.1027810634502515, 0.4921664025078837, 0.44286429575426073], [0.0566929197160364, -0.6340553035693182, -1.1020892361755001, -0.9116129525979123, -0.7134386469259445, 0.36961927617177837, 0.655994635762151, 0.8211626556562387, -0.9601292986347956, 0.47280435058581083  …  -2.1946458734343897, -0.896115585382528, -2.9227508417169092, -2.854967813401451, -1.798251234246613, 1.039100944850718, 2.8740511622593425, 1.1026979266452785, 0.49257622829460734, 0.442900280132325], [0.05536168531995112, -0.6224939855204513, -1.1021279224115166, -0.9213143666508073, -0.7154652207346827, 0.37168734440774387, 0.6550333305229615, 0.8195952917698196, -0.9617041940879708, 0.4767490524331442  …  -2.1959868054662532, -0.8975870179718362, -2.924772108760592, -2.856063890518374, -1.7997208586028042, 1.0401965177524657, 2.8757273872957883, 1.1031726380168212, 0.49509072263626824, 0.4431150458601391]], NamedTuple[(n_steps = 3, is_accept = true, acceptance_rate = 0.6666666666666666, log_density = -1.5926206346976792e6, hamiltonian_energy = 1.6708170235849074e6, hamiltonian_energy_error = -1651.204661045922, max_hamiltonian_energy_error = 18184.024628432002, tree_depth = 1, numerical_error = true, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.5926206346976792e6, hamiltonian_energy = 1.5926827616507711e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 3.813663504126325e19, tree_depth = 0, numerical_error = true, step_size = 0.012261299907089943, nom_step_size = 0.012261299907089943, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.5926206346976792e6, hamiltonian_energy = 1.5926629090583068e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 9444.56941561005, tree_depth = 0, numerical_error = true, step_size = 0.001731493674964374, nom_step_size = 0.001731493674964374, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.10220373816144955, log_density = -1.5919004957297293e6, hamiltonian_energy = 1.5926712968093618e6, hamiltonian_energy_error = 0.5147962931077927, max_hamiltonian_energy_error = 28.26703438954428, tree_depth = 3, numerical_error = false, step_size = 0.00015413445733897217, nom_step_size = 0.00015413445733897217, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9965120302954193, log_density = -1.591397612682192e6, hamiltonian_energy = 1.5919625864152682e6, hamiltonian_energy_error = 0.004187626764178276, max_hamiltonian_energy_error = 0.010261069983243942, tree_depth = 4, numerical_error = false, step_size = 1.5037437379015789e-5, nom_step_size = 1.5037437379015789e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9893881075114624, log_density = -1.5888804146525522e6, hamiltonian_energy = 1.5914414084676297e6, hamiltonian_energy_error = 0.03143357904627919, max_hamiltonian_energy_error = 0.03143357904627919, tree_depth = 4, numerical_error = false, step_size = 1.9971077519840308e-5, nom_step_size = 1.9971077519840308e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 0.9650756697009648, log_density = -1.5846662827855463e6, hamiltonian_energy = 1.588938680363319e6, hamiltonian_energy_error = 0.11904332367703319, max_hamiltonian_energy_error = 0.11904332367703319, tree_depth = 4, numerical_error = false, step_size = 2.9797269231559636e-5, nom_step_size = 2.9797269231559636e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9509992917274245, log_density = -1.584097743518141e6, hamiltonian_energy = 1.5847256245639715e6, hamiltonian_energy_error = 0.031769514782354236, max_hamiltonian_energy_error = 0.14724746509455144, tree_depth = 3, numerical_error = false, step_size = 4.489692995720628e-5, nom_step_size = 4.489692995720628e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.9565142222987456, log_density = -1.583951977273631e6, hamiltonian_energy = 1.5841452328330984e6, hamiltonian_energy_error = 0.01766990590840578, max_hamiltonian_energy_error = 0.08500415552407503, tree_depth = 2, numerical_error = false, step_size = 6.819826771136551e-5, nom_step_size = 6.819826771136551e-5, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.47095688932140545, log_density = -1.583582592987852e6, hamiltonian_energy = 1.5839977155610572e6, hamiltonian_energy_error = 0.14489950332790613, max_hamiltonian_energy_error = 2.525441430741921, tree_depth = 3, numerical_error = false, step_size = 0.00010889618874079702, nom_step_size = 0.00010889618874079702, is_adapt = true)  …  (n_steps = 15, is_accept = true, acceptance_rate = 1.0, log_density = -62116.37540672183, hamiltonian_energy = 62430.93012325678, hamiltonian_energy_error = -3.434207819205767, max_hamiltonian_energy_error = -3.6874081733403727, tree_depth = 4, numerical_error = false, step_size = 6.587869544219834e-5, nom_step_size = 6.587869544219834e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9785628559956874, log_density = -61768.864656745696, hamiltonian_energy = 62165.18604749942, hamiltonian_energy_error = -0.10078491250169463, max_hamiltonian_energy_error = -0.2388747048244113, tree_depth = 4, numerical_error = false, step_size = 6.587869544219834e-5, nom_step_size = 6.587869544219834e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9898083160050642, log_density = -60645.385458028206, hamiltonian_energy = 61821.51710930343, hamiltonian_energy_error = -0.09363677669898607, max_hamiltonian_energy_error = -0.2552808782784268, tree_depth = 5, numerical_error = false, step_size = 6.587869544219834e-5, nom_step_size = 6.587869544219834e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9962154396008813, log_density = -60094.431767303424, hamiltonian_energy = 60707.8987794823, hamiltonian_energy_error = -0.05299219312291825, max_hamiltonian_energy_error = -0.18898412749695126, tree_depth = 5, numerical_error = false, step_size = 6.587869544219834e-5, nom_step_size = 6.587869544219834e-5, is_adapt = false), (n_steps = 31, is_accept = true, acceptance_rate = 0.9882827782616461, log_density = -58092.74514273446, hamiltonian_energy = 60136.66631220814, hamiltonian_energy_error = -0.11207019288121955, max_hamiltonian_energy_error = -0.21737759177631233, tree_depth = 5, numerical_error = false, step_size = 6.587869544219834e-5, nom_step_size = 6.587869544219834e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.9657153180429688, log_density = -58005.24440800945, hamiltonian_energy = 58136.10322842953, hamiltonian_energy_error = -0.07034237095649587, max_hamiltonian_energy_error = -0.13283036877692211, tree_depth = 4, numerical_error = false, step_size = 6.587869544219834e-5, nom_step_size = 6.587869544219834e-5, is_adapt = false), (n_steps = 127, is_accept = true, acceptance_rate = 0.9487177799833855, log_density = -33093.18332202516, hamiltonian_energy = 58031.911039444196, hamiltonian_energy_error = -19.950012202578364, max_hamiltonian_energy_error = -19.950012202578364, tree_depth = 7, numerical_error = false, step_size = 6.587869544219834e-5, nom_step_size = 6.587869544219834e-5, is_adapt = false), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -32736.80163135512, hamiltonian_energy = 33128.45128052289, hamiltonian_energy_error = -12.282362368081522, max_hamiltonian_energy_error = -12.282362368081522, tree_depth = 3, numerical_error = false, step_size = 6.587869544219834e-5, nom_step_size = 6.587869544219834e-5, is_adapt = false), (n_steps = 15, is_accept = true, acceptance_rate = 0.998191298990976, log_density = -32638.112159206616, hamiltonian_energy = 32801.74566251864, hamiltonian_energy_error = -0.8260968046597554, max_hamiltonian_energy_error = -1.129144031307078, tree_depth = 4, numerical_error = false, step_size = 6.587869544219834e-5, nom_step_size = 6.587869544219834e-5, is_adapt = false), (n_steps = 63, is_accept = true, acceptance_rate = 0.9997114374434091, log_density = -31776.503998981018, hamiltonian_energy = 32682.77608188684, hamiltonian_energy_error = -1.2636687523845467, max_hamiltonian_energy_error = -1.6171114919816318, tree_depth = 6, numerical_error = false, step_size = 6.587869544219834e-5, nom_step_size = 6.587869544219834e-5, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-3.53 ± 0.053, -3.52 ± 0.053, -3.52 ± 0.052, -3.52 ± 0.052, -3.52 ± 0.051, -3.52 ± 0.051, -3.52 ± 0.051, -3.52 ± 0.05, -3.52 ± 0.05, -3.52 ± 0.049  …  -4.32 ± 0.062, -4.32 ± 0.061, -4.32 ± 0.061, -4.32 ± 0.061, -4.32 ± 0.061, -4.32 ± 0.061, -4.32 ± 0.061, -4.32 ± 0.061, -4.32 ± 0.061, -4.32 ± 0.061]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2))), bias = ViewAxis(17:24, ShapedAxis((8, 1))))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8))), bias = ViewAxis(65:72, ShapedAxis((8, 1))))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8))), bias = ViewAxis(9:9, ShapedAxis((1, 1))))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.0368 ± 0.033 -0.863 ± 0.068; -0.642 ± 0.053 0.476 ± 0.057; … ; 0.69 ± 0.038 0.276 ± 0.12; 0.771 ± 0.044 -0.718 ± 0.12], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.108 ± 0.068; -1.11 ± 0.062; … ; 0.368 ± 0.031; -0.521 ± 0.077;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.552 ± 0.071 0.604 ± 0.051 … -0.275 ± 0.018 -0.147 ± 0.02; -0.421 ± 0.014 -0.232 ± 0.093 … -0.772 ± 0.0098 0.196 ± 0.051; … ; 0.437 ± 0.073 -0.814 ± 0.082 … -0.0298 ± 0.12 -0.432 ± 0.016; -0.01 ± 0.0071 -0.755 ± 0.069 … -0.563 ± 0.0052 0.127 ± 0.045], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.149 ± 0.057; -0.138 ± 0.086; … ; -0.475 ± 0.036; 0.187 ± 0.07;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-1.86 ± 0.29 -0.722 ± 0.15 … 2.57 ± 0.27 0.799 ± 0.25], bias = MonteCarloMeasurements.Particles{Float64, 34}[0.184 ± 0.3;;]))], MonteCarloMeasurements.Particles{Float64, 34}[0.466 ± 0.02], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="f1e90db6.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Wednesday 6 March 2024 15:57">Wednesday 6 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
