<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>PhysicsInformedNN Discretizer for PDESystems · NeuralPDE.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/manual/pinns/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/ode/">Introduction to NeuralPDE for ODEs</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li><a class="tocitem" href="../../tutorials/gpu/">Using GPUs</a></li><li><a class="tocitem" href="../../tutorials/systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../../tutorials/constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../../tutorials/low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../../tutorials/param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../../tutorials/integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../../tutorials/neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../../tutorials/derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li class="is-active"><a class="tocitem" href><code>PhysicsInformedNN</code> Discretizer for PDESystems</a><ul class="internal"><li><a class="tocitem" href="#The-PhysicsInformedNN-Discretizer"><span>The <code>PhysicsInformedNN</code> Discretizer</span></a></li><li><a class="tocitem" href="#symbolic_discretize-and-the-lower-level-interface"><span><code>symbolic_discretize</code> and the lower-level interface</span></a></li></ul></li><li><a class="tocitem" href="../training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../logging/">Logging Utilities</a></li><li><a class="tocitem" href="../neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/manual/pinns.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="PhysicsInformedNN-Discretizer-for-PDESystems"><a class="docs-heading-anchor" href="#PhysicsInformedNN-Discretizer-for-PDESystems"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a><a id="PhysicsInformedNN-Discretizer-for-PDESystems-1"></a><a class="docs-heading-anchor-permalink" href="#PhysicsInformedNN-Discretizer-for-PDESystems" title="Permalink"></a></h1><p>Using the PINNs solver, we can solve general nonlinear PDEs:</p><p><img src="https://user-images.githubusercontent.com/12683885/86625781-5648c800-bfce-11ea-9d99-fbcb5c37fe0c.png" alt="generalPDE"/></p><p>with suitable boundary conditions:</p><p><img src="https://user-images.githubusercontent.com/12683885/86625874-8001ef00-bfce-11ea-9417-1a216c7d90aa.png" alt="bcs"/></p><p>where time t is a special component of x, and Ω contains the temporal domain.</p><p>PDEs are defined using the ModelingToolkit.jl <code>PDESystem</code>:</p><pre><code class="language-julia hljs">@named pde_system = PDESystem(eq,bcs,domains,param,var)</code></pre><p>Here, <code>eq</code> is the equation, <code>bcs</code> represents the boundary conditions, <code>param</code> is the parameter of the equation (like <code>[x,y]</code>), and <code>var</code> represents variables (like <code>[u]</code>). For more information, see the <a href="https://docs.sciml.ai/ModelingToolkit/stable/systems/PDESystem/">ModelingToolkit.jl PDESystem documentation</a>.</p><h2 id="The-PhysicsInformedNN-Discretizer"><a class="docs-heading-anchor" href="#The-PhysicsInformedNN-Discretizer">The <code>PhysicsInformedNN</code> Discretizer</a><a id="The-PhysicsInformedNN-Discretizer-1"></a><a class="docs-heading-anchor-permalink" href="#The-PhysicsInformedNN-Discretizer" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="NeuralPDE.PhysicsInformedNN" href="#NeuralPDE.PhysicsInformedNN"><code>NeuralPDE.PhysicsInformedNN</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PhysicsInformedNN(chain,
                  strategy;
                  init_params = nothing,
                  phi = nothing,
                  param_estim = false,
                  additional_loss = nothing,
                  adaptive_loss = nothing,
                  logger = nothing,
                  log_options = LogOptions(),
                  iteration = nothing,
                  kwargs...) where {iip}</code></pre><p>A <code>discretize</code> algorithm for the ModelingToolkit PDESystem interface which transforms a <code>PDESystem</code> into an <code>OptimizationProblem</code> using the Physics-Informed Neural Networks (PINN) methodology.</p><p><strong>Positional Arguments</strong></p><ul><li><code>chain</code>: a vector of Flux.jl or Lux.jl chains with a d-dimensional input and a 1-dimensional output corresponding to each of the dependent variables. Note that this specification respects the order of the dependent variables as specified in the PDESystem.</li><li><code>strategy</code>: determines which training strategy will be used. See the Training Strategy documentation for more details.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>init_params</code>: the initial parameters of the neural networks. This should match the specification of the chosen <code>chain</code> library. For example, if a Flux.chain is used, then <code>init_params</code> should match <code>Flux.destructure(chain)[1]</code> in shape. If <code>init_params</code> is not given, then the neural network default parameters are used. Note that for Lux, the default will convert to Float64.</li><li><code>phi</code>: a trial solution, specified as <code>phi(x,p)</code> where <code>x</code> is the coordinates vector for the dependent variable and <code>p</code> are the weights of the phi function (generally the weights of the neural network defining <code>phi</code>). By default this is generated from the <code>chain</code>. This should only be used to more directly impose functional information in the training problem, for example imposing the boundary condition by the test function formulation.</li><li><code>adaptive_loss</code>: the choice for the adaptive loss function. See the <a href="manual/@id adaptive_loss">adaptive loss page</a> for more details. Defaults to no adaptivity.</li><li><code>additional_loss</code>: a function <code>additional_loss(phi, θ, p_)</code> where <code>phi</code> are the neural network trial solutions, <code>θ</code> are the weights of the neural network(s), and <code>p_</code> are the hyperparameters of the <code>OptimizationProblem</code>. If <code>param_estim = true</code>, then <code>θ</code> additionally contains the parameters of the differential equation appended to the end of the vector.</li><li><code>param_estim</code>: whether the parameters of the differential equation should be included in the values sent to the <code>additional_loss</code> function. Defaults to <code>false</code>.</li><li><code>logger</code>: ?? needs docs</li><li><code>log_options</code>: ?? why is this separate from the logger?</li><li><code>iteration</code>: used to control the iteration counter???</li><li><code>kwargs</code>: Extra keyword arguments which are splatted to the <code>OptimizationProblem</code> on <code>solve</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralPDE.jl/blob/0e32c6af36fb1b6707a5b25fabd21e11a55dc45c/src/pinn_types.jl#L29-L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeuralPDE.Phi" href="#NeuralPDE.Phi"><code>NeuralPDE.Phi</code></a> — <span class="docstring-category">Type</span></header><section><div><p>An encoding of the test function phi that is used for calculating the PDE value at domain points x</p><p>Fields:</p><ul><li><code>f</code>: A representation of the chain function. If FastChain, then <code>f(x,p)</code>, if Chain then <code>f(p)(x)</code> (from Flux.destructure)</li><li><code>st</code>: The state of the Lux.AbstractExplicitLayer. If a Flux.Chain then this is <code>nothing</code>. It should be updated on each call.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralPDE.jl/blob/0e32c6af36fb1b6707a5b25fabd21e11a55dc45c/src/pinn_types.jl#L334-L344">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SciMLBase.discretize-Tuple{PDESystem, PhysicsInformedNN}" href="#SciMLBase.discretize-Tuple{PDESystem, PhysicsInformedNN}"><code>SciMLBase.discretize</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">prob = discretize(pde_system::PDESystem, discretization::PhysicsInformedNN)</code></pre><p>Transforms a symbolic description of a ModelingToolkit-defined <code>PDESystem</code> and generates an <code>OptimizationProblem</code> for <a href="https://docs.sciml.ai/Optimization/stable/">Optimization.jl</a> whose solution is the solution to the PDE.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralPDE.jl/blob/0e32c6af36fb1b6707a5b25fabd21e11a55dc45c/src/discretize.jl#L669-L677">source</a></section></article><h2 id="symbolic_discretize-and-the-lower-level-interface"><a class="docs-heading-anchor" href="#symbolic_discretize-and-the-lower-level-interface"><code>symbolic_discretize</code> and the lower-level interface</a><a id="symbolic_discretize-and-the-lower-level-interface-1"></a><a class="docs-heading-anchor-permalink" href="#symbolic_discretize-and-the-lower-level-interface" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SciMLBase.symbolic_discretize-Tuple{PDESystem, PhysicsInformedNN}" href="#SciMLBase.symbolic_discretize-Tuple{PDESystem, PhysicsInformedNN}"><code>SciMLBase.symbolic_discretize</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">prob = symbolic_discretize(pde_system::PDESystem, discretization::PhysicsInformedNN)</code></pre><p><code>symbolic_discretize</code> is the lower level interface to <code>discretize</code> for inspecting internals. It transforms a symbolic description of a ModelingToolkit-defined <code>PDESystem</code> into a <code>PINNRepresentation</code> which holds the pieces required to build an <code>OptimizationProblem</code> for <a href="https://docs.sciml.ai/Optimization/stable">Optimization.jl</a> whose solution is the solution to the PDE.</p><p>For more information, see <code>discretize</code> and <code>PINNRepresentation</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralPDE.jl/blob/0e32c6af36fb1b6707a5b25fabd21e11a55dc45c/src/discretize.jl#L390-L402">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeuralPDE.PINNRepresentation" href="#NeuralPDE.PINNRepresentation"><code>NeuralPDE.PINNRepresentation</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>PINNRepresentation</code>`</p><p>An internal reprsentation of a physics-informed neural network (PINN). This is the struct used internally and returned for introspection by <code>symbolic_discretize</code>.</p><p><strong>Fields</strong></p><ul><li><code>eqs</code>: The equations of the PDE</li></ul><ul><li><code>bcs</code>: The boundary condition equations</li></ul><ul><li><code>domains</code>: The domains for each of the independent variables</li></ul><ul><li><code>eq_params</code>: ???</li></ul><ul><li><code>defaults</code>: ???</li></ul><ul><li><code>default_p</code>: ???</li></ul><ul><li><code>param_estim</code>: Whether parameters are to be appended to the <code>additional_loss</code></li></ul><ul><li><code>additional_loss</code>: The <code>additional_loss</code> function as provided by the user</li></ul><ul><li><code>adaloss</code>: The adaptive loss function</li></ul><ul><li><code>depvars</code>: The dependent variables of the system</li></ul><ul><li><code>indvars</code>: The independent variables of the system</li></ul><ul><li><code>dict_indvars</code>: A dictionary form of the independent variables. Define the structure ???</li></ul><ul><li><code>dict_depvars</code>: A dictionary form of the dependent variables. Define the structure ???</li></ul><ul><li><code>dict_depvar_input</code>: ???</li></ul><ul><li><code>logger</code>: The logger as provided by the user</li></ul><ul><li><code>multioutput</code>: Whether there are multiple outputs, i.e. a system of PDEs</li></ul><ul><li><code>iteration</code>: The iteration counter used inside of the cost function</li></ul><ul><li><code>init_params</code>: The initial parameters as provided by the user. If the PDE is a system of PDEs, this will be an array of arrays. If Lux.jl is used, then this is an array of ComponentArrays.</li></ul><ul><li><code>flat_init_params</code>: The initial parameters as a flattened array. This is the array that is used in the construction of the OptimizationProblem. If a Lux.jl neural network is used, then this flattened form is a <code>ComponentArray</code>. If the equation is a system of equations, then <code>flat_init_params.depvar.x</code> are the parameters for the neural network corresponding to the dependent variable <code>x</code>, and i.e. if <code>depvar[i] == :x</code> then for <code>phi[i]</code>. If <code>param_estim = true</code>, then <code>flat_init_params.p</code> are the parameters and <code>flat_init_params.depvar.x</code> are the neural network parameters, so <code>flat_init_params.depvar.x</code> would be the parameters of the neural network for the dependent variable <code>x</code> if it&#39;s a system. If a Flux.jl neural network is used, this is simply an <code>AbstractArray</code> to be indexed and the sizes from the chains must be remembered/stored/used.</li></ul><ul><li><code>phi</code>: The representation of the test function of the PDE solution</li></ul><ul><li><code>derivative</code>: The function used for computing the derivative</li></ul><ul><li><code>strategy</code>: The training strategy as provided by the user</li></ul><ul><li><code>pde_indvars</code>: ???</li></ul><ul><li><code>bc_indvars</code>: ???</li></ul><ul><li><code>pde_integration_vars</code>: ???</li></ul><ul><li><code>bc_integration_vars</code>: ???</li></ul><ul><li><code>integral</code>: ???</li></ul><ul><li><code>symbolic_pde_loss_functions</code>: The PDE loss functions as represented in Julia AST</li></ul><ul><li><code>symbolic_bc_loss_functions</code>: The boundary condition loss functions as represented in Julia AST</li></ul><ul><li><code>loss_functions</code>: The PINNLossFunctions, i.e. the generated loss functions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralPDE.jl/blob/0e32c6af36fb1b6707a5b25fabd21e11a55dc45c/src/pinn_types.jl#L153-L162">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeuralPDE.PINNLossFunctions" href="#NeuralPDE.PINNLossFunctions"><code>NeuralPDE.PINNLossFunctions</code></a> — <span class="docstring-category">Type</span></header><section><div><p><code>PINNLossFunctions</code>`</p><p>The generated functions from the PINNRepresentation</p><p><strong>Fields</strong></p><ul><li><code>bc_loss_functions</code>: The boundary condition loss functions</li></ul><ul><li><code>pde_loss_functions</code>: The PDE loss functions</li></ul><ul><li><code>full_loss_function</code>: The full loss function, combining the PDE and boundary condition loss functions. This is the loss function that is used by the optimizer.</li></ul><ul><li><code>additional_loss_function</code>: The wrapped <code>additional_loss</code>, as pieced together for the optimizer.</li></ul><ul><li><code>datafree_pde_loss_functions</code>: The pre-data version of the PDE loss function</li></ul><ul><li><code>datafree_bc_loss_functions</code>: The pre-data version of the BC loss function</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/NeuralPDE.jl/blob/0e32c6af36fb1b6707a5b25fabd21e11a55dc45c/src/pinn_types.jl#L297-L305">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ode/">« ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a><a class="docs-footer-nextpage" href="../training_strategies/">Training Strategies »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 23 January 2023 17:44">Monday 23 January 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
