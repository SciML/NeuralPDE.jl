<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian PINNs for PDEs · NeuralPDE.jl</title><meta name="title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="og:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta property="twitter:title" content="Bayesian PINNs for PDEs · NeuralPDE.jl"/><meta name="description" content="Documentation for NeuralPDE.jl."/><meta property="og:description" content="Documentation for NeuralPDE.jl."/><meta property="twitter:description" content="Documentation for NeuralPDE.jl."/><meta property="og:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><meta property="twitter:url" content="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><link rel="canonical" href="https://docs.sciml.ai/NeuralPDE/stable/tutorials/low_level_2/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="NeuralPDE.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">NeuralPDE.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">NeuralPDE.jl: Automatic Physics-Informed Neural Networks (PINNs)</a></li><li><span class="tocitem">ODE PINN Tutorials</span><ul><li><a class="tocitem" href="../ode/">Introduction to NeuralPDE for ODEs</a></li><li><a class="tocitem" href="../Lotka_Volterra_BPINNs/">Bayesian PINNs for Coupled ODEs</a></li><li><a class="tocitem" href="../dae/">PINNs DAEs</a></li><li><a class="tocitem" href="../ode_parameter_estimation/">Parameter Estimation with PINNs for ODEs</a></li></ul></li><li><span class="tocitem">PDE PINN Tutorials</span><ul><li><a class="tocitem" href="../pdesystem/">Introduction to NeuralPDE for PDEs</a></li><li class="is-active"><a class="tocitem" href>Bayesian PINNs for PDEs</a></li><li><a class="tocitem" href="../gpu/">Using GPUs</a></li><li><a class="tocitem" href="../systems/">Defining Systems of PDEs</a></li><li><a class="tocitem" href="../constraints/">Imposing Constraints</a></li><li><a class="tocitem" href="../low_level/">The symbolic_discretize Interface</a></li><li><a class="tocitem" href="../param_estim/">Optimising Parameters (Solving Inverse Problems)</a></li><li><a class="tocitem" href="../integro_diff/">Solving Integro Differential Equations</a></li><li><a class="tocitem" href="../neural_adapter/">Transfer Learning with Neural Adapter</a></li><li><a class="tocitem" href="../derivative_neural_network/">The Derivative Neural Network Approximation</a></li></ul></li><li><span class="tocitem">Extended Examples</span><ul><li><a class="tocitem" href="../../examples/wave/">1D Wave Equation with Dirichlet boundary conditions</a></li><li><a class="tocitem" href="../../examples/3rd/">ODE with a 3rd-Order Derivative</a></li><li><a class="tocitem" href="../../examples/ks/">Kuramoto–Sivashinsky equation</a></li><li><a class="tocitem" href="../../examples/heterogeneous/">PDEs with Dependent Variables on Heterogeneous Domains</a></li><li><a class="tocitem" href="../../examples/linear_parabolic/">Linear parabolic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_elliptic/">Nonlinear elliptic system of PDEs</a></li><li><a class="tocitem" href="../../examples/nonlinear_hyperbolic/">Nonlinear hyperbolic system of PDEs</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/ode/">ODE-Specialized Physics-Informed Neural Network (PINN) Solver</a></li><li><a class="tocitem" href="../../manual/dae/">Differential Algebraic Equation Specialized Physics-Informed Neural Solver</a></li><li><a class="tocitem" href="../../manual/pinns/"><code>PhysicsInformedNN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/bpinns/"><code>BayesianPINN</code> Discretizer for PDESystems</a></li><li><a class="tocitem" href="../../manual/training_strategies/">Training Strategies</a></li><li><a class="tocitem" href="../../manual/adaptive_losses/">Adaptive Loss Functions</a></li><li><a class="tocitem" href="../../manual/logging/">Logging Utilities</a></li><li><a class="tocitem" href="../../manual/neural_adapters/">Transfer Learning with neural_adapter</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../../developer/debugging/">Debugging PINN Solutions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">PDE PINN Tutorials</a></li><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian PINNs for PDEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/NeuralPDE.jl/blob/master/docs/src/tutorials/low_level_2.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation"><a class="docs-heading-anchor" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation">Using <code>ahmc_bayesian_pinn_pde</code> with the <code>BayesianPINN</code> Discretizer for the Kuramoto–Sivashinsky equation</a><a id="Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Using-ahmc_bayesian_pinn_pde-with-the-BayesianPINN-Discretizer-for-the-Kuramoto–Sivashinsky-equation" title="Permalink"></a></h1><p>Consider the Kuramoto–Sivashinsky equation:</p><p class="math-container">\[∂_t u(x, t) + u(x, t) ∂_x u(x, t) + \alpha ∂^2_x u(x, t) + \beta ∂^3_x u(x, t) + \gamma ∂^4_x u(x, t) =  0 \, ,\]</p><p>where <span>$\alpha = \gamma = 1$</span> and <span>$\beta = 4$</span>. The exact solution is:</p><p class="math-container">\[u_e(x, t) = 11 + 15 \tanh \theta - 15 \tanh^2 \theta - 15 \tanh^3 \theta \, ,\]</p><p>where <span>$\theta = t - x/2$</span> and with initial and boundary conditions:</p><p class="math-container">\[\begin{align*}
    u(  x, 0) &amp;=     u_e(  x, 0) \, ,\\
    u( 10, t) &amp;=     u_e( 10, t) \, ,\\
    u(-10, t) &amp;=     u_e(-10, t) \, ,\\
∂_x u( 10, t) &amp;= ∂_x u_e( 10, t) \, ,\\
∂_x u(-10, t) &amp;= ∂_x u_e(-10, t) \, .
\end{align*}\]</p><p>With Bayesian Physics-Informed Neural Networks, here is an example of using <code>BayesianPINN</code> discretization with <code>ahmc_bayesian_pinn_pde</code> :</p><pre><code class="language-julia hljs">using NeuralPDE, Flux, Lux, ModelingToolkit, LinearAlgebra, AdvancedHMC
import ModelingToolkit: Interval, infimum, supremum, Distributions
using Plots, MonteCarloMeasurements

@parameters x, t, α
@variables u(..)
Dt = Differential(t)
Dx = Differential(x)
Dx2 = Differential(x)^2
Dx3 = Differential(x)^3
Dx4 = Differential(x)^4

# α = 1
β = 4
γ = 1
eq = Dt(u(x, t)) + u(x, t) * Dx(u(x, t)) + α * Dx2(u(x, t)) + β * Dx3(u(x, t)) + γ * Dx4(u(x, t)) ~ 0

u_analytic(x, t; z = -x / 2 + t) = 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
du(x, t; z = -x / 2 + t) = 15 / 2 * (tanh(z) + 1) * (3 * tanh(z) - 1) * sech(z)^2

bcs = [u(x, 0) ~ u_analytic(x, 0),
    u(-10, t) ~ u_analytic(-10, t),
    u(10, t) ~ u_analytic(10, t),
    Dx(u(-10, t)) ~ du(-10, t),
    Dx(u(10, t)) ~ du(10, t)]

# Space and time domains
domains = [x ∈ Interval(-10.0, 10.0),
    t ∈ Interval(0.0, 1.0)]

# Discretization
dx = 0.4;
dt = 0.2;

# Function to compute analytical solution at a specific point (x, t)
function u_analytic_point(x, t)
    z = -x / 2 + t
    return 11 + 15 * tanh(z) - 15 * tanh(z)^2 - 15 * tanh(z)^3
end

# Function to generate the dataset matrix
function generate_dataset_matrix(domains, dx, dt)
    x_values = -10:dx:10
    t_values = 0.0:dt:1.0

    dataset = []

    for t in t_values
        for x in x_values
            u_value = u_analytic_point(x, t)
            push!(dataset, [u_value, x, t])
        end
    end

    return vcat([data&#39; for data in dataset]...)
end

datasetpde = [generate_dataset_matrix(domains, dx, dt)]

# noise to dataset
noisydataset = deepcopy(datasetpde)
noisydataset[1][:, 1] = noisydataset[1][:, 1] .+ randn(size(noisydataset[1][:, 1])) .* 5 / 100 .*
                      noisydataset[1][:, 1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">306-element Vector{Float64}:
 -4.132007228847044
 -4.082538934113385
 -3.983732801188931
 -4.224572122152127
 -4.011409045646833
 -4.057508449226926
 -3.923331991274857
 -3.946957838103112
 -3.9061205995257406
 -3.793230942838757
  ⋮
 -3.576060581156446
 -4.191590856244817
 -4.026232284503289
 -4.030142984407086
 -4.206469285588175
 -3.7821945598929427
 -3.8035599764939056
 -4.218864586536193
 -3.691613051116701</code></pre><p>Plotting dataset, added noise is set at 5%.</p><pre><code class="language-julia hljs">plot(datasetpde[1][:, 2], datasetpde[1][:, 1], title=&quot;Dataset from Analytical Solution&quot;)
plot!(noisydataset[1][:, 2], noisydataset[1][:, 1])</code></pre><img src="fc350b74.svg" alt="Example block output"/><pre><code class="language-julia hljs"># Neural network
chain = Lux.Chain(Lux.Dense(2, 8, Lux.tanh),
    Lux.Dense(8, 8, Lux.tanh),
    Lux.Dense(8, 1))

discretization = NeuralPDE.BayesianPINN([chain],
    GridTraining([dx, dt]), param_estim = true, dataset = [noisydataset, nothing])

@named pde_system = PDESystem(eq,
    bcs,
    domains,
    [x, t],
    [u(x, t)],
    [α],
    defaults = Dict([α =&gt; 0.5]))

sol1 = ahmc_bayesian_pinn_pde(pde_system,
    discretization;
    draw_samples = 100, Kernel = AdvancedHMC.NUTS(0.8),
    bcstd = [0.2, 0.2, 0.2, 0.2, 0.2],
    phystd = [1.0], l2std = [0.05], param = [Distributions.LogNormal(0.5, 2)],
    priorsNNw = (0.0, 10.0),
    saveats = [1 / 100.0, 1 / 100.0], progress = true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BPINNsolution{NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}, Vector{Vector{MonteCarloMeasurements.Particles{Float64, 33}}}, Vector{ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2), NamedTuple())), bias = ViewAxis(17:24, ShapedAxis((8, 1), NamedTuple())))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8), NamedTuple())), bias = ViewAxis(65:72, ShapedAxis((8, 1), NamedTuple())))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8), NamedTuple())), bias = ViewAxis(9:9, ShapedAxis((1, 1), NamedTuple())))))}}}}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Vector{Matrix{Float64}}}(NeuralPDE.BPINNstats{MCMCChains.Chains{Float64, AxisArrays.AxisArray{Float64, 3, Base.ReshapedArray{Float64, 3, LinearAlgebra.Adjoint{Float64, Matrix{Float64}}, Tuple{Base.MultiplicativeInverses.SignedMultiplicativeInverse{Int64}}}, Tuple{AxisArrays.Axis{:iter, StepRange{Int64, Int64}}, AxisArrays.Axis{:var, Vector{Symbol}}, AxisArrays.Axis{:chain, UnitRange{Int64}}}}, Missing, @NamedTuple{parameters::Vector{Symbol}}, @NamedTuple{}}, Vector{Vector{Float64}}, Vector{NamedTuple}}(MCMC chain (100×106×1 reshape(adjoint(::Matrix{Float64}), 100, 106, 1) with eltype Float64), [[-0.5365106838996817, -0.6561461591141904, 0.09586480629065111, 0.3250525578431459, 0.1474053121168797, 0.7278709205285654, 0.16105254864126747, -0.6265521249273353, -0.09491872995736192, 0.3321035679776742  …  -0.37777114792233424, -0.19444042874048525, 0.2057407482547039, -0.2564867225621143, -0.4617494745849193, 0.2680531561678683, -0.0817084022975407, -0.19958063818498545, -0.1691698250969893, 0.4962856463736197], [-0.5365106838996817, -0.6561461591141904, 0.09586480629065111, 0.3250525578431459, 0.1474053121168797, 0.7278709205285654, 0.16105254864126747, -0.6265521249273353, -0.09491872995736192, 0.3321035679776742  …  -0.37777114792233424, -0.19444042874048525, 0.2057407482547039, -0.2564867225621143, -0.4617494745849193, 0.2680531561678683, -0.0817084022975407, -0.19958063818498545, -0.1691698250969893, 0.4962856463736197], [-0.5365106838996817, -0.6561461591141904, 0.09586480629065111, 0.3250525578431459, 0.1474053121168797, 0.7278709205285654, 0.16105254864126747, -0.6265521249273353, -0.09491872995736192, 0.3321035679776742  …  -0.37777114792233424, -0.19444042874048525, 0.2057407482547039, -0.2564867225621143, -0.4617494745849193, 0.2680531561678683, -0.0817084022975407, -0.19958063818498545, -0.1691698250969893, 0.4962856463736197], [-0.5363871942840218, -0.6561555070808894, 0.09529028142697858, 0.32561898907578124, 0.14953246388184263, 0.7281337106295895, 0.1610703379561311, -0.6271923369022959, -0.09501342529883826, 0.33250119120523186  …  -0.379387230610724, -0.1952537027768359, 0.2058457748928998, -0.256615241921786, -0.46132655148013246, 0.26797173805374724, -0.08189696857089573, -0.19922242063938747, -0.17509494458768718, 0.4964494647905266], [-0.5082917261228027, -0.5075420612342062, 0.05823855245490639, 0.7834905467033071, 0.6031547234749378, 0.7302664736564213, 0.4977237707722392, -0.5733821850942112, -0.07366531443006474, 0.513637748433455  …  -1.2833914222846574, -1.4270355167563848, 0.14785788602284516, -0.5352550641030415, -1.1857644434117003, 0.7692659907687431, -0.4271455249727583, -0.4965576035399256, -1.759213340412972, 0.4934998261459676], [-0.5082011477142164, -0.5075895624886876, 0.057781969665120024, 0.783524725635937, 0.603343526369821, 0.7302007238134423, 0.49759467432785554, -0.5733401045729296, -0.07378740803360084, 0.5138368709959734  …  -1.2841345406038747, -1.4282919915741812, 0.1478101783428903, -0.535692044987513, -1.1871214588540575, 0.7700519558729312, -0.4278052621896774, -0.49721962860876223, -1.7588679687244242, 0.4935949959329538], [-0.5084006840403782, -0.5076423479911426, 0.057456265681441944, 0.7836312964710236, 0.6033958384346376, 0.7302097044991531, 0.49765287385745266, -0.5730492643035376, -0.07380766743658755, 0.5139375181615563  …  -1.2845867988785475, -1.4290987646409732, 0.14774036134330273, -0.5360214707101827, -1.1878662341591328, 0.7705516493886801, -0.4281236580475934, -0.49764468088253927, -1.7586149344596387, 0.49361651028127784], [-0.43778347201044426, -0.6971629037268592, -0.2556748602443645, 0.6745921150250503, 0.6636616172193524, 0.696535431672925, 0.5407529274656984, -0.5189813750591576, -0.0870565425780785, 0.4970384468502377  …  -2.1028846318975654, -2.6741971306342904, 0.18371342093833334, -1.2677862957503956, -2.379380369506291, 1.6741051183825166, -1.1442991565030396, -1.2836193063546966, -1.3512423445653874, 0.4860372611954554], [-0.4496986952269711, -0.6350654810051217, -0.4244423997879749, 0.7356856068271032, 0.6113402233969311, 0.8613854822130051, 0.5647283175426845, -0.4018427658685783, -0.0564684625963109, 0.47562232434266555  …  -2.0383242947927993, -2.5966666635343545, 0.1502874242783509, -1.226658525644241, -2.315823642767008, 1.633732116360174, -1.0949637065758382, -1.2182933070770985, -1.3824802092279531, 0.4693278706566159], [-0.44142312542396883, -0.6505967355702391, -0.42917239479749936, 0.7353655892972942, 0.6381784551445854, 0.8712617373352985, 0.54711985958343, -0.3955303351475271, -0.05600223268928152, 0.4746796106032055  …  -2.0407053118559686, -2.606363607070085, 0.1556622073726234, -1.2428772176359326, -2.321951104681411, 1.6498119697232816, -1.1113902342246058, -1.2213221062841924, -1.3719017094286021, 0.46765491654029695]  …  [-0.42147476613958856, -0.39110824531321886, -0.555137582591408, 0.6655613021392218, 1.0414599622576988, 0.7741031123856602, 0.4547685421107265, -0.46407101332831424, -1.2895792270593707, 0.7905535232493103  …  -3.494250161320542, -4.561847172663567, 2.1600414751274717, -3.9067555373165206, -4.829151149679531, 2.8413468246120828, -1.399258468409178, -1.8090577842226325, 0.17894551316996032, 0.9968417356247038], [-0.4305527686553532, -0.4474572099990854, -0.5397610029209914, 0.6885964203551822, 1.009586964347584, 0.8121361380187085, 0.46738815973712255, -0.46477505278747205, -1.5453872760336438, 0.8302886732706755  …  -3.556137249379018, -4.637256719270232, 2.1729484114795783, -3.9698830825422062, -4.72225974509111, 2.8317961611947307, -1.5307306209842726, -1.8679333682788515, 0.010221977424592932, 1.0151500313164288], [-0.39867867807923724, -0.3879360703115152, -0.5506726558412738, 0.6023369391513379, 0.8984703048416679, 0.7914032528654411, 0.4545466897442518, -0.4717052517309802, -1.4071735992034358, 0.740536567664976  …  -3.8093887869236345, -4.627142054447322, 2.0441692462828485, -4.079689298913015, -4.753888941947222, 2.8858508047002607, -1.7786216905213261, -1.758067377636074, 0.032780976762725456, 0.9981478098381162], [-0.4171259813998938, -0.40796124921576477, -0.5583098020436685, 0.6351848446861706, 0.9022490598123993, 0.8021375835099359, 0.46928671002617195, -0.4844383373921187, -1.4848069067537664, 0.796996234044524  …  -3.720290206398766, -4.661589334835856, 2.035496893767736, -4.17835684802098, -4.7391256396891634, 2.9066031274808273, -1.7245517956956817, -1.8165873377479564, -0.05615559263090789, 1.0086191252222583], [-0.4190513480211557, -0.40052502214523034, -0.5207530255189594, 0.6545961614747896, 0.8742123109382745, 0.8474452393156957, 0.47680341773432955, -0.523583784277315, -1.5431138028367979, 0.7363648691554574  …  -3.8556051224604655, -4.5933424773345894, 2.0021174373181068, -4.212246053221282, -4.6112601322761595, 2.8821086226874733, -1.6574592193690956, -1.7549529196822233, -0.08833576132378165, 1.103087688429407], [-0.4339317317970377, -0.392902648100136, -0.5231477517137622, 0.6400602709486607, 0.8636451703804013, 0.7858403864973552, 0.4774300985300914, -0.49833043312335495, -1.4474113278862724, 0.7448071360281524  …  -3.8605009594325868, -4.602510700941059, 2.0441315280083603, -4.2959823740543275, -4.606717466325312, 2.8291524066974336, -1.5956791845995866, -1.7056147464238955, -0.13149636100374068, 1.0691741482270216], [-0.431955160330787, -0.4007200773987217, -0.5354883737072715, 0.6445312252717722, 0.847534940619752, 0.739233510071577, 0.4752471570967117, -0.5250773205112313, -1.6550459123851233, 0.7759023310089935  …  -3.8081672061311083, -4.726882785822431, 2.302734134864201, -4.541380708495903, -4.496045183063477, 2.8920810160870425, -1.3178185723522633, -2.0472806402901744, -0.19142102495907398, 0.9189198087514732], [-0.4536649870333172, -0.4236863844419056, -0.5392266979756385, 0.665585721823753, 0.9060504556570816, 0.7503659842827487, 0.4826335528756698, -0.5792388817854629, -1.6695905038163965, 0.7843532529123278  …  -3.85087471227512, -4.7592617179601655, 2.367117734025083, -4.381374944971433, -4.3617155094052995, 2.9844850847406583, -1.296839245050588, -1.900870045583013, -0.33047570850302255, 1.040485443962389], [-0.4659459428440637, -0.4237883504376089, -0.555497658184512, 0.6411109074436522, 0.9544504316284935, 0.780252821755938, 0.48134803399382337, -0.5844681288451111, -1.6773346859371625, 0.8209187044929681  …  -3.9118847380304516, -4.864395542624386, 2.484264988439251, -4.280642226627987, -4.245068726188409, 3.0801501795200092, -1.3663262169719987, -1.8825055832216653, -0.422428590106701, 1.1471049286565609], [-0.46082551837182345, -0.43759628450341975, -0.5351546297347668, 0.6615235352170789, 0.8995330018648597, 0.7352062637298689, 0.4863491643814954, -0.5786675122074385, -1.7379817551068923, 0.8186174943508124  …  -3.8560350058436987, -4.841153903878147, 2.502889343551564, -4.260925816709394, -4.3649042654909485, 3.166258490846487, -1.3453216940889718, -1.799692466354814, -0.5535494883621461, 1.1369703032048588]], NamedTuple[(n_steps = 3, is_accept = true, acceptance_rate = 0.6666666666666666, log_density = -1.6654882949523747e6, hamiltonian_energy = 1.7175938260467742e6, hamiltonian_energy_error = -4088.794040152803, max_hamiltonian_energy_error = 12622.655179754365, tree_depth = 1, numerical_error = true, step_size = 0.0015625, nom_step_size = 0.0015625, is_adapt = true), (n_steps = 1, is_accept = true, acceptance_rate = 0.0, log_density = -1.6654882949523747e6, hamiltonian_energy = 1.6655364783116472e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 1.81815988827694e13, tree_depth = 0, numerical_error = true, step_size = 0.012261299907089943, nom_step_size = 0.012261299907089943, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 9.712430250098991e-293, log_density = -1.6654882949523747e6, hamiltonian_energy = 1.665539934334913e6, hamiltonian_energy_error = 0.0, max_hamiltonian_energy_error = 13257.737771050772, tree_depth = 1, numerical_error = true, step_size = 0.001731493674964374, nom_step_size = 0.001731493674964374, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 0.9825866535573216, log_density = -1.6636044123116266e6, hamiltonian_energy = 1.665536252580991e6, hamiltonian_energy_error = -0.009380522184073925, max_hamiltonian_energy_error = 0.05365401483140886, tree_depth = 2, numerical_error = false, step_size = 0.00015413445733897217, nom_step_size = 0.00015413445733897217, is_adapt = true), (n_steps = 33, is_accept = true, acceptance_rate = 0.27812349273600934, log_density = -588690.669056543, hamiltonian_energy = 1.662641353955105e6, hamiltonian_energy_error = -1010.6014779827092, max_hamiltonian_energy_error = 11641.94952832046, tree_depth = 5, numerical_error = true, step_size = 0.00018603273916582152, nom_step_size = 0.00018603273916582152, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 0.9966733826365056, log_density = -587720.2496515424, hamiltonian_energy = 588730.5939956692, hamiltonian_energy_error = -0.03394769201986492, max_hamiltonian_energy_error = -0.03394769201986492, tree_depth = 3, numerical_error = false, step_size = 3.2370872579039965e-5, nom_step_size = 3.2370872579039965e-5, is_adapt = true), (n_steps = 3, is_accept = true, acceptance_rate = 1.0, log_density = -587146.7180153714, hamiltonian_energy = 587766.1643490926, hamiltonian_energy_error = -0.06891249760519713, max_hamiltonian_energy_error = -0.06891249760519713, tree_depth = 2, numerical_error = false, step_size = 5.0035248135892975e-5, nom_step_size = 5.0035248135892975e-5, is_adapt = true), (n_steps = 127, is_accept = true, acceptance_rate = 0.984285463765431, log_density = -242551.2748444408, hamiltonian_energy = 586952.776768713, hamiltonian_energy_error = -242.76680950121954, max_hamiltonian_energy_error = -242.76680950121954, tree_depth = 7, numerical_error = false, step_size = 8.477364124965283e-5, nom_step_size = 8.477364124965283e-5, is_adapt = true), (n_steps = 15, is_accept = true, acceptance_rate = 1.0, log_density = -143221.6870163289, hamiltonian_energy = 241549.4017335917, hamiltonian_energy_error = -1048.953553184052, max_hamiltonian_energy_error = -1048.953553184052, tree_depth = 4, numerical_error = false, step_size = 0.00014385109711121134, nom_step_size = 0.00014385109711121134, is_adapt = true), (n_steps = 7, is_accept = true, acceptance_rate = 1.0, log_density = -133096.51532898785, hamiltonian_energy = 143009.46938097622, hamiltonian_energy_error = -259.0005324064696, max_hamiltonian_energy_error = -259.0005324064696, tree_depth = 3, numerical_error = false, step_size = 0.0002644593230912579, nom_step_size = 0.0002644593230912579, is_adapt = true)  …  (n_steps = 1023, is_accept = true, acceptance_rate = 0.9993298897042648, log_density = -2435.772055326037, hamiltonian_energy = 2497.2363786642227, hamiltonian_energy_error = -0.1138361597131734, max_hamiltonian_energy_error = -0.15090730717611223, tree_depth = 10, numerical_error = false, step_size = 0.00019022300045513986, nom_step_size = 0.00019022300045513986, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9300774393057797, log_density = -2439.44222636908, hamiltonian_energy = 2493.552111954252, hamiltonian_energy_error = 0.001340903744676325, max_hamiltonian_energy_error = 0.18832203323881913, tree_depth = 10, numerical_error = false, step_size = 0.00019022300045513986, nom_step_size = 0.00019022300045513986, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9786771348181724, log_density = -2428.935229493949, hamiltonian_energy = 2483.867064545464, hamiltonian_energy_error = 0.030410716494316148, max_hamiltonian_energy_error = 0.09513637185864354, tree_depth = 10, numerical_error = false, step_size = 0.00019022300045513986, nom_step_size = 0.00019022300045513986, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9706701303483102, log_density = -2425.1846334779257, hamiltonian_energy = 2477.4059169779625, hamiltonian_energy_error = -0.05647475792102341, max_hamiltonian_energy_error = 0.1432327822390107, tree_depth = 10, numerical_error = false, step_size = 0.00019022300045513986, nom_step_size = 0.00019022300045513986, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9802572118020393, log_density = -2430.6309858405048, hamiltonian_energy = 2472.0807724683145, hamiltonian_energy_error = -0.0006192006067067268, max_hamiltonian_energy_error = -0.2634218660264196, tree_depth = 10, numerical_error = false, step_size = 0.00019022300045513986, nom_step_size = 0.00019022300045513986, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.948135322123264, log_density = -2430.5250563301333, hamiltonian_energy = 2491.8894194684854, hamiltonian_energy_error = -0.07509743349191922, max_hamiltonian_energy_error = 0.2971579897389347, tree_depth = 10, numerical_error = false, step_size = 0.00019022300045513986, nom_step_size = 0.00019022300045513986, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9559994116332325, log_density = -2425.4770818086017, hamiltonian_energy = 2497.2264981796975, hamiltonian_energy_error = -0.02989236447683652, max_hamiltonian_energy_error = 0.18971457596262553, tree_depth = 10, numerical_error = false, step_size = 0.00019022300045513986, nom_step_size = 0.00019022300045513986, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9509521163543524, log_density = -2422.7374464995764, hamiltonian_energy = 2477.826905685925, hamiltonian_energy_error = 0.03328463834077411, max_hamiltonian_energy_error = 0.15977936199215037, tree_depth = 10, numerical_error = false, step_size = 0.00019022300045513986, nom_step_size = 0.00019022300045513986, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.93420233800732, log_density = -2423.392584848599, hamiltonian_energy = 2475.362792301537, hamiltonian_energy_error = 0.023622924619303376, max_hamiltonian_energy_error = 0.19295768760412102, tree_depth = 10, numerical_error = false, step_size = 0.00019022300045513986, nom_step_size = 0.00019022300045513986, is_adapt = false), (n_steps = 1023, is_accept = true, acceptance_rate = 0.9995475888346155, log_density = -2418.633052899374, hamiltonian_energy = 2471.933815128432, hamiltonian_energy_error = -0.0510136988746126, max_hamiltonian_energy_error = -0.08880885268172278, tree_depth = 10, numerical_error = false, step_size = 0.00019022300045513986, nom_step_size = 0.00019022300045513986, is_adapt = false)]), Vector{MonteCarloMeasurements.Particles{Float64, 33}}[[-4.0 ± 0.0093, -4.0 ± 0.0093, -4.0 ± 0.0093, -4.0 ± 0.0093, -4.0 ± 0.0093, -4.0 ± 0.0093, -4.0 ± 0.0093, -4.0 ± 0.0093, -4.0 ± 0.0093, -4.0 ± 0.0093  …  -4.01 ± 0.007, -4.01 ± 0.007, -4.01 ± 0.007, -4.01 ± 0.007, -4.01 ± 0.007, -4.01 ± 0.007, -4.01 ± 0.007, -4.01 ± 0.007, -4.01 ± 0.007, -4.01 ± 0.007]], ComponentArrays.ComponentVector{MonteCarloMeasurements.Particles{Float64, 34}, Vector{MonteCarloMeasurements.Particles{Float64, 34}}, Tuple{ComponentArrays.Axis{(layer_1 = ViewAxis(1:24, Axis(weight = ViewAxis(1:16, ShapedAxis((8, 2), NamedTuple())), bias = ViewAxis(17:24, ShapedAxis((8, 1), NamedTuple())))), layer_2 = ViewAxis(25:96, Axis(weight = ViewAxis(1:64, ShapedAxis((8, 8), NamedTuple())), bias = ViewAxis(65:72, ShapedAxis((8, 1), NamedTuple())))), layer_3 = ViewAxis(97:105, Axis(weight = ViewAxis(1:8, ShapedAxis((1, 8), NamedTuple())), bias = ViewAxis(9:9, ShapedAxis((1, 1), NamedTuple())))))}}}[(layer_1 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-0.447 ± 0.025 -1.17 ± 0.3; -0.461 ± 0.043 0.901 ± 0.098; … ; 0.445 ± 0.024 -1.04 ± 0.075; -0.56 ± 0.077 0.612 ± 0.25], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.0332 ± 0.11; 0.809 ± 0.27; … ; 0.98 ± 0.11; -0.623 ± 0.07;;]), layer_2 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[0.558 ± 0.25 -1.16 ± 0.3 … 0.225 ± 0.18 -0.815 ± 0.44; 0.222 ± 0.22 -0.28 ± 0.33 … -0.675 ± 0.2 0.00668 ± 0.37; … ; -0.866 ± 0.39 -0.621 ± 0.25 … -0.823 ± 0.22 1.01 ± 0.15; 0.928 ± 0.2 0.212 ± 0.092 … 0.544 ± 0.17 -0.414 ± 0.16], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.202 ± 0.15; 0.968 ± 0.17; … ; -0.706 ± 0.25; -0.272 ± 0.17;;]), layer_3 = (weight = MonteCarloMeasurements.Particles{Float64, 34}[-3.73 ± 0.21 -4.45 ± 0.33 … -1.7 ± 0.23 -1.85 ± 0.1], bias = MonteCarloMeasurements.Particles{Float64, 34}[-0.173 ± 0.21;;]))], MonteCarloMeasurements.Particles{Float64, 34}[1.05 ± 0.074], [[-10.0 -9.99 … 9.99 10.0; 0.0 0.0 … 1.0 1.0]])</code></pre><p>And some analysis:</p><pre><code class="language-julia hljs">phi = discretization.phi[1]
xs, ts = [infimum(d.domain):dx:supremum(d.domain) for (d, dx) in zip(domains, [dx / 10, dt])]
u_predict = [[first(pmean(phi([x, t], sol1.estimated_nn_params[1]))) for x in xs]
             for t in ts]
u_real = [[u_analytic(x, t) for x in xs] for t in ts]
diff_u = [[abs(u_analytic(x, t) - first(pmean(phi([x, t], sol1.estimated_nn_params[1]))))
           for x in xs]
          for t in ts]

p1 = plot(xs, u_predict, title = &quot;predict&quot;)
p2 = plot(xs, u_real, title = &quot;analytic&quot;)
p3 = plot(xs, diff_u, title = &quot;error&quot;)
plot(p1, p2, p3)</code></pre><img src="939ff9c8.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pdesystem/">« Introduction to NeuralPDE for PDEs</a><a class="docs-footer-nextpage" href="../gpu/">Using GPUs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Sunday 18 February 2024 21:10">Sunday 18 February 2024</span>. Using Julia version 1.10.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
